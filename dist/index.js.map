{"version":3,"file":"index.js","mappings":"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","sources":["webpack://Tela/webpack/universalModuleDefinition","webpack://Tela/webpack/bootstrap","webpack://Tela/webpack/runtime/define property getters","webpack://Tela/webpack/runtime/hasOwnProperty shorthand","webpack://Tela/webpack/runtime/make namespace object","webpack://Tela/./src/Canvas_old/main/ImageIO.js","webpack://Tela/./src/Canvas_old/main/Canvas.js","webpack://Tela/./src/Canvas_old/main/Canvas2D.js","webpack://Tela/./node_modules/@babel/runtime/helpers/esm/arrayLikeToArray.js","webpack://Tela/./node_modules/@babel/runtime/helpers/esm/unsupportedIterableToArray.js","webpack://Tela/./node_modules/@babel/runtime/helpers/esm/toConsumableArray.js","webpack://Tela/./node_modules/@babel/runtime/helpers/esm/arrayWithoutHoles.js","webpack://Tela/./node_modules/@babel/runtime/helpers/esm/iterableToArray.js","webpack://Tela/./node_modules/@babel/runtime/helpers/esm/nonIterableSpread.js","webpack://Tela/./node_modules/@babel/runtime/helpers/esm/slicedToArray.js","webpack://Tela/./node_modules/@babel/runtime/helpers/esm/arrayWithHoles.js","webpack://Tela/./node_modules/@babel/runtime/helpers/esm/iterableToArrayLimit.js","webpack://Tela/./node_modules/@babel/runtime/helpers/esm/nonIterableRest.js","webpack://Tela/./node_modules/@babel/runtime/helpers/esm/classCallCheck.js","webpack://Tela/./node_modules/@babel/runtime/helpers/esm/typeof.js","webpack://Tela/./node_modules/@babel/runtime/helpers/esm/toPropertyKey.js","webpack://Tela/./node_modules/@babel/runtime/helpers/esm/toPrimitive.js","webpack://Tela/./node_modules/@babel/runtime/helpers/esm/createClass.js","webpack://Tela/./node_modules/@babel/runtime/helpers/esm/defineProperty.js","webpack://Tela/./src/Color/main/Color.js","webpack://Tela/./node_modules/@babel/runtime/helpers/esm/setPrototypeOf.js","webpack://Tela/./node_modules/@babel/runtime/helpers/esm/inherits.js","webpack://Tela/./node_modules/@babel/runtime/helpers/esm/assertThisInitialized.js","webpack://Tela/./node_modules/@babel/runtime/helpers/esm/possibleConstructorReturn.js","webpack://Tela/./node_modules/@babel/runtime/helpers/esm/getPrototypeOf.js","webpack://Tela/./node_modules/@babel/runtime/helpers/esm/construct.js","webpack://Tela/./node_modules/@babel/runtime/helpers/esm/isNativeReflectConstruct.js","webpack://Tela/./node_modules/@babel/runtime/helpers/esm/wrapNativeSuper.js","webpack://Tela/./node_modules/@babel/runtime/helpers/esm/isNativeFunction.js","webpack://Tela/./src/Matrix/main/Matrix.js","webpack://Tela/./src/BBox/main/BBox.js","webpack://Tela/./src/Canvas/main/Canvas.js","webpack://Tela/./src/Utils/main/Utils.js","webpack://Tela/./src/Animator/main/Animator.js","webpack://Tela/./node_modules/@babel/runtime/helpers/esm/get.js","webpack://Tela/./node_modules/@babel/runtime/helpers/esm/superPropBase.js","webpack://Tela/./src/Canvas2d/main/Canvas2d.js"],"sourcesContent":["(function webpackUniversalModuleDefinition(root, factory) {\n\tif(typeof exports === 'object' && typeof module === 'object')\n\t\tmodule.exports = factory();\n\telse if(typeof define === 'function' && define.amd)\n\t\tdefine([], factory);\n\telse if(typeof exports === 'object')\n\t\texports[\"Tela\"] = factory();\n\telse\n\t\troot[\"Tela\"] = factory();\n})(self, () => {\nreturn ","// The require scope\nvar __webpack_require__ = {};\n\n","// define getter functions for harmony exports\n__webpack_require__.d = (exports, definition) => {\n\tfor(var key in definition) {\n\t\tif(__webpack_require__.o(definition, key) && !__webpack_require__.o(exports, key)) {\n\t\t\tObject.defineProperty(exports, key, { enumerable: true, get: definition[key] });\n\t\t}\n\t}\n};","__webpack_require__.o = (obj, prop) => (Object.prototype.hasOwnProperty.call(obj, prop))","// define __esModule on exports\n__webpack_require__.r = (exports) => {\n\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n\t}\n\tObject.defineProperty(exports, '__esModule', { value: true });\n};","const ImageIO = {\n  // empty object\n};\n\n/**\n * img : html image\n */\nImageIO.getImageCanvas = img => {\n  const canvasAux = document.createElement(\"canvas\");\n  canvasAux.width = img.width;\n  canvasAux.height = img.height;\n  const contextAux = canvasAux.getContext(\"2d\");\n  contextAux.fillStyle = \"rgba(0, 0, 0, 0)\";\n  contextAux.globalCompositeOperation = \"source-over\";\n  contextAux.fillRect(0, 0, canvasAux.width, canvasAux.height);\n  contextAux.drawImage(img, 0, 0);\n  return canvasAux;\n};\n\n/**\n * img : html image\n */\nImageIO.getDataFromImage = img => {\n  canvas = ImageIO.getImageCanvas(img);\n  return canvas.getContext(\"2d\").getImageData(0, 0, img.width, img.height);\n};\n\nImageIO.loadImage = src => {\n  const img = new Image();\n  img.src = src;\n  img.isReady = false;\n  img.onload = () => (img.isReady = true);\n  return img;\n};\n\nImageIO.generateImageReadyPredicate = img => () => img.isReady;\n\nexport default ImageIO;\n","import ImageIO from \"./ImageIO\";\n/*\n Canvas coordinates\n\n 0                  W-1\n +-------------> y\n |\n |\n |       *\n |\n |\n v x\n\n H-1\n */\n\n/*\n\nThe point xe_1 + ye_2 corresponds to a point in the middle of a pxl.\n\nThe canvas data is an array of length colors(C) * width(W) * height(H). Is a 3D-array.\nThe index is a number in [0, C * W * H - 1].\nHaving (x, y, z) where z is the color axis, the formula to index the array is :\n\nf(x, y, z) = C * W * x + C * y + z.\n\nWhere x in [0, H - 1], y in [0, W - 1] and z in [0, C - 1].\n\nNote that f(H - 1, W - 1, C - 1) = C * W * H - 1.\n*/\n\n// Auxiliary functions\nfunction scale(u, r) {\n  var ans = [];\n  ans[0] = u[0] * r;\n  ans[1] = u[1] * r;\n  return ans;\n}\n\nfunction add(u, v) {\n  var ans = [];\n  ans[0] = u[0] + v[0];\n  ans[1] = u[1] + v[1];\n  return ans;\n}\n\nfunction floor(x) {\n  var ans = [];\n  ans[0] = Math.floor(x[0]);\n  ans[1] = Math.floor(x[1]);\n  return ans;\n}\n\nfunction diff(u, v) {\n  var ans = [];\n  ans[0] = u[0] - v[0];\n  ans[1] = u[1] - v[1];\n  return ans;\n}\n\nfunction dot(u, v) {\n  return u[0] * v[0] + u[1] * v[1];\n}\n\nfunction squareNorm(x) {\n  return dot(x, x);\n}\n\nfunction norm(x) {\n  return Math.sqrt(dot(x, x));\n}\n\nfunction min(u, v) {\n  var ans = [];\n  ans[0] = Math.min(u[0], v[0]);\n  ans[1] = Math.min(u[1], v[1]);\n  return ans;\n}\n\nfunction max(u, v) {\n  var ans = [];\n  ans[0] = Math.max(u[0], v[0]);\n  ans[1] = Math.max(u[1], v[1]);\n  return ans;\n}\n\n/**\n * return solution to : [ u_0 , h] x = z_0\n *\n *                       [ u_1,  0] y = z_1\n */\nfunction solve2by2UpperTriMatrix(u, h, z) {\n  var aux = z[1] / u[1];\n  return [aux, (-u[0] * aux + z[0]) / h];\n}\n/**\n * return solution to : [ u_0 , 0] x = z_0\n *\n *                       [ u_1,  w] y = z_1\n */\nfunction solve2by2LowerTriMatrix(u, w, z) {\n  var aux = z[0] / u[0];\n  return [aux, (-u[1] * aux + z[1]) / w];\n}\n\n// Canvas\nvar Canvas = function (canvas) {\n  this.canvas = canvas;\n  this.ctx = canvas.getContext(\"2d\");\n  this.image = this.ctx.getImageData(0, 0, canvas.width, canvas.height);\n  // width * height * 4 array of integers\n  this.imageData = this.image.data;\n};\n\n/**\n * Returns a two vector with Height as first coordinate and Width as second. [Height, Width].\n */\nCanvas.prototype.getSize = function () {\n  return [this.canvas.height, this.canvas.width];\n};\n\n/**\n *  Draw update image on canvas.\n */\nCanvas.prototype.paintImage = function () {\n  this.ctx.putImageData(this.image, 0, 0);\n};\n\nCanvas.prototype.getCanvas = function () {\n  return this.canvas;\n};\n\n/**\n * Clear Image with @rgba color.\n *\n * @param rgba\n */\nCanvas.prototype.clearImage = function (rgba) {\n  this.useCanvasCtx((canvas) => {\n    var size = canvas.getSize();\n    canvas.ctx.fillStyle =\n      \"rgba(\" + rgba[0] + \",\" + rgba[1] + \",\" + rgba[2] + \",\" + rgba[3] + \")\";\n    canvas.ctx.globalCompositeOperation = \"source-over\";\n    canvas.ctx.fillRect(0, 0, size[1], size[0]);\n  }, true);\n};\n\nCanvas.prototype.useCanvasCtx = function (lambda, isClearImage = false) {\n  if (!isClearImage) {\n    this.ctx.putImageData(this.image, 0, 0);\n  }\n  lambda(this);\n  this.image = this.ctx.getImageData(\n    0,\n    0,\n    this.canvas.width,\n    this.canvas.height\n  );\n  this.imageData = this.image.data;\n};\n\nCanvas.prototype.getImageIndex = function (x) {\n  return 4 * (this.canvas.width * x[0] + x[1]);\n};\n\nCanvas.prototype.getPxl = function (x) {\n  var index = this.getImageIndex(x);\n  return [\n    this.imageData[index],\n    this.imageData[index + 1],\n    this.imageData[index + 2],\n    this.imageData[index + 3],\n  ];\n};\n\nCanvas.prototype.drawPxl = function (x, rgb) {\n  var index = this.getImageIndex(x);\n  this.imageData[index] = rgb[0];\n  this.imageData[index + 1] = rgb[1];\n  this.imageData[index + 2] = rgb[2];\n  this.imageData[index + 3] = rgb[3];\n};\n\n/*\n * x1     :   2-dim array\n * x2     :   2-dim array\n * shader :   is a function that receives a 2-dim array and a line (array with 2 points) and returns a rgba 4-dim array\n */\nCanvas.prototype.drawLine = function (x1, x2, shader) {\n  // add points before clip\n  shader.points = [x1, x2];\n\n  // do clipping\n  var stack = [];\n  stack.push(x1);\n  stack.push(x2);\n  var inStack = [];\n  var outStack = [];\n  for (var i = 0; i < stack.length; i++) {\n    var x = stack[i];\n    if (\n      0 <= x[0] &&\n      x[0] < this.canvas.height &&\n      0 <= x[1] &&\n      x[1] < this.canvas.width\n    ) {\n      inStack.push(x);\n    } else {\n      outStack.push(x);\n    }\n  }\n  // both points are inside canvas\n  if (inStack.length == 2) {\n    this.drawLineInt(inStack[0], inStack[1], shader);\n    return;\n  }\n  //intersecting line with canvas\n  var intersectionSolutions = [];\n  var v = [x2[0] - x1[0], x2[1] - x1[1]];\n  // Let s \\in [0,1]\n  // line intersection with [0, 0]^T + [H - 1, 0]^T s\n  intersectionSolutions.push(\n    solve2by2UpperTriMatrix(v, -(this.canvas.height - 1), [-x1[0], -x1[1]])\n  );\n  // line intersection with [H - 1, 0]^T + [0, W - 1]^T s\n  intersectionSolutions.push(\n    solve2by2LowerTriMatrix(v, -(this.canvas.width - 1), [\n      this.canvas.height - 1 - x1[0],\n      -x1[1],\n    ])\n  );\n  // line intersection with [H - 1, W - 1]^T + [-(H - 1), 0]^T s\n  intersectionSolutions.push(\n    solve2by2UpperTriMatrix(v, this.canvas.height - 1, [\n      this.canvas.height - 1 - x1[0],\n      this.canvas.width - 1 - x1[1],\n    ])\n  );\n  // line intersection with [0, W - 1]^T + [0, -(W - 1)]^T s\n  intersectionSolutions.push(\n    solve2by2LowerTriMatrix(v, this.canvas.width - 1, [\n      -x1[0],\n      this.canvas.width - 1 - x1[1],\n    ])\n  );\n\n  var validIntersection = [];\n  for (var i = 0; i < intersectionSolutions.length; i++) {\n    var x = intersectionSolutions[i];\n    if (0 <= x[0] && x[0] <= 1 && 0 <= x[1] && x[1] <= 1) {\n      validIntersection.push(x);\n    }\n  }\n\n  if (validIntersection.length == 0) return;\n\n  //it can be shown that at this point there is at least one valid intersection.\n  if (inStack.length > 0) {\n    var p = [\n      x1[0] + validIntersection[0][0] * v[0],\n      x1[1] + validIntersection[0][0] * v[1],\n    ];\n    this.drawLineInt(inStack.pop(), p, shader);\n    return;\n  }\n\n  var p0 = [\n    x1[0] + validIntersection[0][0] * v[0],\n    x1[1] + validIntersection[0][0] * v[1],\n  ];\n  for (var i = 1; i < validIntersection.length; i++) {\n    var p = [\n      x1[0] + validIntersection[i][0] * v[0],\n      x1[1] + validIntersection[i][0] * v[1],\n    ];\n    var v = diff(p, p0);\n    if (dot(v, v) > 1e-3) {\n      this.drawLineInt(p0, p, shader);\n      return;\n    }\n  }\n  this.drawLineInt(p0, p0, shader);\n};\n\nCanvas.prototype.drawLineInt = function (x1, x2, shader) {\n  x1 = floor(x1);\n  x2 = floor(x2);\n\n  var index = [-1, 0, 1];\n\n  var n = index.length;\n  var nn = n * n;\n\n  var x = [];\n  x[0] = x1[0];\n  x[1] = x1[1];\n\n  var tangent = diff(x2, x1);\n  var normal = [];\n  normal[0] = -tangent[1];\n  normal[1] = tangent[0];\n\n  shader(x, shader.points, this);\n\n  while (x[0] !== x2[0] || x[1] !== x2[1]) {\n    var fmin = Number.MAX_VALUE;\n    var minDir = [];\n    for (var k = 0; k < nn; k++) {\n      var i = index[k % n];\n      var j = index[Math.floor(k / n)];\n\n      var nextX = add(x, [i, j]);\n\n      var v = diff(nextX, x1);\n      var f = Math.abs(dot(v, normal)) - dot(v, tangent);\n      if (fmin > f) {\n        fmin = f;\n        minDir = [i, j];\n      }\n    }\n\n    x = add(x, minDir);\n    shader(x, shader.points, this);\n  }\n  shader(x, shader.points, this);\n};\n\nCanvas.prototype.drawPolygon = function (\n  array,\n  shader,\n  isInsidePoly = Canvas.isInsidePolygon\n) {\n  let upperBox = [\n    [Number.MAX_VALUE, Number.MAX_VALUE],\n    [Number.MIN_VALUE, Number.MIN_VALUE],\n  ];\n  for (let i = 0; i < array.length; i++) {\n    upperBox[0] = min(array[i], upperBox[0]);\n    upperBox[1] = max(array[i], upperBox[1]);\n  }\n\n  let size = this.getSize();\n  let clampedSize = diff(size, [1, 1]);\n  let zeros = [0, 0];\n  upperBox[0] = floor(min(clampedSize, max(zeros, upperBox[0])));\n  upperBox[1] = floor(min(clampedSize, max(zeros, upperBox[1])));\n\n  for (var i = upperBox[0][0]; i < upperBox[1][0]; i++) {\n    for (var j = upperBox[0][1]; j < upperBox[1][1]; j++) {\n      var x = [i, j];\n      if (isInsidePoly(x, array)) {\n        shader(x, array, this);\n      }\n    }\n  }\n};\n\n/*\n * x1     :   2-dim array\n * x2     :   2-dim array\n * x3     :   2-dim array\n * shader :   is a function that receives a 2-dim array and a triangle (array with 3 points) and returns a rgba 4-dim array\n */\nCanvas.prototype.drawTriangle = function (x1, x2, x3, shader) {\n  var array = [x1, x2, x3];\n  this.drawPolygon(array, shader, Canvas.isInsideConvex);\n};\n\n/* x1     :   2-dim array\n * x2     :   2-dim array\n * x3     :   2-dim array\n * x4     :   2-dim array\n * shader :   is a function that receives a 2-dim array and returns a rgba 4-dim array\n */\nCanvas.prototype.drawQuad = function (x1, x2, x3, x4, shader) {\n  this.drawPolygon([x1, x2, x3, x4], shader);\n};\n\nCanvas.prototype.drawImage = function (img, x) {\n  if (\"isReady\" in img && !img.isReady) return;\n  this.useCanvasCtx((canvas) => canvas.ctx.drawImage(img, x[1], x[0]));\n};\n\nCanvas.prototype.drawCircle = function (x, r, shader) {\n  var corner = scale([1, 1], r);\n  var upperBox = [diff(x, corner), add(x, corner)];\n  var size = this.getSize();\n  upperBox[0] = floor(min(diff(size, [1, 1]), max([0, 0], upperBox[0])));\n  upperBox[1] = floor(min(diff(size, [1, 1]), max([0, 0], upperBox[1])));\n  for (var i = upperBox[0][0]; i <= upperBox[1][0]; i++) {\n    for (var j = upperBox[0][1]; j <= upperBox[1][1]; j++) {\n      var p = [i, j];\n      if (this.isInsideCircle(p, x, r)) {\n        shader(p, [x, r], this);\n      }\n    }\n  }\n};\n\nCanvas.prototype.isInsideCircle = function (p, x, r) {\n  return squareNorm(diff(p, x)) <= r * r;\n};\n\nCanvas.prototype.addEventListener = function (key, lambda, useCapture) {\n  this.canvas.addEventListener(key, lambda, useCapture);\n};\n\nCanvas.prototype.drawString = function (x, string, contextShader) {\n  this.useCanvasCtx((canvas) => {\n    contextShader(canvas.ctx);\n    canvas.ctx.fillText(string, x[1], x[0]);\n  });\n};\n\n// Static functions\n\n// slower than isInsideConvex method\nCanvas.isInsidePolygon = function (x, array) {\n  var v = [];\n  var theta = 0;\n  var n = array.length;\n  for (var i = 0; i < n; i++) {\n    v[0] = diff(array[(i + 1) % n], x);\n    v[1] = diff(array[i], x);\n    theta += Math.acos(dot(v[0], v[1]) / (norm(v[0]) * norm(v[1])));\n  }\n  return Math.abs(theta - 2 * Math.PI) < 1e-3;\n};\n\nCanvas.isInsideConvex = function (x, array) {\n  var m = array.length;\n  var v = [];\n  var vDotN = [];\n  for (var i = 0; i < m; i++) {\n    v[i] = diff(array[(i + 1) % m], array[i]);\n    let n = [-v[i][1], v[i][0]];\n    let r = diff(x, array[i]);\n    vDotN[i] = dot(r, n);\n  }\n  let orientation = v[0][0] * v[1][1] - v[0][1] * v[1][0] > 0 ? 1 : -1;\n  for (var i = 0; i < m; i++) {\n    var myDot = vDotN[i] * orientation;\n    if (myDot < 0) return false;\n  }\n  return true;\n};\n\nCanvas.simpleShader = function (color) {\n  return (x, element, canvas) => canvas.drawPxl(x, color);\n};\n\nCanvas.colorShader = function (colors) {\n  var auxShader = (x, poly, canvas, alpha) => {\n    var interpolateColors = [0, 0, 0, 0];\n    for (var i = 0; i < poly.length; i++) {\n      interpolateColors[0] = interpolateColors[0] + colors[i][0] * alpha[i];\n      interpolateColors[1] = interpolateColors[1] + colors[i][1] * alpha[i];\n      interpolateColors[2] = interpolateColors[2] + colors[i][2] * alpha[i];\n      interpolateColors[3] = interpolateColors[3] + colors[i][3] * alpha[i];\n    }\n    canvas.drawPxl(x, interpolateColors);\n  };\n  return Canvas.interpolateTriangleShader(auxShader);\n};\n\nCanvas.interpolateQuadShader = function (shader) {\n  return function (x, quad, canvas) {\n    var t1 = [quad[0], quad[1], quad[2]];\n    var t2 = [quad[2], quad[3], quad[0]];\n    var alpha = Canvas.triangleBaryCoord(x, t1);\n    if (\n      alpha[0] > 0 &&\n      alpha[1] > 0 &&\n      alpha[2] > 0 &&\n      Math.abs(alpha[0] + alpha[1] + alpha[2] - 1) < 1e-10\n    ) {\n      shader(x, quad, canvas, [alpha[0], alpha[1], alpha[2], 0]);\n    } else {\n      alpha = Canvas.triangleBaryCoord(x, t2);\n      shader(x, quad, canvas, [alpha[2], 0, alpha[0], alpha[1]]);\n    }\n  };\n};\n\nCanvas.interpolateTriangleShader = function (shader) {\n  return (x, triangle, canvas) => {\n    const alpha = Canvas.triangleBaryCoord(x, triangle);\n    shader(x, triangle, canvas, alpha);\n  };\n};\n\nCanvas.interpolateLineShader = function (shader) {\n  return (x, line, canvas) => {\n    var v = diff(line[1], line[0]);\n    var z = diff(x, line[0]);\n    var vnorm = squareNorm(v);\n    var projection = dot(z, v);\n    var t = vnorm == 0.0 ? 0 : projection / vnorm;\n    shader(x, line, canvas, t);\n  };\n};\n\n/**\n * img: html loaded image.\n * quadTexCoord: [0, 1]^{2 * 4}, texture coordinates\n */\nCanvas.quadTextureShader = function (\n  img,\n  quadTexCoord,\n  interpolation = Canvas.bilinearInterpolation\n) {\n  let imageCache = null;\n  const imageShader = (x, quad, canvas, alpha) => {\n    if (!img.isReady || imageCache == null)\n      imageCache = new Canvas(ImageIO.getImageCanvas(img));\n    const imageCanvas = imageCache;\n    const imgSize = imageCanvas.getSize();\n    const interpolateTexCoord = [0, 0];\n    for (let i = 0; i < quadTexCoord.length; i++) {\n      interpolateTexCoord[0] =\n        interpolateTexCoord[0] + quadTexCoord[i][0] * alpha[i];\n      interpolateTexCoord[1] =\n        interpolateTexCoord[1] + quadTexCoord[i][1] * alpha[i];\n    }\n    var i = [\n      (1 - interpolateTexCoord[1]) * (imgSize[1] - 1),\n      (imgSize[0] - 1) * interpolateTexCoord[0],\n    ];\n    // bound coordinates\n    i = max([0, 0], min(diff([imgSize[0], imgSize[1]], [1, 1]), i));\n    // pxl lower corner\n    var j = floor(i);\n    var cornerColors = [\n      imageCanvas.getPxl(j),\n      imageCanvas.getPxl(add(j, [1, 0])),\n      imageCanvas.getPxl(add(j, [1, 1])),\n      imageCanvas.getPxl(add(j, [0, 1])),\n    ];\n    var finalColor = interpolation(cornerColors, diff(i, j));\n    canvas.drawPxl(x, finalColor);\n  };\n  return Canvas.interpolateQuadShader(imageShader);\n};\n\nCanvas.triangleCache = (() => {\n  const hashMap = [];\n  const size = 3;\n  return {\n    constains: (triangleHash) => hashMap[triangleHash % size] != undefined,\n    get: (triangleHash) => hashMap[triangleHash % size],\n    set: (triangleHash, value) => (hashMap[triangleHash % size] = value),\n  };\n})(); //{triangle: null, u: [], v:[], det:null, hash:null}\n\nCanvas.triangleHash = (triangle) => {\n  const array = [\n    triangle[0][0],\n    triangle[1][0],\n    triangle[2][0],\n    triangle[0][1],\n    triangle[1][1],\n    triangle[2][1],\n  ];\n  return array.reduce((h, x) => 31 * h + x, 1);\n};\n\nCanvas.triangleBaryCoord = function (x, triangle) {\n  const hash = Canvas.triangleHash(triangle);\n  const y = [x[0] - triangle[0][0], x[1] - triangle[0][1]];\n  if (!Canvas.triangleCache.constains(hash)) {\n    const u = [\n      triangle[1][0] - triangle[0][0],\n      triangle[1][1] - triangle[0][1],\n    ];\n    const v = [\n      triangle[2][0] - triangle[0][0],\n      triangle[2][1] - triangle[0][1],\n    ];\n    const det = u[0] * v[1] - u[1] * v[0];\n    Canvas.triangleCache.set(hash, {\n      triangle: triangle,\n      u: u.map((x) => x / det),\n      v: v.map((x) => x / det),\n      det: det,\n      hash: hash,\n    });\n  }\n  const cache = Canvas.triangleCache.get(hash);\n  const u = cache.u;\n  const v = cache.v;\n  const det = cache.det;\n  if (det == 0) return [0, 0, 0];\n  var alpha = [v[1] * y[0] - v[0] * y[1], u[0] * y[1] - u[1] * y[0]];\n  return [1 - alpha[0] - alpha[1], alpha[0], alpha[1]];\n};\n\n/**\n * values \\in R^{k * 4}\n * x \\in [0,1]^2\n */\nCanvas.bilinearInterpolation = function (values, x) {\n  var acc = [];\n  for (var k = 0; k < values.length; k++) {\n    var f03 = values[0][k] + (values[3][k] - values[0][k]) * x[1];\n    var f12 = values[1][k] + (values[2][k] - values[1][k]) * x[1];\n    var f = f03 + (f12 - f03) * x[0];\n    acc.push(f);\n  }\n  return acc;\n};\n/**\n * size: is an array with width and height of a HTML5 Canvas.\n * domId: DOM element where the canvas will be added\n *\n * returns Canvas object from the generated html canvas.\n */\nCanvas.createCanvas = function (size, domId) {\n  const canvas = document.createElement(\"canvas\");\n  canvas.setAttribute(\"width\", size[0]);\n  canvas.setAttribute(\"height\", size[1]);\n  document.getElementById(domId).appendChild(canvas);\n  return canvas;\n};\n\nexport default Canvas;\n","import Canvas from \"./Canvas\";\n\n//Note that we can switch from heritage to composition, think about that\n\n// cameraSpace : 2-dim array with two 2-dim arrays that are intervals [a,b] | a < b\nvar Canvas2D = function (canvas, cameraSpace) {\n  Canvas.call(this, canvas);\n  if (\n    cameraSpace.length != 2 ||\n    (cameraSpace[0].length != 2 && cameraSpace[1].length != 2)\n  ) {\n    throw \"camera space must be 2-dim array with 2-dim arrays representing an interval\";\n  }\n  this.cameraSpace = cameraSpace;\n};\n\nCanvas2D.prototype = Object.create(Canvas.prototype);\nCanvas2D.prototype.constructor = Canvas2D;\n\n/* x : 2-dim array in camera space coordinates\n * returns : 2-dim array in integer coordinates\n */\nCanvas2D.prototype.integerTransform = function (x) {\n  var xint =\n    (-(this.canvas.height - 1) /\n      (this.cameraSpace[1][1] - this.cameraSpace[1][0])) *\n    (x[1] - this.cameraSpace[1][1]);\n  var yint =\n    ((this.canvas.width - 1) /\n      (this.cameraSpace[0][1] - this.cameraSpace[0][0])) *\n    (x[0] - this.cameraSpace[0][0]);\n  return [xint, yint];\n};\n\n/* x : 2-dim array in integer coordinates\n * returns : 2-dim array in camera space coordinates\n */\nCanvas2D.prototype.inverseTransform = function (x) {\n  var xt =\n    this.cameraSpace[0][0] +\n    ((this.cameraSpace[0][1] - this.cameraSpace[0][0]) /\n      (this.canvas.width - 1)) *\n      x[1];\n  var yt =\n    this.cameraSpace[1][1] -\n    ((this.cameraSpace[1][1] - this.cameraSpace[1][0]) /\n      (this.canvas.height - 1)) *\n      x[0];\n  return [xt, yt];\n};\n\n/* x1     :   2-dim array\n * x2     :   2-dim array\n * shader :   is a function that receives a 2-dim array and returns a rgba 4-dim array\n */\nCanvas2D.prototype.drawLine = function (x1, x2, shader) {\n  const y1 = this.integerTransform(x1);\n  const y2 = this.integerTransform(x2);\n  Canvas.prototype.drawLine.call(this, y1, y2, shader);\n};\n\n/* x1     :   2-dim array\n * x2     :   2-dim array\n * x3     :   2-dim array\n * shader :   is a function that receives a 2-dim array and returns a rgba 4-dim array\n */\nCanvas2D.prototype.drawTriangle = function (x1, x2, x3, shader) {\n  const y1 = this.integerTransform(x1);\n  const y2 = this.integerTransform(x2);\n  const y3 = this.integerTransform(x3);\n  Canvas.prototype.drawTriangle.call(this, y1, y2, y3, shader);\n};\n\n/* x1     :   2-dim array\n * x2     :   2-dim array\n * x3     :   2-dim array\n * x4     :   2-dim array\n * shader :   is a function that receives a 2-dim array and returns a rgba 4-dim array\n */\nCanvas2D.prototype.drawQuad = function (x1, x2, x3, x4, shader) {\n  const y1 = this.integerTransform(x1);\n  const y2 = this.integerTransform(x2);\n  const y3 = this.integerTransform(x3);\n  const y4 = this.integerTransform(x4);\n  Canvas.prototype.drawQuad.call(this, y1, y2, y3, y4, shader);\n};\n\nCanvas2D.prototype.drawCircle = function (x, r, shader) {\n  // it assumes squared canvas, for now ...\n  const y = this.integerTransform(x);\n  const z = this.integerTransform([r, 0])[1] - this.integerTransform([0, 0])[1];\n  Canvas.prototype.drawCircle.call(this, y, z, shader);\n};\n\nCanvas2D.prototype.drawImage = function (img, x) {\n  Canvas.prototype.drawImage.call(this, img, this.integerTransform(x));\n};\n\nCanvas2D.prototype.drawString = function (x, string, contextShader) {\n  const y = this.integerTransform(x);\n  Canvas.prototype.drawString.call(this, y, string, contextShader);\n};\n\n// camera : 2-dim array with two 2-dim arrays that are intervals [a,b] | a < b\nCanvas2D.prototype.setCamera = function (camera) {\n  if (camera.length != 2 || (camera[0].length != 2 && camera[1].length != 2)) {\n    throw \"camera space must be 2-dim array with 2-dim arrays representing an interval\";\n  }\n  this.cameraSpace = camera;\n};\n\nexport default Canvas2D;\n","export default function _arrayLikeToArray(arr, len) {\n  if (len == null || len > arr.length) len = arr.length;\n  for (var i = 0, arr2 = new Array(len); i < len; i++) arr2[i] = arr[i];\n  return arr2;\n}","import arrayLikeToArray from \"./arrayLikeToArray.js\";\nexport default function _unsupportedIterableToArray(o, minLen) {\n  if (!o) return;\n  if (typeof o === \"string\") return arrayLikeToArray(o, minLen);\n  var n = Object.prototype.toString.call(o).slice(8, -1);\n  if (n === \"Object\" && o.constructor) n = o.constructor.name;\n  if (n === \"Map\" || n === \"Set\") return Array.from(o);\n  if (n === \"Arguments\" || /^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)) return arrayLikeToArray(o, minLen);\n}","import arrayWithoutHoles from \"./arrayWithoutHoles.js\";\nimport iterableToArray from \"./iterableToArray.js\";\nimport unsupportedIterableToArray from \"./unsupportedIterableToArray.js\";\nimport nonIterableSpread from \"./nonIterableSpread.js\";\nexport default function _toConsumableArray(arr) {\n  return arrayWithoutHoles(arr) || iterableToArray(arr) || unsupportedIterableToArray(arr) || nonIterableSpread();\n}","import arrayLikeToArray from \"./arrayLikeToArray.js\";\nexport default function _arrayWithoutHoles(arr) {\n  if (Array.isArray(arr)) return arrayLikeToArray(arr);\n}","export default function _iterableToArray(iter) {\n  if (typeof Symbol !== \"undefined\" && iter[Symbol.iterator] != null || iter[\"@@iterator\"] != null) return Array.from(iter);\n}","export default function _nonIterableSpread() {\n  throw new TypeError(\"Invalid attempt to spread non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.\");\n}","import arrayWithHoles from \"./arrayWithHoles.js\";\nimport iterableToArrayLimit from \"./iterableToArrayLimit.js\";\nimport unsupportedIterableToArray from \"./unsupportedIterableToArray.js\";\nimport nonIterableRest from \"./nonIterableRest.js\";\nexport default function _slicedToArray(arr, i) {\n  return arrayWithHoles(arr) || iterableToArrayLimit(arr, i) || unsupportedIterableToArray(arr, i) || nonIterableRest();\n}","export default function _arrayWithHoles(arr) {\n  if (Array.isArray(arr)) return arr;\n}","export default function _iterableToArrayLimit(r, l) {\n  var t = null == r ? null : \"undefined\" != typeof Symbol && r[Symbol.iterator] || r[\"@@iterator\"];\n  if (null != t) {\n    var e,\n      n,\n      i,\n      u,\n      a = [],\n      f = !0,\n      o = !1;\n    try {\n      if (i = (t = t.call(r)).next, 0 === l) {\n        if (Object(t) !== t) return;\n        f = !1;\n      } else for (; !(f = (e = i.call(t)).done) && (a.push(e.value), a.length !== l); f = !0);\n    } catch (r) {\n      o = !0, n = r;\n    } finally {\n      try {\n        if (!f && null != t[\"return\"] && (u = t[\"return\"](), Object(u) !== u)) return;\n      } finally {\n        if (o) throw n;\n      }\n    }\n    return a;\n  }\n}","export default function _nonIterableRest() {\n  throw new TypeError(\"Invalid attempt to destructure non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.\");\n}","export default function _classCallCheck(instance, Constructor) {\n  if (!(instance instanceof Constructor)) {\n    throw new TypeError(\"Cannot call a class as a function\");\n  }\n}","export default function _typeof(o) {\n  \"@babel/helpers - typeof\";\n\n  return _typeof = \"function\" == typeof Symbol && \"symbol\" == typeof Symbol.iterator ? function (o) {\n    return typeof o;\n  } : function (o) {\n    return o && \"function\" == typeof Symbol && o.constructor === Symbol && o !== Symbol.prototype ? \"symbol\" : typeof o;\n  }, _typeof(o);\n}","import _typeof from \"./typeof.js\";\nimport toPrimitive from \"./toPrimitive.js\";\nexport default function _toPropertyKey(arg) {\n  var key = toPrimitive(arg, \"string\");\n  return _typeof(key) === \"symbol\" ? key : String(key);\n}","import _typeof from \"./typeof.js\";\nexport default function _toPrimitive(input, hint) {\n  if (_typeof(input) !== \"object\" || input === null) return input;\n  var prim = input[Symbol.toPrimitive];\n  if (prim !== undefined) {\n    var res = prim.call(input, hint || \"default\");\n    if (_typeof(res) !== \"object\") return res;\n    throw new TypeError(\"@@toPrimitive must return a primitive value.\");\n  }\n  return (hint === \"string\" ? String : Number)(input);\n}","import toPropertyKey from \"./toPropertyKey.js\";\nfunction _defineProperties(target, props) {\n  for (var i = 0; i < props.length; i++) {\n    var descriptor = props[i];\n    descriptor.enumerable = descriptor.enumerable || false;\n    descriptor.configurable = true;\n    if (\"value\" in descriptor) descriptor.writable = true;\n    Object.defineProperty(target, toPropertyKey(descriptor.key), descriptor);\n  }\n}\nexport default function _createClass(Constructor, protoProps, staticProps) {\n  if (protoProps) _defineProperties(Constructor.prototype, protoProps);\n  if (staticProps) _defineProperties(Constructor, staticProps);\n  Object.defineProperty(Constructor, \"prototype\", {\n    writable: false\n  });\n  return Constructor;\n}","import toPropertyKey from \"./toPropertyKey.js\";\nexport default function _defineProperty(obj, key, value) {\n  key = toPropertyKey(key);\n  if (key in obj) {\n    Object.defineProperty(obj, key, {\n      value: value,\n      enumerable: true,\n      configurable: true,\n      writable: true\n    });\n  } else {\n    obj[key] = value;\n  }\n  return obj;\n}","const MAX_8BIT = 255;\n\nexport default class Color {\n  /**\n   *\n   * @param {Uint8Array} rgba\n   */\n  constructor(rgba) {\n    this.rgba = rgba;\n  }\n\n  getRGBA() {\n    return this.rgba;\n  }\n\n  get red() {\n    return this.rgba[0];\n  }\n\n  get green() {\n    return this.rgba[1];\n  }\n\n  get blue() {\n    return this.rgba[2];\n  }\n\n  get alpha() {\n    return this.rgba[3];\n  }\n\n  get redRaw(){\n    return this.red * MAX_8BIT;\n  }\n  get greenRaw(){\n    return this.green * MAX_8BIT;\n  }\n  get blueRaw(){\n    return this.blue * MAX_8BIT;\n  }\n\n  /**\n   *\n   * @param {Color} color\n   * @returns {Boolean}\n   */\n  equals(color) {\n    for (let i = 0; i < this.rgba.length; i++) {\n      if (this.rgba[i] !== color.rgba[i]) {\n        return false;\n      }\n    }\n    return true;\n  }\n\n  static ofRGBA(red = 0, green = 0, blue = 0, alpha = 1) {\n    const rgba = new Uint8Array(4);\n    rgba[0] = red * MAX_8BIT;\n    rgba[1] = green * MAX_8BIT;\n    rgba[2] = blue * MAX_8BIT;\n    rgba[3] = alpha * MAX_8BIT;\n    return new Color(rgba);\n  }\n\n  static ofRGBARaw(red = 0, green = 0, blue = 0, alpha = 255) {\n    const rgba = new Uint8Array(4);\n    rgba[0] = red;\n    rgba[1] = green;\n    rgba[2] = blue;\n    rgba[3] = alpha;\n    return new Color(rgba);\n  }\n\n  static random() {\n    const r = () => Math.random() * 256;\n    return Color.ofRGBA(r(), r(), r(), r());\n  }\n\n  static RED = Color.ofRGBA(1, 0, 0);\n  static GREEN = Color.ofRGBA(0, 1, 0);\n  static BLUE = Color.ofRGBA(0, 0, 1);\n  static BLACK = Color.ofRGBA(0, 0, 0);\n  static WHITE = Color.ofRGBA(1, 1, 1);\n}\n","export default function _setPrototypeOf(o, p) {\n  _setPrototypeOf = Object.setPrototypeOf ? Object.setPrototypeOf.bind() : function _setPrototypeOf(o, p) {\n    o.__proto__ = p;\n    return o;\n  };\n  return _setPrototypeOf(o, p);\n}","import setPrototypeOf from \"./setPrototypeOf.js\";\nexport default function _inherits(subClass, superClass) {\n  if (typeof superClass !== \"function\" && superClass !== null) {\n    throw new TypeError(\"Super expression must either be null or a function\");\n  }\n  subClass.prototype = Object.create(superClass && superClass.prototype, {\n    constructor: {\n      value: subClass,\n      writable: true,\n      configurable: true\n    }\n  });\n  Object.defineProperty(subClass, \"prototype\", {\n    writable: false\n  });\n  if (superClass) setPrototypeOf(subClass, superClass);\n}","export default function _assertThisInitialized(self) {\n  if (self === void 0) {\n    throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\");\n  }\n  return self;\n}","import _typeof from \"./typeof.js\";\nimport assertThisInitialized from \"./assertThisInitialized.js\";\nexport default function _possibleConstructorReturn(self, call) {\n  if (call && (_typeof(call) === \"object\" || typeof call === \"function\")) {\n    return call;\n  } else if (call !== void 0) {\n    throw new TypeError(\"Derived constructors may only return object or undefined\");\n  }\n  return assertThisInitialized(self);\n}","export default function _getPrototypeOf(o) {\n  _getPrototypeOf = Object.setPrototypeOf ? Object.getPrototypeOf.bind() : function _getPrototypeOf(o) {\n    return o.__proto__ || Object.getPrototypeOf(o);\n  };\n  return _getPrototypeOf(o);\n}","import setPrototypeOf from \"./setPrototypeOf.js\";\nimport isNativeReflectConstruct from \"./isNativeReflectConstruct.js\";\nexport default function _construct(Parent, args, Class) {\n  if (isNativeReflectConstruct()) {\n    _construct = Reflect.construct.bind();\n  } else {\n    _construct = function _construct(Parent, args, Class) {\n      var a = [null];\n      a.push.apply(a, args);\n      var Constructor = Function.bind.apply(Parent, a);\n      var instance = new Constructor();\n      if (Class) setPrototypeOf(instance, Class.prototype);\n      return instance;\n    };\n  }\n  return _construct.apply(null, arguments);\n}","export default function _isNativeReflectConstruct() {\n  if (typeof Reflect === \"undefined\" || !Reflect.construct) return false;\n  if (Reflect.construct.sham) return false;\n  if (typeof Proxy === \"function\") return true;\n  try {\n    Boolean.prototype.valueOf.call(Reflect.construct(Boolean, [], function () {}));\n    return true;\n  } catch (e) {\n    return false;\n  }\n}","import getPrototypeOf from \"./getPrototypeOf.js\";\nimport setPrototypeOf from \"./setPrototypeOf.js\";\nimport isNativeFunction from \"./isNativeFunction.js\";\nimport construct from \"./construct.js\";\nexport default function _wrapNativeSuper(Class) {\n  var _cache = typeof Map === \"function\" ? new Map() : undefined;\n  _wrapNativeSuper = function _wrapNativeSuper(Class) {\n    if (Class === null || !isNativeFunction(Class)) return Class;\n    if (typeof Class !== \"function\") {\n      throw new TypeError(\"Super expression must either be null or a function\");\n    }\n    if (typeof _cache !== \"undefined\") {\n      if (_cache.has(Class)) return _cache.get(Class);\n      _cache.set(Class, Wrapper);\n    }\n    function Wrapper() {\n      return construct(Class, arguments, getPrototypeOf(this).constructor);\n    }\n    Wrapper.prototype = Object.create(Class.prototype, {\n      constructor: {\n        value: Wrapper,\n        enumerable: false,\n        writable: true,\n        configurable: true\n      }\n    });\n    return setPrototypeOf(Wrapper, Class);\n  };\n  return _wrapNativeSuper(Class);\n}","export default function _isNativeFunction(fn) {\n  try {\n    return Function.toString.call(fn).indexOf(\"[native code]\") !== -1;\n  } catch (e) {\n    return typeof fn === \"function\";\n  }\n}","//========================================================================================\n/*                                                                                      *\n *                              MATRIX UTILS (order counts)                             *\n *                                                                                      */\n//========================================================================================\n\nconst getIndexFromCoord = (_, m) => (i, j) => j + i * m;\nconst getCoordFromIndex = (_, m) => (k) => [k / m, k % m].map(Math.floor);\nconst index2Key = (i, j) => `${i},${j}`;\nconst key2Index = (k) => k.split(\",\").map(Number);\n\nclass MatrixBuilder {\n  constructor() {\n    this._size = [];\n    this.data = {};\n  }\n\n  size(n, m = 1) {\n    this._size = [n, m];\n    return this;\n  }\n\n  set(i, j, v) {\n    if (this._size.length === 0)\n      throw new MatrixError(\"Setting value to empty matrix\");\n    this.data[index2Key(i, j)] = v;\n    return this;\n  }\n\n  build() {\n    const [n, m] = this._size;\n    const data = new Float64Array(n * m);\n    const indexer = getIndexFromCoord(n, m);\n    Object.keys(this.data).forEach((key) => {\n      data[indexer(...key2Index(key))] = this.data[key];\n    });\n    return new Matrix(data, this._size);\n  }\n}\n\nclass RowBuilder {\n  constructor() {\n    this.rows = [];\n    this.dim = 0;\n  }\n\n  addRow(...array) {\n    if (this.dim === 0) {\n      this.dim = array.length;\n    }\n    if (this.dim !== array.length)\n      throw new MatrixError(\n        `Added row of different dimension, actual dim is ${this.dim}`\n      );\n    this.rows.push(array);\n    return this;\n  }\n\n  build() {\n    if (this.rows.length > 0) return this._buildWithRows();\n    throw new MatrixError(\"Building empty matrix\");\n  }\n\n  _buildWithRows() {\n    const rows = this.rows.length;\n    const cols = this.dim;\n    const data = new Float64Array(rows * cols);\n    const indexF = getIndexFromCoord(rows, cols);\n    for (let i = 0; i < rows; i++) {\n      for (let j = 0; j < cols; j++) {\n        data[indexF(i, j)] = this.rows[i][j];\n      }\n    }\n    return new Matrix(data, [rows, cols]);\n  }\n}\n\nclass ColBuilder {\n  constructor() {\n    this.cols = [];\n    this.dim = 0;\n  }\n\n  addCol(...array) {\n    if (this.dim === 0) {\n      this.dim = array.length;\n    }\n    if (this.dim !== array.length)\n      throw new MatrixError(\n        `Added col of different dimension, actual dim is ${this.dim}`\n      );\n    this.cols.push(array);\n    return this;\n  }\n\n  build() {\n    if (this.cols.length > 0) return this.#buildWithCols();\n    throw new MatrixError(\"Building empty matrix\");\n  }\n\n  #buildWithCols() {\n    const rows = this.dim;\n    const cols = this.cols.length;\n    const data = new Float64Array(rows * cols);\n    const indexF = getIndexFromCoord(rows, cols);\n    for (let i = 0; i < rows; i++) {\n      for (let j = 0; j < cols; j++) {\n        data[indexF(i, j)] = this.cols[j][i];\n      }\n    }\n    return new Matrix(data, [rows, cols]);\n  }\n}\n\n//========================================================================================\n/*                                                                                      *\n *                                        MATRIX                                        *\n *                                                                                      */\n//========================================================================================\n\nexport default class Matrix {\n  /**\n   *\n   * @param {Float64Array} data: Matrix data in major row format\n   * @param {Array} shape: 2-array [rows,columns]\n   */\n  constructor(data, shape) {\n    this.data = data;\n    this.shape = shape;\n  }\n\n  get rows() {\n    return this.shape[0];\n  }\n\n  get cols() {\n    return this.shape[1];\n  }\n\n  get(i = 0, j = 0) {\n    const [_, cols] = this.shape;\n    return this.data[j + i * cols];\n  }\n\n  prod(matrix) {\n    if (this.cols !== matrix.rows) {\n      throw new MatrixError(\n        `Incompatible product size. Left ${this.shape}, right ${matrix.shape}`\n      );\n    }\n    const n = this.rows;\n    const m = this.cols;\n    const l = matrix.cols;\n    const prod = new Float64Array(n * l);\n    const indexer = getIndexFromCoord(n, l);\n    for (let i = 0; i < n; i++) {\n      for (let j = 0; j < l; j++) {\n        let acc = 0;\n        for (let k = 0; k < m; k++) {\n          acc += this.get(i, k) * matrix.get(k, j);\n        }\n        prod[indexer(i, j)] = acc;\n      }\n    }\n\n    return new Matrix(prod, [n, l]);\n  }\n\n  dot(matrix) {\n    if (this.rows !== matrix.rows)\n      throw new MatrixError(\n        `Incompatible product size. Left ${this.shape}, right ${matrix.shape}`\n      );\n    const n = this.rows;\n    const m = this.cols;\n    const l = matrix.cols;\n    const prod = new Float64Array(m * l);\n    const indexer = getIndexFromCoord(m, l);\n    for (let i = 0; i < m; i++) {\n      for (let j = 0; j < l; j++) {\n        let acc = 0;\n        for (let k = 0; k < n; k++) {\n          acc += this.get(k, i) * matrix.get(k, j);\n        }\n        prod[indexer(i, j)] = acc;\n      }\n    }\n\n    return new Matrix(prod, [m, l]);\n  }\n\n  /**\n   *\n   * @param {*} lambda: (number, i, j) => number\n   * @returns Matrix\n   */\n  map(lambda = (x) => x) {\n    const getCoord = getCoordFromIndex(...this.shape);\n    return new Matrix(\n      this.data.map((x, k) => {\n        const [i, j] = getCoord(k);\n        return lambda(x, i, j);\n      }),\n      this.shape\n    );\n  }\n\n  /**\n   *\n   * @param {*} lambda (accumulator, number, i, j) => number\n   * @param {*} identity\n   */\n  reduce(lambda, identity = 0) {\n    const getCoord = getCoordFromIndex(...this.shape);\n    return this.data.reduce((e, x, k) => {\n      const [i, j] = getCoord(k);\n      return lambda(e, x, i, j);\n    }, identity);\n  }\n\n  fold = this.reduce;\n\n  /**\n   *\n   * @param {*} binaryLambda: (number,number) => number\n   */\n  op(matrix, binaryLambda) {\n    const [rows, cols] = this.shape;\n    const [mRows, mCols] = matrix.shape;\n    if (rows !== mRows || cols !== mCols)\n      throw new MatrixError(\"Matrix must be of same size\");\n    return new Matrix(\n      this.data.map((x, i) => binaryLambda(x, matrix.data[i])),\n      this.shape\n    );\n  }\n\n  add(matrix) {\n    return this.op(matrix, (a, b) => a + b);\n  }\n\n  sub(matrix) {\n    return this.op(matrix, (a, b) => a - b);\n  }\n\n  mul(matrix) {\n    return this.op(matrix, (a, b) => a * b);\n  }\n\n  div(matrix) {\n    return this.op(matrix, (a, b) => a / b);\n  }\n\n  scale(real) {\n    return this.map((x) => x * real);\n  }\n\n  norm() {\n    let acc = 0;\n    for (let i = 0; i < this.data.length; i++) {\n      acc += this.data[i] * this.data[i];\n    }\n    return Math.sqrt(acc);\n  }\n\n  length = this.norm;\n\n  equals(matrix, precision = 1e-6) {\n    if (!(matrix instanceof Matrix)) return false;\n    try {\n      return this.sub(matrix).length() < precision;\n    } catch (error) {\n      return false;\n    }\n  }\n\n  toArray() {\n    return this.data;\n  }\n\n  static id = (n, m = n) => {\n    const en = Matrix.e(n);\n    let matrixBuilder = Matrix.colBuilder();\n    for (let i = 0; i < m; i++) {\n      matrixBuilder = matrixBuilder.addCol(...en(i).data);\n    }\n    return matrixBuilder.build();\n  };\n\n  static e = (n) => (i) => {\n    return new Matrix(\n      new Float64Array(n).map((_, j) => (i === j ? 1 : 0)),\n      [n, 1]\n    );\n  };\n\n  static dx = (n) => (i) => {\n    return new Matrix(\n      new Float64Array(n).map((_, j) => (i === j ? 1 : 0)),\n      [1, n]\n    );\n  };\n\n  static ZERO(n, m = 1) {\n    return Matrix.builder().size(n, m).build();\n  }\n\n  static random(n, m = 1) {\n    const data = new Float64Array(n * m);\n    for (let i = 0; i < data.length; i++) {\n      data[i] = Math.random();\n    }\n    return new Matrix(data, [n, m]);\n  }\n\n  static builder() {\n    return new MatrixBuilder();\n  }\n\n  static rowBuilder() {\n    return new RowBuilder();\n  }\n\n  static colBuilder() {\n    return new ColBuilder();\n  }\n\n  static vec(...array) {\n    return new ColBuilder().addCol(...array).build();\n  }\n\n  static cov(...array) {\n    return new RowBuilder().addRow(...array).build();\n  }\n\n  static vec2 = {\n    of: (x = 0, y = 0) => Matrix.vec(x, y),\n    e0: Matrix.vec(1, 0),\n    e1: Matrix.vec(0, 1),\n    ZERO: Matrix.ZERO(2, 1),\n  };\n\n  static vec3 = {\n    of: (x = 0, y = 0, z = 0) => Matrix.vec(x, y, z),\n    e0: Matrix.vec(1, 0, 0),\n    e1: Matrix.vec(0, 1, 0),\n    e2: Matrix.vec(0, 0, 1),\n    ZERO: Matrix.ZERO(3, 1),\n  };\n}\n\nexport class MatrixError extends Error {}\n","import Matrix from \"../../Matrix/main/Matrix\";\n\nexport default class BBox {\n  constructor(min, max) {\n    this.isEmpty = min === undefined || max === undefined;\n    if (this.isEmpty) return this;\n    this.min = min.op(max, Math.min);\n    this.max = max.op(min, Math.max);\n    this.center = min.add(max).scale(1 / 2);\n    this.diagonal = max.sub(min);\n  }\n  /**\n   * Union of boxes\n   * @param {*} box\n   */\n  add(box) {\n    if (this === BBox.EMPTY) return box;\n    const { min, max } = this;\n    return new BBox(min.op(box.min, Math.min), max.op(box.max, Math.max));\n  }\n\n  union = this.add;\n\n  /**\n   * Intersection of boxes\n   * @param {*} box\n   */\n  sub(box) {\n    if (this === BBox.EMPTY) return BBox.EMPTY;\n    const { min, max } = this;\n    const newMin = min.op(box.min, Math.max);\n    const newMax = max.op(box.max, Math.min);\n    const newDiag = newMax.sub(newMin);\n    const isAllPositive = newDiag.data.every((x) => x >= 0);\n    return !isAllPositive ? BBox.EMPTY : new BBox(newMin, newMax);\n  }\n\n  inter = this.sub;\n\n  move(vector) {\n    return new BBox(this.min.add(vector), this.max.add(vector));\n  }\n\n  collidesWith(box) {\n    const actionByTypes = [\n      { type: BBox, action: () => !this.sub(box).isEmpty },\n      { type: Matrix, action: () => !this.sub(new BBox(box, box)).isEmpty },\n    ];\n    for (let i = 0; i < actionByTypes.length; i++) {\n      if (box instanceof actionByTypes[i].type) {\n        return actionByTypes[i].action();\n      }\n    }\n  }\n\n  equals(box) {\n    if (!(box instanceof BBox)) return false;\n    if (this == BBox.EMPTY) return true;\n    return this.min.equals(box.min) && this.max.equals(box.max);\n  }\n\n  static ofPoint(...array) {\n    const point = Matrix.vec(...array);\n    return new BBox(point, point);\n  }\n  static EMPTY = new BBox();\n}\n","import Color from \"../../Color/main/Color\";\nimport Matrix from \"../../Matrix/main/Matrix\";\nimport BBox from \"../../BBox/main/BBox\";\nconst { vec2 } = Matrix;\n/*\n Canvas coordinates\n\n 0                  W-1\n +-------------> y\n |\n |\n |       *\n |\n |\n v x\n\n H-1\n/*\n\nThe point xe_1 + ye_2 corresponds to a point in the middle of a pxl.\n\nThe canvas data is an array of length colors(C) * width(W) * height(H). Is a 3D-array.\nThe index is a number in [0, C * W * H - 1].\nHaving (x, y, z) where z is the color axis, the formula to index the array is :\n\nf(x, y, z) = C * W * x + C * y + z.\n\nWhere x in [0, H - 1], y in [0, W - 1] and z in [0, C - 1].\n\nNote that f(H - 1, W - 1, C - 1) = C * W * H - 1.\n*/\n\nexport default class Canvas {\n  /**\n   *\n   * @param {canvasDOM} canvas: DOM element of type canvas\n   */\n  constructor(canvas) {\n    this.canvas = canvas;\n    this.ctx = canvas.getContext(\"2d\", {\n      willReadFrequently: true\n    });\n    this.image = this.ctx.getImageData(0, 0, canvas.width, canvas.height);\n    // width * height * 4 array of integers\n    this.data = this.image.data;\n  }\n\n  getCanvas() {\n    return this.canvas;\n  }\n\n  getDom = this.getCanvas;\n\n  get width() {\n    return this.canvas.width;\n  }\n\n  get height() {\n    return this.canvas.height;\n  }\n  //========================================================================================\n  /*                                                                                      *\n   *                                 side effects function                                *\n   *                                                                                      */\n  //========================================================================================\n\n  /**\n   * Update color of canvas\n   * @param {Color} color\n   * @returns {Canvas}\n   */\n  fill(color = Color.ofRGBARaw(255, 255, 255)) {\n    this.ctx.fillStyle = `rgba(${color.red}, ${color.green}, ${color.blue}, ${color.alpha / 255.0\n      })`;\n    console.log(this.ctx.fillStyle);\n    this.ctx.fillRect(0, 0, this.canvas.width, this.canvas.height);\n    this.image = this.ctx.getImageData(\n      0,\n      0,\n      this.canvas.width,\n      this.canvas.height\n    );\n    this.data = this.image.data;\n    return this;\n  }\n\n  /**\n   *\n   * @param {(Color, Number, Number) => Color} lambda\n   * @returns {Canvas}\n   */\n  map(lambda = () => { }) {\n    const n = this.data.length;\n    const { width: w } = this.canvas;\n    for (let i = 0; i < n; i += 4) {\n      const x = Math.floor(i / (4 * w));\n      const y = Math.floor(i / 4) % w;\n      const color = lambda(\n        Color.ofRGBARaw(\n          this.data[i],\n          this.data[i + 1],\n          this.data[i + 2],\n          this.data[i + 3]\n        ),\n        x,\n        y\n      );\n      this.data[i] = color.red;\n      this.data[i + 1] = color.green;\n      this.data[i + 2] = color.blue;\n      this.data[i + 3] = color.alpha;\n    }\n    return this;\n  }\n\n  /**\n   * Return pxl color at (i,j)\n   * @param {Number} i: integer \\in [0,H-1]\n   * @param {Number} j: integer \\in [0,W-1]\n   * @returns {Color}\n   */\n  getPxl(i, j) {\n    const { width, height } = this.canvas;\n    if (i < 0 || i >= height || j < 0 || j >= width) return undefined;\n    const index = 4 * (i * width + j);\n    return Color.ofRGBARaw(\n      this.data[index],\n      this.data[index + 1],\n      this.data[index + 2],\n      this.data[index + 3]\n    );\n  }\n  /**\n   * Set pxl color at (i,j)\n   * @param {Number} i: integer \\in [0,H-1]\n   * @param {Number} j: integer \\in [0,W-1]\n   * @param {Color} color\n   */\n  setPxl(i, j, color) {\n    const { width, height } = this.canvas;\n    if (i < 0 || i >= height || j < 0 || j >= width) return this;\n    const index = 4 * (i * width + j);\n    this.data[index] = color.red;\n    this.data[index + 1] = color.green;\n    this.data[index + 2] = color.blue;\n    this.data[index + 3] = color.alpha;\n    return this;\n  }\n\n  /**\n   *\n   * @param {Array<Number>} start: 2-Array\n   * @param {Array<Number>} end: 2-Array\n   * @param {Canvas}\n   */\n  drawLine(start, end, shader = (x, y) => Color.ofRGBA(0, 0, 0)) {\n    // faster than using vec2\n    const { width, _ } = this.canvas;\n    const line = this._clipLine(start, end).map((x) => x.toArray());\n    if (line.length === 0) return;\n    const [p0, p1] = line;\n    const v = [p1[0] - p0[0], p1[1] - p0[1]];\n    const n = Math.abs(v[0]) + Math.abs(v[1]);\n    for (let k = 0; k < n; k++) {\n      const s = k / n;\n      const x = [p0[0] + v[0] * s, p0[1] + v[1] * s].map(Math.floor);\n      const [i, j] = x;\n      const index = 4 * (i * width + j);\n      const color = shader(i, j);\n      this.data[index] = color.red;\n      this.data[index + 1] = color.green;\n      this.data[index + 2] = color.blue;\n      this.data[index + 3] = color.alpha;\n    }\n    return this;\n  }\n\n  /**\n   *\n   * @param {Array<Number>} p0 : 2-array<number>\n   * @param {Array<Number>} p1 : 2-array<number>\n   * @param {Array<Number>} p2 : 2-array<number>\n   * @param {(Number, Number) => Color} shader : (number, number) => Color\n   * @returns\n   */\n  drawTriangle(p0, p1, p2, shader = (x, y) => Color.ofRGBA(0, 0, 0)) {\n    return this._drawConvexPolygon([p0, p1, p2], shader);\n  }\n\n  paint() {\n    this.ctx.putImageData(this.image, 0, 0);\n  }\n\n  //========================================================================================\n  /*                                                                                      *\n   *                                  Auxiliary functions                                  *\n   *                                                                                      */\n  //========================================================================================\n\n  /**\n   *\n   * @param {*} arrayOfPoints : Array<2-Array<Number>>\n   * @param {*} shader : (x,y) => color\n   * @returns\n   */\n  _drawConvexPolygon(arrayOfPoints, shader) {\n    const { width, height } = this.canvas;\n    const canvasBox = new BBox(vec2.ZERO, vec2.of(height, width));\n    let boundingBox = BBox.EMPTY;\n    arrayOfPoints.forEach((x) => {\n      boundingBox = boundingBox.add(BBox.ofPoint(...x));\n    });\n    const finalBox = canvasBox.inter(boundingBox);\n    const [xMin, yMin] = finalBox.min.toArray();\n    const [xMax, yMax] = finalBox.max.toArray();\n\n    for (let i = xMin; i < xMax; i++) {\n      for (let j = yMin; j < yMax; j++) {\n        if (this._isInsideConvex([i, j], arrayOfPoints)) {\n          const color = shader(i, j);\n          const index = 4 * (i * width + j);\n          this.data[index] = color.red;\n          this.data[index + 1] = color.green;\n          this.data[index + 2] = color.blue;\n          this.data[index + 3] = color.alpha;\n        }\n      }\n    }\n    return this;\n  }\n\n  /**\n   *\n   * @param {*} x: 2-Array<Number>\n   * @param {*} points: Array<2-Array<Number>>\n   * @returns\n   */\n  _isInsideConvex(x, points) {\n    const m = points.length;\n    const v = [];\n    const vDotN = [];\n    for (let i = 0; i < m; i++) {\n      const p1 = points[(i + 1) % m];\n      const p0 = points[i];\n      v[i] = [p1[0] - p0[0], p1[1] - p0[1]];\n      const vi = v[i];\n      const n = [-vi[1], vi[0]];\n      const r = [x[0] - p0[0], x[1] - p0[1]];\n      vDotN[i] = r[0] * n[0] + r[1] * n[1];\n    }\n    let orientation = v[0][0] * v[1][1] - v[0][1] * v[1][0] >= 0 ? 1 : -1;\n    for (let i = 0; i < m; i++) {\n      const myDot = vDotN[i] * orientation;\n      if (myDot < 0) return false;\n    }\n    return true;\n  }\n\n  /**\n   *\n   * @param {*} start: 2-Array<Number>\n   * @param {*} end: 2-Array<Number>\n   * @returns 2-Array<2-Array<Number>>\n   */\n  _clipLine(start, end) {\n    const { width, height } = this.canvas;\n    const bbox = new BBox(vec2.ZERO, vec2.of(height, width));\n    const pointStack = [start, end].map((x) => vec2.of(...x));\n    const inStack = [];\n    const outStack = [];\n    for (let i = 0; i < pointStack.length; i++) {\n      const p = pointStack[i];\n      if (bbox.collidesWith(p)) {\n        inStack.push(p);\n      } else {\n        outStack.push(p);\n      }\n    }\n    // both points are inside\n    if (inStack.length >= 2) {\n      return inStack;\n    }\n    // one of them is inside\n    if (inStack.length === 1) {\n      const [inPoint] = inStack;\n      const [outPoint] = outStack;\n      return [inPoint, ...this._getLineCanvasIntersection(inPoint, outPoint)];\n    }\n    // both points are outside,need to intersect the boundary\n    return this._getLineCanvasIntersection(...outStack);\n  }\n\n  /**\n   *\n   * @param {*} start: vec2(matrix)\n   * @param {*} end: vec2(matrix)\n   */\n  _getLineCanvasIntersection(start, end) {\n    const { width, height } = this.canvas;\n    const v = end.sub(start);\n    // point and direction of boundary\n    const boundary = [\n      [vec2.ZERO, vec2.of(height, 0)],\n      [vec2.of(height, 0), vec2.of(0, width)],\n      [vec2.of(height, width), vec2.of(-height, 0)],\n      [vec2.of(0, width), vec2.of(0, -width)],\n    ];\n    const intersectionSolutions = [];\n    boundary.forEach(([s, d]) => {\n      if (d.get(0) === 0) {\n        const solution = this._solveLowTriMatrix(v, -d.get(1), s.sub(start));\n        solution !== undefined && intersectionSolutions.push(solution);\n      } else {\n        const solution = this._solveUpTriMatrix(v, -d.get(0), s.sub(start));\n        solution !== undefined && intersectionSolutions.push(solution);\n      }\n    });\n    const validIntersections = [];\n    intersectionSolutions.forEach((solution) => {\n      const [x, y] = [solution.get(0), solution.get(1)];\n      if (0 <= x && x <= 1 && 0 <= y && y <= 1) {\n        validIntersections.push(solution);\n      }\n    });\n    if (validIntersections.length === 0) return [];\n    return validIntersections.map((solution) => {\n      const t = solution.get(0);\n      return start.add(v.scale(t));\n    });\n  }\n\n  /**\n   *\n   * @param {*} v: vec2\n   * @param {*} a: number\n   * @param {*} f: vec2\n   * @returns vec2\n   */\n  _solveLowTriMatrix(v, a, f) {\n    const v1 = v.get(0);\n    const v2 = v.get(1);\n    const av1 = a * v1;\n    if (av1 === 0 || v1 === 0) return undefined;\n    const f1 = f.get(0);\n    const f2 = f.get(1);\n    return vec2.of(f1 / v1, (f2 * v1 - v2 * f1) / av1);\n  }\n\n  /**\n   *\n   * @param {*} v: vec2\n   * @param {*} a: number\n   * @param {*} f: vec2\n   * @returns vec2\n   */\n  _solveUpTriMatrix(v, a, f) {\n    const v1 = v.get(0);\n    const v2 = v.get(1);\n    const av2 = a * v2;\n    if (av2 === 0 || v2 === 0) return undefined;\n    const f1 = f.get(0);\n    const f2 = f.get(1);\n    return vec2.of(f2 / v2, (f1 * v2 - v1 * f2) / av2);\n  }\n\n  //========================================================================================\n  /*                                                                                      *\n   *                                   Static functions                                   *\n   *                                                                                      */\n  //========================================================================================\n\n  static builder() {\n    return new CanvasBuilder();\n  }\n}\n\nexport class CanvasBuilder {\n  _canvas = document.createElement(\"canvas\");\n  _width = 500;\n  _height = 500;\n  constructor() { }\n\n  width(width = this._width) {\n    this._width = width;\n    return this;\n  }\n\n  height(height = this._height) {\n    this._height = height;\n    return this;\n  }\n\n  build() {\n    this._canvas.setAttribute(\"width\", this._width);\n    this._canvas.setAttribute(\"height\", this._height);\n    return new Canvas(this._canvas);\n  }\n}\n","export const perf = (lambda) => {\n  const t = performance.now();\n  lambda();\n  return performance.now() - t;\n};\n\n/**\n *\n * @param {*} canvasBuilder : () => canvas\n * @returns\n */\nexport const testBuilder =\n  (canvasBuilder = canvasFactory) =>\n  /**\n   * Unit test maker\n   * @param {*} title\n   * @param {*} lambda: (canvas) => {}\n   */\n  (title, lambda = () => {}) => {\n    let canvas = canvasBuilder();\n    const timeInMillis = perf(() => lambda(canvas));\n    const domTest = document.createElement(\"div\");\n    const testTitle = document.createElement(\"h3\");\n    testTitle.innerText = title;\n    domTest.appendChild(testTitle);\n    domTest.appendChild(canvas.getDom());\n    const timeDom = document.createElement(\"h4\");\n    timeDom.innerText = `Test took ${timeInMillis}ms`;\n    domTest.appendChild(timeDom);\n    document.body.appendChild(domTest);\n  };\n\nconst canvasFactory = () => Canvas.builder().width(500).height(500).build();\n","export default class Animator {\n  constructor(state, next, doWhile) {\n    this.state = state;\n    this.next = next;\n    this.while = doWhile;\n    this.requestAnimeId = null;\n  }\n\n  play() {\n    this.requestAnimeId = requestAnimationFrame(() => {\n      if (!this.while(this.state)) return this.stop();\n      this.state = this.next(this.state);\n      this.play();\n    });\n    return this;\n  }\n\n  run() {\n    while (this.while(this.state)) {\n      this.state = this.next(this.state);\n    }\n    return this;\n  }\n\n  stop() {\n    cancelAnimationFrame(this.requestAnimeId);\n    return this;\n  }\n\n  static builder() {\n    return new AnimatorBuilder();\n  }\n}\n\nclass AnimatorBuilder {\n  constructor() {\n    this._state = null;\n    this._next = null;\n    this._end = null;\n  }\n\n  initialState(state) {\n    this._state = state;\n    return this;\n  }\n\n  nextState(next) {\n    this._next = next;\n    return this;\n  }\n\n  while(end) {\n    this._end = end;\n    return this;\n  }\n\n  build() {\n    const someAreEmpty = [this._state, this._next, this._end].some(\n      (x) => x === null || x === undefined\n    );\n    if (someAreEmpty) throw new Error(\"Animator properties are missing\");\n    return new Animator(this._state, this._next, this._end);\n  }\n}\n","import superPropBase from \"./superPropBase.js\";\nexport default function _get() {\n  if (typeof Reflect !== \"undefined\" && Reflect.get) {\n    _get = Reflect.get.bind();\n  } else {\n    _get = function _get(target, property, receiver) {\n      var base = superPropBase(target, property);\n      if (!base) return;\n      var desc = Object.getOwnPropertyDescriptor(base, property);\n      if (desc.get) {\n        return desc.get.call(arguments.length < 3 ? target : receiver);\n      }\n      return desc.value;\n    };\n  }\n  return _get.apply(this, arguments);\n}","import getPrototypeOf from \"./getPrototypeOf.js\";\nexport default function _superPropBase(object, property) {\n  while (!Object.prototype.hasOwnProperty.call(object, property)) {\n    object = getPrototypeOf(object);\n    if (object === null) break;\n  }\n  return object;\n}","import BBox from \"../../BBox/main/BBox\";\nimport Canvas, { CanvasBuilder } from \"../../Canvas/main/Canvas\";\nimport Matrix from \"../../Matrix/main/Matrix\";\nconst { vec2 } = Matrix;\n\nexport default class Canvas2d extends Canvas {\n  constructor(canvas, camera) {\n    super(canvas);\n    this.camera = camera;\n  }\n\n  setCamera(bbox) {\n    this.camera = bbox;\n  }\n\n  map(lambda = () => {}) {\n    return super.map((c, i, j) => {\n      const [x, y] = this.forwardCoord(i, j);\n      return lambda(c, x, y);\n    });\n  }\n\n  getPxl(x, y) {\n    const [i, j] = this.inverseCoord(x, y);\n    return super.getPxl(i, j);\n  }\n\n  setPxl(x, y, color) {\n    const [i, j] = this.inverseCoord(x, y);\n    return super.setPxl(i, j, color);\n  }\n\n  drawLine(start, end, shader) {\n    const startPos = this.inverseCoord(...start);\n    const endPos = this.inverseCoord(...end);\n    return super.drawLine(startPos, endPos, shader);\n  }\n\n  drawTriangle(p0, p1, p2, shader) {\n    const q0 = this.inverseCoord(...p0);\n    const q1 = this.inverseCoord(...p1);\n    const q2 = this.inverseCoord(...p2);\n    return super.drawTriangle(q0, q1, q2, shader);\n  }\n\n  /**\n   * Map from camera coord to canvas coord\n   */\n  inverseCoord(x, y) {\n    const { min, max } = this.camera;\n    const { width, height } = this.canvas;\n    const [minX, minY] = min.data;\n    const [maxX, maxY] = max.data;\n    return [\n      (-(y - maxY) * (height - 1)) / (maxY - minY),\n      ((x - minX) * (width - 1)) / (maxX - minX),\n    ].map(Math.floor);\n  }\n\n  /**\n   * Map from canvas coord to camera coord\n   */\n  forwardCoord(i, j) {\n    const { min, max } = this.camera;\n    const { width, height } = this.canvas;\n    const [minX, minY] = min.data;\n    const [maxX, maxY] = max.data;\n    return [\n      minX + ((maxX - minX) * j) / (width - 1),\n      maxY + ((minY - maxY) * i) / (height - 1),\n    ];\n  }\n\n  static builder() {\n    return new Canvas2dBuilder();\n  }\n}\n\nexport class Canvas2dBuilder extends CanvasBuilder {\n  _camera = new BBox(vec2.of(-1, -1), vec2.of(1, 1));\n\n  camera(bbox = this._camera) {\n    this._camera = bbox;\n    return this;\n  }\n\n  build() {\n    const canvasBase = super.build();\n    return new Canvas2d(canvasBase.canvas, this._camera);\n  }\n}\n"],"names":["root","factory","exports","module","define","amd","self","__webpack_require__","definition","key","o","Object","defineProperty","enumerable","get","obj","prop","prototype","hasOwnProperty","call","Symbol","toStringTag","value","ImageIO","img","canvasAux","document","createElement","width","height","contextAux","getContext","fillStyle","globalCompositeOperation","fillRect","drawImage","canvas","getImageCanvas","getImageData","src","Image","isReady","onload","add","u","v","ans","floor","x","Math","diff","dot","squareNorm","norm","sqrt","min","max","solve2by2UpperTriMatrix","h","z","aux","solve2by2LowerTriMatrix","w","hashMap","Canvas","this","ctx","image","imageData","data","getSize","paintImage","putImageData","getCanvas","clearImage","rgba","useCanvasCtx","size","lambda","arguments","length","undefined","getImageIndex","getPxl","index","drawPxl","rgb","drawLine","x1","x2","shader","points","stack","push","inStack","outStack","i","intersectionSolutions","validIntersection","p","drawLineInt","pop","p0","n","nn","tangent","normal","fmin","Number","MAX_VALUE","minDir","k","j","f","abs","drawPolygon","array","isInsidePoly","isInsidePolygon","upperBox","MIN_VALUE","clampedSize","zeros","drawTriangle","x3","isInsideConvex","drawQuad","x4","drawCircle","r","corner","scale","isInsideCircle","addEventListener","useCapture","drawString","string","contextShader","fillText","theta","acos","PI","m","vDotN","orientation","simpleShader","color","element","colorShader","colors","interpolateTriangleShader","poly","alpha","interpolateColors","interpolateQuadShader","quad","t1","t2","triangleBaryCoord","triangle","interpolateLineShader","line","vnorm","projection","quadTextureShader","quadTexCoord","interpolation","bilinearInterpolation","imageCache","imageCanvas","imgSize","interpolateTexCoord","cornerColors","finalColor","triangleCache","constains","triangleHash","set","reduce","hash","y","det","map","cache","values","acc","f03","createCanvas","domId","setAttribute","getElementById","appendChild","Canvas2D","cameraSpace","create","constructor","integerTransform","inverseTransform","y1","y2","y3","y4","setCamera","camera","_arrayLikeToArray","arr","len","arr2","Array","_unsupportedIterableToArray","minLen","toString","slice","name","from","test","_toConsumableArray","isArray","iter","iterator","TypeError","_slicedToArray","l","t","e","a","next","done","_classCallCheck","instance","Constructor","_typeof","_toPropertyKey","arg","input","hint","prim","toPrimitive","res","String","_defineProperties","target","props","descriptor","configurable","writable","_createClass","protoProps","staticProps","_defineProperty","MAX_8BIT","Color","red","green","blue","Uint8Array","random","ofRGBA","_setPrototypeOf","setPrototypeOf","bind","__proto__","_inherits","subClass","superClass","_assertThisInitialized","ReferenceError","_possibleConstructorReturn","_getPrototypeOf","getPrototypeOf","_construct","Parent","args","Class","Reflect","construct","sham","Proxy","Boolean","valueOf","apply","Function","_wrapNativeSuper","_cache","Map","fn","indexOf","has","Wrapper","_class","getIndexFromCoord","_","getCoordFromIndex","MatrixBuilder","_size","MatrixError","concat","index2Key","_this","_this$_size","Float64Array","indexer","keys","forEach","split","Matrix","RowBuilder","rows","dim","_len","_key","_buildWithRows","cols","indexF","_buildWithCols","WeakSet","ColBuilder","_len2","_key2","_classPrivateMethodGet","_buildWithCols2","shape","_this$shape","matrix","prod","getCoord","_getCoord2","identity","_getCoord4","binaryLambda","_this$shape2","_matrix$shape","mRows","mCols","op","b","real","precision","sub","error","builder","build","_ColBuilder","addCol","_RowBuilder","addRow","_class2","en","matrixBuilder","colBuilder","_matrixBuilder","of","vec","e0","e1","ZERO","e2","_Error","_super","Error","BBox","isEmpty","center","diagonal","box","EMPTY","newMin","newMax","every","vector","actionByTypes","type","action","equals","point","vec2","willReadFrequently","ofRGBARaw","console","log","_this$canvas","_this$canvas2","start","end","_this$canvas3","_clipLine","toArray","_line","p1","s","_x","p2","_drawConvexPolygon","arrayOfPoints","_this$canvas4","canvasBox","boundingBox","ofPoint","finalBox","inter","_finalBox$min$toArray2","xMin","yMin","_finalBox$max$toArray2","xMax","yMax","_isInsideConvex","vi","_this$canvas5","bbox","pointStack","collidesWith","inPoint","outPoint","_getLineCanvasIntersection","_this$canvas6","boundary","_ref","_ref2","d","solution","_solveLowTriMatrix","_solveUpTriMatrix","validIntersections","_ref3","v1","v2","av1","f1","f2","av2","CanvasBuilder","_width","_height","_canvas","perf","performance","now","testBuilder","canvasBuilder","canvasFactory","title","timeInMillis","domTest","testTitle","innerText","getDom","timeDom","body","Animator","state","doWhile","requestAnimeId","requestAnimationFrame","stop","play","cancelAnimationFrame","AnimatorBuilder","_state","_next","_end","some","_get","property","receiver","base","object","desc","getOwnPropertyDescriptor","Canvas2d","_Canvas","_createSuper","_this2","c","_this2$forwardCoord2","forwardCoord","_this$inverseCoord2","inverseCoord","_this$inverseCoord4","startPos","endPos","q0","q1","q2","_this$camera","_min$data","minX","minY","_max$data","maxX","maxY","_this$camera2","_min$data2","_max$data2","Canvas2dBuilder","_CanvasBuilder","_super2","_this3","_camera","canvasBase"],"sourceRoot":""}