{"version":3,"sources":["webpack://Tela/webpack/universalModuleDefinition","webpack://Tela/webpack/bootstrap","webpack://Tela/./src/Canvas_old/main/Canvas.js","webpack://Tela/./src/Canvas_old/main/Canvas2D.js","webpack://Tela/./src/Canvas_old/main/ImageIO.js","webpack://Tela/./src/index.js"],"names":["scale","u","r","ans","add","v","floor","x","Math","diff","dot","squareNorm","norm","sqrt","min","max","solve2by2UpperTriMatrix","h","z","aux","solve2by2LowerTriMatrix","w","Canvas","canvas","ctx","getContext","image","getImageData","width","height","imageData","data","prototype","getSize","paintImage","putImageData","getCanvas","clearImage","rgba","useCanvasCtx","size","fillStyle","globalCompositeOperation","fillRect","lambda","isClearImage","getImageIndex","getPxl","index","drawPxl","rgb","drawLine","x1","x2","shader","points","stack","push","inStack","outStack","i","length","drawLineInt","intersectionSolutions","validIntersection","p","pop","p0","n","nn","tangent","normal","fmin","Number","MAX_VALUE","minDir","k","j","nextX","f","abs","drawPolygon","array","isInsidePoly","isInsidePolygon","upperBox","MIN_VALUE","clampedSize","zeros","drawTriangle","x3","isInsideConvex","drawQuad","x4","drawImage","img","isReady","drawCircle","corner","isInsideCircle","addEventListener","key","useCapture","drawString","string","contextShader","fillText","theta","acos","PI","m","vDotN","orientation","myDot","simpleShader","color","element","colorShader","colors","auxShader","poly","alpha","interpolateColors","interpolateTriangleShader","interpolateQuadShader","quad","t1","t2","triangleBaryCoord","triangle","interpolateLineShader","line","vnorm","projection","t","quadTextureShader","quadTexCoord","interpolation","bilinearInterpolation","imageCache","imageShader","ImageIO","getImageCanvas","imageCanvas","imgSize","interpolateTexCoord","cornerColors","finalColor","triangleCache","hashMap","constains","triangleHash","undefined","get","set","value","reduce","hash","y","det","map","cache","values","acc","f03","f12","createCanvas","domId","document","createElement","setAttribute","getElementById","appendChild","Canvas2D","cameraSpace","call","Object","create","constructor","integerTransform","xint","yint","inverseTransform","xt","yt","y1","y2","y3","y4","setCamera","camera","canvasAux","contextAux","getDataFromImage","loadImage","src","Image","onload","generateImageReadyPredicate"],"mappings":"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","file":"index.js","sourcesContent":["(function webpackUniversalModuleDefinition(root, factory) {\n\tif(typeof exports === 'object' && typeof module === 'object')\n\t\tmodule.exports = factory();\n\telse if(typeof define === 'function' && define.amd)\n\t\tdefine([], factory);\n\telse if(typeof exports === 'object')\n\t\texports[\"Tela\"] = factory();\n\telse\n\t\troot[\"Tela\"] = factory();\n})(window, function() {\nreturn "," \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId]) {\n \t\t\treturn installedModules[moduleId].exports;\n \t\t}\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, { enumerable: true, get: getter });\n \t\t}\n \t};\n\n \t// define __esModule on exports\n \t__webpack_require__.r = function(exports) {\n \t\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n \t\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n \t\t}\n \t\tObject.defineProperty(exports, '__esModule', { value: true });\n \t};\n\n \t// create a fake namespace object\n \t// mode & 1: value is a module id, require it\n \t// mode & 2: merge all properties of value into the ns\n \t// mode & 4: return value when already ns object\n \t// mode & 8|1: behave like require\n \t__webpack_require__.t = function(value, mode) {\n \t\tif(mode & 1) value = __webpack_require__(value);\n \t\tif(mode & 8) return value;\n \t\tif((mode & 4) && typeof value === 'object' && value && value.__esModule) return value;\n \t\tvar ns = Object.create(null);\n \t\t__webpack_require__.r(ns);\n \t\tObject.defineProperty(ns, 'default', { enumerable: true, value: value });\n \t\tif(mode & 2 && typeof value != 'string') for(var key in value) __webpack_require__.d(ns, key, function(key) { return value[key]; }.bind(null, key));\n \t\treturn ns;\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(__webpack_require__.s = \"./src/index.js\");\n","import ImageIO from \"./ImageIO\";\n/*\n Canvas coordinates\n\n 0                  W-1\n +-------------> y\n |\n |\n |       *\n |\n |\n v x\n\n H-1\n */\n\n/*\n\nThe point xe_1 + ye_2 corresponds to a point in the middle of a pxl.\n\nThe canvas data is an array of length colors(C) * width(W) * height(H). Is a 3D-array.\nThe index is a number in [0, C * W * H - 1].\nHaving (x, y, z) where z is the color axis, the formula to index the array is :\n\nf(x, y, z) = C * W * x + C * y + z.\n\nWhere x in [0, H - 1], y in [0, W - 1] and z in [0, C - 1].\n\nNote that f(H - 1, W - 1, C - 1) = C * W * H - 1.\n*/\n\n// Auxiliary functions\nfunction scale(u, r) {\n  var ans = [];\n  ans[0] = u[0] * r;\n  ans[1] = u[1] * r;\n  return ans;\n}\n\nfunction add(u, v) {\n  var ans = [];\n  ans[0] = u[0] + v[0];\n  ans[1] = u[1] + v[1];\n  return ans;\n}\n\nfunction floor(x) {\n  var ans = [];\n  ans[0] = Math.floor(x[0]);\n  ans[1] = Math.floor(x[1]);\n  return ans;\n}\n\nfunction diff(u, v) {\n  var ans = [];\n  ans[0] = u[0] - v[0];\n  ans[1] = u[1] - v[1];\n  return ans;\n}\n\nfunction dot(u, v) {\n  return u[0] * v[0] + u[1] * v[1];\n}\n\nfunction squareNorm(x) {\n  return dot(x, x);\n}\n\nfunction norm(x) {\n  return Math.sqrt(dot(x, x));\n}\n\nfunction min(u, v) {\n  var ans = [];\n  ans[0] = Math.min(u[0], v[0]);\n  ans[1] = Math.min(u[1], v[1]);\n  return ans;\n}\n\nfunction max(u, v) {\n  var ans = [];\n  ans[0] = Math.max(u[0], v[0]);\n  ans[1] = Math.max(u[1], v[1]);\n  return ans;\n}\n\n/**\n * return solution to : [ u_0 , h] x = z_0\n *\n *                       [ u_1,  0] y = z_1\n */\nfunction solve2by2UpperTriMatrix(u, h, z) {\n  var aux = z[1] / u[1];\n  return [aux, (-u[0] * aux + z[0]) / h];\n}\n/**\n * return solution to : [ u_0 , 0] x = z_0\n *\n *                       [ u_1,  w] y = z_1\n */\nfunction solve2by2LowerTriMatrix(u, w, z) {\n  var aux = z[0] / u[0];\n  return [aux, (-u[1] * aux + z[1]) / w];\n}\n\n// Canvas\nvar Canvas = function (canvas) {\n  this.canvas = canvas;\n  this.ctx = canvas.getContext(\"2d\");\n  this.image = this.ctx.getImageData(0, 0, canvas.width, canvas.height);\n  // width * height * 4 array of integers\n  this.imageData = this.image.data;\n};\n\n/**\n * Returns a two vector with Height as first coordinate and Width as second. [Height, Width].\n */\nCanvas.prototype.getSize = function () {\n  return [this.canvas.height, this.canvas.width];\n};\n\n/**\n *  Draw update image on canvas.\n */\nCanvas.prototype.paintImage = function () {\n  this.ctx.putImageData(this.image, 0, 0);\n};\n\nCanvas.prototype.getCanvas = function () {\n  return this.canvas;\n};\n\n/**\n * Clear Image with @rgba color.\n *\n * @param rgba\n */\nCanvas.prototype.clearImage = function (rgba) {\n  this.useCanvasCtx((canvas) => {\n    var size = canvas.getSize();\n    canvas.ctx.fillStyle =\n      \"rgba(\" + rgba[0] + \",\" + rgba[1] + \",\" + rgba[2] + \",\" + rgba[3] + \")\";\n    canvas.ctx.globalCompositeOperation = \"source-over\";\n    canvas.ctx.fillRect(0, 0, size[1], size[0]);\n  }, true);\n};\n\nCanvas.prototype.useCanvasCtx = function (lambda, isClearImage = false) {\n  if (!isClearImage) {\n    this.ctx.putImageData(this.image, 0, 0);\n  }\n  lambda(this);\n  this.image = this.ctx.getImageData(\n    0,\n    0,\n    this.canvas.width,\n    this.canvas.height\n  );\n  this.imageData = this.image.data;\n};\n\nCanvas.prototype.getImageIndex = function (x) {\n  return 4 * (this.canvas.width * x[0] + x[1]);\n};\n\nCanvas.prototype.getPxl = function (x) {\n  var index = this.getImageIndex(x);\n  return [\n    this.imageData[index],\n    this.imageData[index + 1],\n    this.imageData[index + 2],\n    this.imageData[index + 3],\n  ];\n};\n\nCanvas.prototype.drawPxl = function (x, rgb) {\n  var index = this.getImageIndex(x);\n  this.imageData[index] = rgb[0];\n  this.imageData[index + 1] = rgb[1];\n  this.imageData[index + 2] = rgb[2];\n  this.imageData[index + 3] = rgb[3];\n};\n\n/*\n * x1     :   2-dim array\n * x2     :   2-dim array\n * shader :   is a function that receives a 2-dim array and a line (array with 2 points) and returns a rgba 4-dim array\n */\nCanvas.prototype.drawLine = function (x1, x2, shader) {\n  // add points before clip\n  shader.points = [x1, x2];\n\n  // do clipping\n  var stack = [];\n  stack.push(x1);\n  stack.push(x2);\n  var inStack = [];\n  var outStack = [];\n  for (var i = 0; i < stack.length; i++) {\n    var x = stack[i];\n    if (\n      0 <= x[0] &&\n      x[0] < this.canvas.height &&\n      0 <= x[1] &&\n      x[1] < this.canvas.width\n    ) {\n      inStack.push(x);\n    } else {\n      outStack.push(x);\n    }\n  }\n  // both points are inside canvas\n  if (inStack.length == 2) {\n    this.drawLineInt(inStack[0], inStack[1], shader);\n    return;\n  }\n  //intersecting line with canvas\n  var intersectionSolutions = [];\n  var v = [x2[0] - x1[0], x2[1] - x1[1]];\n  // Let s \\in [0,1]\n  // line intersection with [0, 0]^T + [H - 1, 0]^T s\n  intersectionSolutions.push(\n    solve2by2UpperTriMatrix(v, -(this.canvas.height - 1), [-x1[0], -x1[1]])\n  );\n  // line intersection with [H - 1, 0]^T + [0, W - 1]^T s\n  intersectionSolutions.push(\n    solve2by2LowerTriMatrix(v, -(this.canvas.width - 1), [\n      this.canvas.height - 1 - x1[0],\n      -x1[1],\n    ])\n  );\n  // line intersection with [H - 1, W - 1]^T + [-(H - 1), 0]^T s\n  intersectionSolutions.push(\n    solve2by2UpperTriMatrix(v, this.canvas.height - 1, [\n      this.canvas.height - 1 - x1[0],\n      this.canvas.width - 1 - x1[1],\n    ])\n  );\n  // line intersection with [0, W - 1]^T + [0, -(W - 1)]^T s\n  intersectionSolutions.push(\n    solve2by2LowerTriMatrix(v, this.canvas.width - 1, [\n      -x1[0],\n      this.canvas.width - 1 - x1[1],\n    ])\n  );\n\n  var validIntersection = [];\n  for (var i = 0; i < intersectionSolutions.length; i++) {\n    var x = intersectionSolutions[i];\n    if (0 <= x[0] && x[0] <= 1 && 0 <= x[1] && x[1] <= 1) {\n      validIntersection.push(x);\n    }\n  }\n\n  if (validIntersection.length == 0) return;\n\n  //it can be shown that at this point there is at least one valid intersection.\n  if (inStack.length > 0) {\n    var p = [\n      x1[0] + validIntersection[0][0] * v[0],\n      x1[1] + validIntersection[0][0] * v[1],\n    ];\n    this.drawLineInt(inStack.pop(), p, shader);\n    return;\n  }\n\n  var p0 = [\n    x1[0] + validIntersection[0][0] * v[0],\n    x1[1] + validIntersection[0][0] * v[1],\n  ];\n  for (var i = 1; i < validIntersection.length; i++) {\n    var p = [\n      x1[0] + validIntersection[i][0] * v[0],\n      x1[1] + validIntersection[i][0] * v[1],\n    ];\n    var v = diff(p, p0);\n    if (dot(v, v) > 1e-3) {\n      this.drawLineInt(p0, p, shader);\n      return;\n    }\n  }\n  this.drawLineInt(p0, p0, shader);\n};\n\nCanvas.prototype.drawLineInt = function (x1, x2, shader) {\n  x1 = floor(x1);\n  x2 = floor(x2);\n\n  var index = [-1, 0, 1];\n\n  var n = index.length;\n  var nn = n * n;\n\n  var x = [];\n  x[0] = x1[0];\n  x[1] = x1[1];\n\n  var tangent = diff(x2, x1);\n  var normal = [];\n  normal[0] = -tangent[1];\n  normal[1] = tangent[0];\n\n  shader(x, shader.points, this);\n\n  while (x[0] !== x2[0] || x[1] !== x2[1]) {\n    var fmin = Number.MAX_VALUE;\n    var minDir = [];\n    for (var k = 0; k < nn; k++) {\n      var i = index[k % n];\n      var j = index[Math.floor(k / n)];\n\n      var nextX = add(x, [i, j]);\n\n      var v = diff(nextX, x1);\n      var f = Math.abs(dot(v, normal)) - dot(v, tangent);\n      if (fmin > f) {\n        fmin = f;\n        minDir = [i, j];\n      }\n    }\n\n    x = add(x, minDir);\n    shader(x, shader.points, this);\n  }\n  shader(x, shader.points, this);\n};\n\nCanvas.prototype.drawPolygon = function (\n  array,\n  shader,\n  isInsidePoly = Canvas.isInsidePolygon\n) {\n  let upperBox = [\n    [Number.MAX_VALUE, Number.MAX_VALUE],\n    [Number.MIN_VALUE, Number.MIN_VALUE],\n  ];\n  for (let i = 0; i < array.length; i++) {\n    upperBox[0] = min(array[i], upperBox[0]);\n    upperBox[1] = max(array[i], upperBox[1]);\n  }\n\n  let size = this.getSize();\n  let clampedSize = diff(size, [1, 1]);\n  let zeros = [0, 0];\n  upperBox[0] = floor(min(clampedSize, max(zeros, upperBox[0])));\n  upperBox[1] = floor(min(clampedSize, max(zeros, upperBox[1])));\n\n  for (var i = upperBox[0][0]; i < upperBox[1][0]; i++) {\n    for (var j = upperBox[0][1]; j < upperBox[1][1]; j++) {\n      var x = [i, j];\n      if (isInsidePoly(x, array)) {\n        shader(x, array, this);\n      }\n    }\n  }\n};\n\n/*\n * x1     :   2-dim array\n * x2     :   2-dim array\n * x3     :   2-dim array\n * shader :   is a function that receives a 2-dim array and a triangle (array with 3 points) and returns a rgba 4-dim array\n */\nCanvas.prototype.drawTriangle = function (x1, x2, x3, shader) {\n  var array = [x1, x2, x3];\n  this.drawPolygon(array, shader, Canvas.isInsideConvex);\n};\n\n/* x1     :   2-dim array\n * x2     :   2-dim array\n * x3     :   2-dim array\n * x4     :   2-dim array\n * shader :   is a function that receives a 2-dim array and returns a rgba 4-dim array\n */\nCanvas.prototype.drawQuad = function (x1, x2, x3, x4, shader) {\n  this.drawPolygon([x1, x2, x3, x4], shader);\n};\n\nCanvas.prototype.drawImage = function (img, x) {\n  if (\"isReady\" in img && !img.isReady) return;\n  this.useCanvasCtx((canvas) => canvas.ctx.drawImage(img, x[1], x[0]));\n};\n\nCanvas.prototype.drawCircle = function (x, r, shader) {\n  var corner = scale([1, 1], r);\n  var upperBox = [diff(x, corner), add(x, corner)];\n  var size = this.getSize();\n  upperBox[0] = floor(min(diff(size, [1, 1]), max([0, 0], upperBox[0])));\n  upperBox[1] = floor(min(diff(size, [1, 1]), max([0, 0], upperBox[1])));\n  for (var i = upperBox[0][0]; i <= upperBox[1][0]; i++) {\n    for (var j = upperBox[0][1]; j <= upperBox[1][1]; j++) {\n      var p = [i, j];\n      if (this.isInsideCircle(p, x, r)) {\n        shader(p, [x, r], this);\n      }\n    }\n  }\n};\n\nCanvas.prototype.isInsideCircle = function (p, x, r) {\n  return squareNorm(diff(p, x)) <= r * r;\n};\n\nCanvas.prototype.addEventListener = function (key, lambda, useCapture) {\n  this.canvas.addEventListener(key, lambda, useCapture);\n};\n\nCanvas.prototype.drawString = function (x, string, contextShader) {\n  this.useCanvasCtx((canvas) => {\n    contextShader(canvas.ctx);\n    canvas.ctx.fillText(string, x[1], x[0]);\n  });\n};\n\n// Static functions\n\n// slower than isInsideConvex method\nCanvas.isInsidePolygon = function (x, array) {\n  var v = [];\n  var theta = 0;\n  var n = array.length;\n  for (var i = 0; i < n; i++) {\n    v[0] = diff(array[(i + 1) % n], x);\n    v[1] = diff(array[i], x);\n    theta += Math.acos(dot(v[0], v[1]) / (norm(v[0]) * norm(v[1])));\n  }\n  return Math.abs(theta - 2 * Math.PI) < 1e-3;\n};\n\nCanvas.isInsideConvex = function (x, array) {\n  var m = array.length;\n  var v = [];\n  var vDotN = [];\n  for (var i = 0; i < m; i++) {\n    v[i] = diff(array[(i + 1) % m], array[i]);\n    let n = [-v[i][1], v[i][0]];\n    let r = diff(x, array[i]);\n    vDotN[i] = dot(r, n);\n  }\n  let orientation = v[0][0] * v[1][1] - v[0][1] * v[1][0] > 0 ? 1 : -1;\n  for (var i = 0; i < m; i++) {\n    var myDot = vDotN[i] * orientation;\n    if (myDot < 0) return false;\n  }\n  return true;\n};\n\nCanvas.simpleShader = function (color) {\n  return (x, element, canvas) => canvas.drawPxl(x, color);\n};\n\nCanvas.colorShader = function (colors) {\n  var auxShader = (x, poly, canvas, alpha) => {\n    var interpolateColors = [0, 0, 0, 0];\n    for (var i = 0; i < poly.length; i++) {\n      interpolateColors[0] = interpolateColors[0] + colors[i][0] * alpha[i];\n      interpolateColors[1] = interpolateColors[1] + colors[i][1] * alpha[i];\n      interpolateColors[2] = interpolateColors[2] + colors[i][2] * alpha[i];\n      interpolateColors[3] = interpolateColors[3] + colors[i][3] * alpha[i];\n    }\n    canvas.drawPxl(x, interpolateColors);\n  };\n  return Canvas.interpolateTriangleShader(auxShader);\n};\n\nCanvas.interpolateQuadShader = function (shader) {\n  return function (x, quad, canvas) {\n    var t1 = [quad[0], quad[1], quad[2]];\n    var t2 = [quad[2], quad[3], quad[0]];\n    var alpha = Canvas.triangleBaryCoord(x, t1);\n    if (\n      alpha[0] > 0 &&\n      alpha[1] > 0 &&\n      alpha[2] > 0 &&\n      Math.abs(alpha[0] + alpha[1] + alpha[2] - 1) < 1e-10\n    ) {\n      shader(x, quad, canvas, [alpha[0], alpha[1], alpha[2], 0]);\n    } else {\n      alpha = Canvas.triangleBaryCoord(x, t2);\n      shader(x, quad, canvas, [alpha[2], 0, alpha[0], alpha[1]]);\n    }\n  };\n};\n\nCanvas.interpolateTriangleShader = function (shader) {\n  return (x, triangle, canvas) => {\n    const alpha = Canvas.triangleBaryCoord(x, triangle);\n    shader(x, triangle, canvas, alpha);\n  };\n};\n\nCanvas.interpolateLineShader = function (shader) {\n  return (x, line, canvas) => {\n    var v = diff(line[1], line[0]);\n    var z = diff(x, line[0]);\n    var vnorm = squareNorm(v);\n    var projection = dot(z, v);\n    var t = vnorm == 0.0 ? 0 : projection / vnorm;\n    shader(x, line, canvas, t);\n  };\n};\n\n/**\n * img: html loaded image.\n * quadTexCoord: [0, 1]^{2 * 4}, texture coordinates\n */\nCanvas.quadTextureShader = function (\n  img,\n  quadTexCoord,\n  interpolation = Canvas.bilinearInterpolation\n) {\n  let imageCache = null;\n  const imageShader = (x, quad, canvas, alpha) => {\n    if (!img.isReady || imageCache == null)\n      imageCache = new Canvas(ImageIO.getImageCanvas(img));\n    const imageCanvas = imageCache;\n    const imgSize = imageCanvas.getSize();\n    const interpolateTexCoord = [0, 0];\n    for (let i = 0; i < quadTexCoord.length; i++) {\n      interpolateTexCoord[0] =\n        interpolateTexCoord[0] + quadTexCoord[i][0] * alpha[i];\n      interpolateTexCoord[1] =\n        interpolateTexCoord[1] + quadTexCoord[i][1] * alpha[i];\n    }\n    var i = [\n      (1 - interpolateTexCoord[1]) * (imgSize[1] - 1),\n      (imgSize[0] - 1) * interpolateTexCoord[0],\n    ];\n    // bound coordinates\n    i = max([0, 0], min(diff([imgSize[0], imgSize[1]], [1, 1]), i));\n    // pxl lower corner\n    var j = floor(i);\n    var cornerColors = [\n      imageCanvas.getPxl(j),\n      imageCanvas.getPxl(add(j, [1, 0])),\n      imageCanvas.getPxl(add(j, [1, 1])),\n      imageCanvas.getPxl(add(j, [0, 1])),\n    ];\n    var finalColor = interpolation(cornerColors, diff(i, j));\n    canvas.drawPxl(x, finalColor);\n  };\n  return Canvas.interpolateQuadShader(imageShader);\n};\n\nCanvas.triangleCache = (() => {\n  const hashMap = [];\n  const size = 3;\n  return {\n    constains: (triangleHash) => hashMap[triangleHash % size] != undefined,\n    get: (triangleHash) => hashMap[triangleHash % size],\n    set: (triangleHash, value) => (hashMap[triangleHash % size] = value),\n  };\n})(); //{triangle: null, u: [], v:[], det:null, hash:null}\n\nCanvas.triangleHash = (triangle) => {\n  const array = [\n    triangle[0][0],\n    triangle[1][0],\n    triangle[2][0],\n    triangle[0][1],\n    triangle[1][1],\n    triangle[2][1],\n  ];\n  return array.reduce((h, x) => 31 * h + x, 1);\n};\n\nCanvas.triangleBaryCoord = function (x, triangle) {\n  const hash = Canvas.triangleHash(triangle);\n  const y = [x[0] - triangle[0][0], x[1] - triangle[0][1]];\n  if (!Canvas.triangleCache.constains(hash)) {\n    const u = [\n      triangle[1][0] - triangle[0][0],\n      triangle[1][1] - triangle[0][1],\n    ];\n    const v = [\n      triangle[2][0] - triangle[0][0],\n      triangle[2][1] - triangle[0][1],\n    ];\n    const det = u[0] * v[1] - u[1] * v[0];\n    Canvas.triangleCache.set(hash, {\n      triangle: triangle,\n      u: u.map((x) => x / det),\n      v: v.map((x) => x / det),\n      det: det,\n      hash: hash,\n    });\n  }\n  const cache = Canvas.triangleCache.get(hash);\n  const u = cache.u;\n  const v = cache.v;\n  const det = cache.det;\n  if (det == 0) return [0, 0, 0];\n  var alpha = [v[1] * y[0] - v[0] * y[1], u[0] * y[1] - u[1] * y[0]];\n  return [1 - alpha[0] - alpha[1], alpha[0], alpha[1]];\n};\n\n/**\n * values \\in R^{k * 4}\n * x \\in [0,1]^2\n */\nCanvas.bilinearInterpolation = function (values, x) {\n  var acc = [];\n  for (var k = 0; k < values.length; k++) {\n    var f03 = values[0][k] + (values[3][k] - values[0][k]) * x[1];\n    var f12 = values[1][k] + (values[2][k] - values[1][k]) * x[1];\n    var f = f03 + (f12 - f03) * x[0];\n    acc.push(f);\n  }\n  return acc;\n};\n/**\n * size: is an array with width and height of a HTML5 Canvas.\n * domId: DOM element where the canvas will be added\n *\n * returns Canvas object from the generated html canvas.\n */\nCanvas.createCanvas = function (size, domId) {\n  const canvas = document.createElement(\"canvas\");\n  canvas.setAttribute(\"width\", size[0]);\n  canvas.setAttribute(\"height\", size[1]);\n  document.getElementById(domId).appendChild(canvas);\n  return canvas;\n};\n\nexport default Canvas;\n","import Canvas from \"./Canvas\";\n\n//Note that we can switch from heritage to composition, think about that\n\n// cameraSpace : 2-dim array with two 2-dim arrays that are intervals [a,b] | a < b\nvar Canvas2D = function (canvas, cameraSpace) {\n  Canvas.call(this, canvas);\n  if (\n    cameraSpace.length != 2 ||\n    (cameraSpace[0].length != 2 && cameraSpace[1].length != 2)\n  ) {\n    throw \"camera space must be 2-dim array with 2-dim arrays representing an interval\";\n  }\n  this.cameraSpace = cameraSpace;\n};\n\nCanvas2D.prototype = Object.create(Canvas.prototype);\nCanvas2D.prototype.constructor = Canvas2D;\n\n/* x : 2-dim array in camera space coordinates\n * returns : 2-dim array in integer coordinates\n */\nCanvas2D.prototype.integerTransform = function (x) {\n  var xint =\n    (-(this.canvas.height - 1) /\n      (this.cameraSpace[1][1] - this.cameraSpace[1][0])) *\n    (x[1] - this.cameraSpace[1][1]);\n  var yint =\n    ((this.canvas.width - 1) /\n      (this.cameraSpace[0][1] - this.cameraSpace[0][0])) *\n    (x[0] - this.cameraSpace[0][0]);\n  return [xint, yint];\n};\n\n/* x : 2-dim array in integer coordinates\n * returns : 2-dim array in camera space coordinates\n */\nCanvas2D.prototype.inverseTransform = function (x) {\n  var xt =\n    this.cameraSpace[0][0] +\n    ((this.cameraSpace[0][1] - this.cameraSpace[0][0]) /\n      (this.canvas.width - 1)) *\n      x[1];\n  var yt =\n    this.cameraSpace[1][1] -\n    ((this.cameraSpace[1][1] - this.cameraSpace[1][0]) /\n      (this.canvas.height - 1)) *\n      x[0];\n  return [xt, yt];\n};\n\n/* x1     :   2-dim array\n * x2     :   2-dim array\n * shader :   is a function that receives a 2-dim array and returns a rgba 4-dim array\n */\nCanvas2D.prototype.drawLine = function (x1, x2, shader) {\n  const y1 = this.integerTransform(x1);\n  const y2 = this.integerTransform(x2);\n  Canvas.prototype.drawLine.call(this, y1, y2, shader);\n};\n\n/* x1     :   2-dim array\n * x2     :   2-dim array\n * x3     :   2-dim array\n * shader :   is a function that receives a 2-dim array and returns a rgba 4-dim array\n */\nCanvas2D.prototype.drawTriangle = function (x1, x2, x3, shader) {\n  const y1 = this.integerTransform(x1);\n  const y2 = this.integerTransform(x2);\n  const y3 = this.integerTransform(x3);\n  Canvas.prototype.drawTriangle.call(this, y1, y2, y3, shader);\n};\n\n/* x1     :   2-dim array\n * x2     :   2-dim array\n * x3     :   2-dim array\n * x4     :   2-dim array\n * shader :   is a function that receives a 2-dim array and returns a rgba 4-dim array\n */\nCanvas2D.prototype.drawQuad = function (x1, x2, x3, x4, shader) {\n  const y1 = this.integerTransform(x1);\n  const y2 = this.integerTransform(x2);\n  const y3 = this.integerTransform(x3);\n  const y4 = this.integerTransform(x4);\n  Canvas.prototype.drawQuad.call(this, y1, y2, y3, y4, shader);\n};\n\nCanvas2D.prototype.drawCircle = function (x, r, shader) {\n  // it assumes squared canvas, for now ...\n  const y = this.integerTransform(x);\n  const z = this.integerTransform([r, 0])[1] - this.integerTransform([0, 0])[1];\n  Canvas.prototype.drawCircle.call(this, y, z, shader);\n};\n\nCanvas2D.prototype.drawImage = function (img, x) {\n  Canvas.prototype.drawImage.call(this, img, this.integerTransform(x));\n};\n\nCanvas2D.prototype.drawString = function (x, string, contextShader) {\n  const y = this.integerTransform(x);\n  Canvas.prototype.drawString.call(this, y, string, contextShader);\n};\n\n// camera : 2-dim array with two 2-dim arrays that are intervals [a,b] | a < b\nCanvas2D.prototype.setCamera = function (camera) {\n  if (camera.length != 2 || (camera[0].length != 2 && camera[1].length != 2)) {\n    throw \"camera space must be 2-dim array with 2-dim arrays representing an interval\";\n  }\n  this.cameraSpace = camera;\n};\n\nexport default Canvas2D;\n","const ImageIO = {\n  // empty object\n};\n\n/**\n * img : html image\n */\nImageIO.getImageCanvas = img => {\n  const canvasAux = document.createElement(\"canvas\");\n  canvasAux.width = img.width;\n  canvasAux.height = img.height;\n  const contextAux = canvasAux.getContext(\"2d\");\n  contextAux.fillStyle = \"rgba(0, 0, 0, 0)\";\n  contextAux.globalCompositeOperation = \"source-over\";\n  contextAux.fillRect(0, 0, canvasAux.width, canvasAux.height);\n  contextAux.drawImage(img, 0, 0);\n  return canvasAux;\n};\n\n/**\n * img : html image\n */\nImageIO.getDataFromImage = img => {\n  canvas = ImageIO.getImageCanvas(img);\n  return canvas.getContext(\"2d\").getImageData(0, 0, img.width, img.height);\n};\n\nImageIO.loadImage = src => {\n  const img = new Image();\n  img.src = src;\n  img.isReady = false;\n  img.onload = () => (img.isReady = true);\n  return img;\n};\n\nImageIO.generateImageReadyPredicate = img => () => img.isReady;\n\nexport default ImageIO;\n","import Canvas_old from \"./Canvas_old/main/Canvas\";\nimport Canvas2D_old from \"./Canvas_old/main/Canvas2D\";\nimport ImageIO from \"./Canvas_old/main/ImageIO\";\nexport { Canvas_old, Canvas2D_old, ImageIO };\n"],"sourceRoot":""}