{"version":3,"sources":["webpack://Tela/webpack/universalModuleDefinition","webpack://Tela/webpack/bootstrap","webpack://Tela/./node_modules/@babel/runtime/helpers/esm/classCallCheck.js","webpack://Tela/./node_modules/@babel/runtime/helpers/esm/createClass.js","webpack://Tela/./node_modules/@babel/runtime/helpers/esm/defineProperty.js","webpack://Tela/./src/Animator/main/Animator.js","webpack://Tela/./src/Canvas/main/Canvas.js","webpack://Tela/./src/Canvas_old/main/Canvas.js","webpack://Tela/./src/Canvas_old/main/Canvas2D.js","webpack://Tela/./src/Canvas_old/main/ImageIO.js","webpack://Tela/./src/Color/main/Color.js","webpack://Tela/./src/Utils/main/Utils.js","webpack://Tela/./src/index.js"],"names":["Animator","state","next","doWhile","requestAnimeId","requestAnimationFrame","stop","play","cancelAnimationFrame","AnimatorBuilder","_state","_next","_end","end","someAreEmpty","some","x","undefined","Error","Canvas","canvas","getCanvas","ctx","getContext","image","getImageData","width","height","imgBuffer","data","color","fillStyle","red","green","blue","alpha","fillRect","lambda","n","length","w","i","Math","floor","y","Color","ofRGBA","putImageData","CanvasBuilder","document","createElement","_width","_height","_canvas","setAttribute","scale","u","r","ans","add","v","diff","dot","squareNorm","norm","sqrt","min","max","solve2by2UpperTriMatrix","h","z","aux","solve2by2LowerTriMatrix","imageData","prototype","getSize","paintImage","clearImage","rgba","useCanvasCtx","size","globalCompositeOperation","isClearImage","getImageIndex","getPxl","index","drawPxl","rgb","drawLine","x1","x2","shader","points","stack","push","inStack","outStack","drawLineInt","intersectionSolutions","validIntersection","p","pop","p0","nn","tangent","normal","fmin","Number","MAX_VALUE","minDir","k","j","nextX","f","abs","drawPolygon","array","isInsidePoly","isInsidePolygon","upperBox","MIN_VALUE","clampedSize","zeros","drawTriangle","x3","isInsideConvex","drawQuad","x4","drawImage","img","isReady","drawCircle","corner","isInsideCircle","addEventListener","key","useCapture","drawString","string","contextShader","fillText","theta","acos","PI","m","vDotN","orientation","myDot","simpleShader","element","colorShader","colors","auxShader","poly","interpolateColors","interpolateTriangleShader","interpolateQuadShader","quad","t1","t2","triangleBaryCoord","triangle","interpolateLineShader","line","vnorm","projection","t","quadTextureShader","quadTexCoord","interpolation","bilinearInterpolation","imageCache","imageShader","ImageIO","getImageCanvas","imageCanvas","imgSize","interpolateTexCoord","cornerColors","finalColor","triangleCache","hashMap","constains","triangleHash","get","set","value","reduce","hash","det","map","cache","values","acc","f03","f12","createCanvas","domId","getElementById","appendChild","Canvas2D","cameraSpace","call","Object","create","constructor","integerTransform","xint","yint","inverseTransform","xt","yt","y1","y2","y3","y4","setCamera","camera","canvasAux","contextAux","getDataFromImage","loadImage","src","Image","onload","generateImageReadyPredicate","Uint8Array","random","ArrayUtils","TYPED_ARRAY","Uint8ArrayFactory","perf","performance","now","answer"],"mappings":"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","file":"index.js","sourcesContent":["(function webpackUniversalModuleDefinition(root, factory) {\n\tif(typeof exports === 'object' && typeof module === 'object')\n\t\tmodule.exports = factory();\n\telse if(typeof define === 'function' && define.amd)\n\t\tdefine([], factory);\n\telse if(typeof exports === 'object')\n\t\texports[\"Tela\"] = factory();\n\telse\n\t\troot[\"Tela\"] = factory();\n})(window, function() {\nreturn "," \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId]) {\n \t\t\treturn installedModules[moduleId].exports;\n \t\t}\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, { enumerable: true, get: getter });\n \t\t}\n \t};\n\n \t// define __esModule on exports\n \t__webpack_require__.r = function(exports) {\n \t\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n \t\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n \t\t}\n \t\tObject.defineProperty(exports, '__esModule', { value: true });\n \t};\n\n \t// create a fake namespace object\n \t// mode & 1: value is a module id, require it\n \t// mode & 2: merge all properties of value into the ns\n \t// mode & 4: return value when already ns object\n \t// mode & 8|1: behave like require\n \t__webpack_require__.t = function(value, mode) {\n \t\tif(mode & 1) value = __webpack_require__(value);\n \t\tif(mode & 8) return value;\n \t\tif((mode & 4) && typeof value === 'object' && value && value.__esModule) return value;\n \t\tvar ns = Object.create(null);\n \t\t__webpack_require__.r(ns);\n \t\tObject.defineProperty(ns, 'default', { enumerable: true, value: value });\n \t\tif(mode & 2 && typeof value != 'string') for(var key in value) __webpack_require__.d(ns, key, function(key) { return value[key]; }.bind(null, key));\n \t\treturn ns;\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(__webpack_require__.s = \"./src/index.js\");\n","export default function _classCallCheck(instance, Constructor) {\n  if (!(instance instanceof Constructor)) {\n    throw new TypeError(\"Cannot call a class as a function\");\n  }\n}","function _defineProperties(target, props) {\n  for (var i = 0; i < props.length; i++) {\n    var descriptor = props[i];\n    descriptor.enumerable = descriptor.enumerable || false;\n    descriptor.configurable = true;\n    if (\"value\" in descriptor) descriptor.writable = true;\n    Object.defineProperty(target, descriptor.key, descriptor);\n  }\n}\n\nexport default function _createClass(Constructor, protoProps, staticProps) {\n  if (protoProps) _defineProperties(Constructor.prototype, protoProps);\n  if (staticProps) _defineProperties(Constructor, staticProps);\n  return Constructor;\n}","export default function _defineProperty(obj, key, value) {\n  if (key in obj) {\n    Object.defineProperty(obj, key, {\n      value: value,\n      enumerable: true,\n      configurable: true,\n      writable: true\n    });\n  } else {\n    obj[key] = value;\n  }\n\n  return obj;\n}","export default class Animator {\n  constructor(state, next, doWhile) {\n    this.state = state;\n    this.next = next;\n    this.while = doWhile;\n    this.requestAnimeId = null;\n  }\n\n  play() {\n    this.requestAnimeId = requestAnimationFrame(() => {\n      if (!this.while(this.state)) return this.stop();\n      this.state = this.next(this.state);\n      this.play();\n    });\n    return this;\n  }\n\n  stop() {\n    cancelAnimationFrame(this.requestAnimeId);\n    return this;\n  }\n\n  static builder() {\n    return new AnimatorBuilder();\n  }\n}\n\nclass AnimatorBuilder {\n  constructor() {\n    this._state = null;\n    this._next = null;\n    this._end = null;\n  }\n\n  initialState(state) {\n    this._state = state;\n    return this;\n  }\n\n  nextState(next) {\n    this._next = next;\n    return this;\n  }\n\n  while(end) {\n    this._end = end;\n    return this;\n  }\n\n  build() {\n    const someAreEmpty = [this._state, this._next, this._end].some(\n      (x) => x === null || x === undefined\n    );\n    if (someAreEmpty) throw new Error(\"Animator properties are missing\");\n    return new Animator(this._state, this._next, this._end);\n  }\n}\n","import Color from \"../../Color/main/Color\";\n\n/*\n Canvas coordinates\n\n 0                  W-1\n +-------------> y\n |\n |\n |       *\n |\n |\n v x\n\n H-1\n */\n\n/*\n\nThe point xe_1 + ye_2 corresponds to a point in the middle of a pxl.\n\nThe canvas data is an array of length colors(C) * width(W) * height(H). Is a 3D-array.\nThe index is a number in [0, C * W * H - 1].\nHaving (x, y, z) where z is the color axis, the formula to index the array is :\n\nf(x, y, z) = C * W * x + C * y + z.\n\nWhere x in [0, H - 1], y in [0, W - 1] and z in [0, C - 1].\n\nNote that f(H - 1, W - 1, C - 1) = C * W * H - 1.\n*/\n\nexport default class Canvas {\n  /**\n   *\n   * @param {*} canvas: DOM element of type canvas\n   */\n  constructor(canvas) {\n    this.canvas = canvas;\n    this.ctx = canvas.getContext(\"2d\");\n    this.image = this.ctx.getImageData(0, 0, canvas.width, canvas.height);\n    // width * height * 4 array of integers\n    this.imgBuffer = this.image.data;\n  }\n\n  getCanvas() {\n    return this.canvas;\n  }\n\n  getDom = this.getCanvas;\n\n  //========================================================================================\n  /*                                                                                      *\n   *                                 side effects function                                *\n   *                                                                                      */\n  //========================================================================================\n\n  /**\n   * Update color of canvas\n   * @param {*} color: Color\n   */\n  fill(color) {\n    this.ctx.fillStyle = `rgba(${color.red}, ${color.green}, ${color.blue}, ${\n      color.alpha / 255.0\n    })`;\n    this.ctx.fillRect(0, 0, this.canvas.width, this.canvas.height);\n    this.image = this.ctx.getImageData(\n      0,\n      0,\n      this.canvas.width,\n      this.canvas.height\n    );\n    this.imgBuffer = this.image.data;\n  }\n\n  /**\n   *\n   * @param {*} lambda: (Color,x:number,y:number) => Color\n   */\n  map(lambda = () => {}) {\n    const n = this.imgBuffer.length;\n    const { width } = this.canvas;\n    const w = 4 * width;\n    for (let i = 0; i < n; i += 4) {\n      const x = Math.floor(i / w);\n      const y = Math.floor(i / 4) % w;\n      const color = lambda(\n        Color.ofRGBA(\n          this.imgBuffer[i],\n          this.imgBuffer[i + 1],\n          this.imgBuffer[i + 2],\n          this.imgBuffer[i + 3]\n        ),\n        x,\n        y\n      );\n      this.imgBuffer[i] = color.red;\n      this.imgBuffer[i + 1] = color.green;\n      this.imgBuffer[i + 2] = color.blue;\n      this.imgBuffer[i + 3] = color.alpha;\n    }\n    return this;\n  }\n\n  paint() {\n    this.ctx.putImageData(this.image, 0, 0);\n  }\n\n  //========================================================================================\n  /*                                                                                      *\n   *                                   static functions                                   *\n   *                                                                                      */\n  //========================================================================================\n\n  static builder() {\n    return new CanvasBuilder();\n  }\n}\n\nclass CanvasBuilder {\n  _canvas = document.createElement(\"canvas\");\n  _width = 500;\n  _height = 500;\n  constructor() {}\n\n  width(width) {\n    this._width = width;\n    return this;\n  }\n\n  height(height) {\n    this._height = height;\n    return this;\n  }\n\n  build() {\n    this._canvas.setAttribute(\"width\", this._width);\n    this._canvas.setAttribute(\"height\", this._height);\n    return new Canvas(this._canvas);\n  }\n}\n","import ImageIO from \"./ImageIO\";\n/*\n Canvas coordinates\n\n 0                  W-1\n +-------------> y\n |\n |\n |       *\n |\n |\n v x\n\n H-1\n */\n\n/*\n\nThe point xe_1 + ye_2 corresponds to a point in the middle of a pxl.\n\nThe canvas data is an array of length colors(C) * width(W) * height(H). Is a 3D-array.\nThe index is a number in [0, C * W * H - 1].\nHaving (x, y, z) where z is the color axis, the formula to index the array is :\n\nf(x, y, z) = C * W * x + C * y + z.\n\nWhere x in [0, H - 1], y in [0, W - 1] and z in [0, C - 1].\n\nNote that f(H - 1, W - 1, C - 1) = C * W * H - 1.\n*/\n\n// Auxiliary functions\nfunction scale(u, r) {\n  var ans = [];\n  ans[0] = u[0] * r;\n  ans[1] = u[1] * r;\n  return ans;\n}\n\nfunction add(u, v) {\n  var ans = [];\n  ans[0] = u[0] + v[0];\n  ans[1] = u[1] + v[1];\n  return ans;\n}\n\nfunction floor(x) {\n  var ans = [];\n  ans[0] = Math.floor(x[0]);\n  ans[1] = Math.floor(x[1]);\n  return ans;\n}\n\nfunction diff(u, v) {\n  var ans = [];\n  ans[0] = u[0] - v[0];\n  ans[1] = u[1] - v[1];\n  return ans;\n}\n\nfunction dot(u, v) {\n  return u[0] * v[0] + u[1] * v[1];\n}\n\nfunction squareNorm(x) {\n  return dot(x, x);\n}\n\nfunction norm(x) {\n  return Math.sqrt(dot(x, x));\n}\n\nfunction min(u, v) {\n  var ans = [];\n  ans[0] = Math.min(u[0], v[0]);\n  ans[1] = Math.min(u[1], v[1]);\n  return ans;\n}\n\nfunction max(u, v) {\n  var ans = [];\n  ans[0] = Math.max(u[0], v[0]);\n  ans[1] = Math.max(u[1], v[1]);\n  return ans;\n}\n\n/**\n * return solution to : [ u_0 , h] x = z_0\n *\n *                       [ u_1,  0] y = z_1\n */\nfunction solve2by2UpperTriMatrix(u, h, z) {\n  var aux = z[1] / u[1];\n  return [aux, (-u[0] * aux + z[0]) / h];\n}\n/**\n * return solution to : [ u_0 , 0] x = z_0\n *\n *                       [ u_1,  w] y = z_1\n */\nfunction solve2by2LowerTriMatrix(u, w, z) {\n  var aux = z[0] / u[0];\n  return [aux, (-u[1] * aux + z[1]) / w];\n}\n\n// Canvas\nvar Canvas = function (canvas) {\n  this.canvas = canvas;\n  this.ctx = canvas.getContext(\"2d\");\n  this.image = this.ctx.getImageData(0, 0, canvas.width, canvas.height);\n  // width * height * 4 array of integers\n  this.imageData = this.image.data;\n};\n\n/**\n * Returns a two vector with Height as first coordinate and Width as second. [Height, Width].\n */\nCanvas.prototype.getSize = function () {\n  return [this.canvas.height, this.canvas.width];\n};\n\n/**\n *  Draw update image on canvas.\n */\nCanvas.prototype.paintImage = function () {\n  this.ctx.putImageData(this.image, 0, 0);\n};\n\nCanvas.prototype.getCanvas = function () {\n  return this.canvas;\n};\n\n/**\n * Clear Image with @rgba color.\n *\n * @param rgba\n */\nCanvas.prototype.clearImage = function (rgba) {\n  this.useCanvasCtx((canvas) => {\n    var size = canvas.getSize();\n    canvas.ctx.fillStyle =\n      \"rgba(\" + rgba[0] + \",\" + rgba[1] + \",\" + rgba[2] + \",\" + rgba[3] + \")\";\n    canvas.ctx.globalCompositeOperation = \"source-over\";\n    canvas.ctx.fillRect(0, 0, size[1], size[0]);\n  }, true);\n};\n\nCanvas.prototype.useCanvasCtx = function (lambda, isClearImage = false) {\n  if (!isClearImage) {\n    this.ctx.putImageData(this.image, 0, 0);\n  }\n  lambda(this);\n  this.image = this.ctx.getImageData(\n    0,\n    0,\n    this.canvas.width,\n    this.canvas.height\n  );\n  this.imageData = this.image.data;\n};\n\nCanvas.prototype.getImageIndex = function (x) {\n  return 4 * (this.canvas.width * x[0] + x[1]);\n};\n\nCanvas.prototype.getPxl = function (x) {\n  var index = this.getImageIndex(x);\n  return [\n    this.imageData[index],\n    this.imageData[index + 1],\n    this.imageData[index + 2],\n    this.imageData[index + 3],\n  ];\n};\n\nCanvas.prototype.drawPxl = function (x, rgb) {\n  var index = this.getImageIndex(x);\n  this.imageData[index] = rgb[0];\n  this.imageData[index + 1] = rgb[1];\n  this.imageData[index + 2] = rgb[2];\n  this.imageData[index + 3] = rgb[3];\n};\n\n/*\n * x1     :   2-dim array\n * x2     :   2-dim array\n * shader :   is a function that receives a 2-dim array and a line (array with 2 points) and returns a rgba 4-dim array\n */\nCanvas.prototype.drawLine = function (x1, x2, shader) {\n  // add points before clip\n  shader.points = [x1, x2];\n\n  // do clipping\n  var stack = [];\n  stack.push(x1);\n  stack.push(x2);\n  var inStack = [];\n  var outStack = [];\n  for (var i = 0; i < stack.length; i++) {\n    var x = stack[i];\n    if (\n      0 <= x[0] &&\n      x[0] < this.canvas.height &&\n      0 <= x[1] &&\n      x[1] < this.canvas.width\n    ) {\n      inStack.push(x);\n    } else {\n      outStack.push(x);\n    }\n  }\n  // both points are inside canvas\n  if (inStack.length == 2) {\n    this.drawLineInt(inStack[0], inStack[1], shader);\n    return;\n  }\n  //intersecting line with canvas\n  var intersectionSolutions = [];\n  var v = [x2[0] - x1[0], x2[1] - x1[1]];\n  // Let s \\in [0,1]\n  // line intersection with [0, 0]^T + [H - 1, 0]^T s\n  intersectionSolutions.push(\n    solve2by2UpperTriMatrix(v, -(this.canvas.height - 1), [-x1[0], -x1[1]])\n  );\n  // line intersection with [H - 1, 0]^T + [0, W - 1]^T s\n  intersectionSolutions.push(\n    solve2by2LowerTriMatrix(v, -(this.canvas.width - 1), [\n      this.canvas.height - 1 - x1[0],\n      -x1[1],\n    ])\n  );\n  // line intersection with [H - 1, W - 1]^T + [-(H - 1), 0]^T s\n  intersectionSolutions.push(\n    solve2by2UpperTriMatrix(v, this.canvas.height - 1, [\n      this.canvas.height - 1 - x1[0],\n      this.canvas.width - 1 - x1[1],\n    ])\n  );\n  // line intersection with [0, W - 1]^T + [0, -(W - 1)]^T s\n  intersectionSolutions.push(\n    solve2by2LowerTriMatrix(v, this.canvas.width - 1, [\n      -x1[0],\n      this.canvas.width - 1 - x1[1],\n    ])\n  );\n\n  var validIntersection = [];\n  for (var i = 0; i < intersectionSolutions.length; i++) {\n    var x = intersectionSolutions[i];\n    if (0 <= x[0] && x[0] <= 1 && 0 <= x[1] && x[1] <= 1) {\n      validIntersection.push(x);\n    }\n  }\n\n  if (validIntersection.length == 0) return;\n\n  //it can be shown that at this point there is at least one valid intersection.\n  if (inStack.length > 0) {\n    var p = [\n      x1[0] + validIntersection[0][0] * v[0],\n      x1[1] + validIntersection[0][0] * v[1],\n    ];\n    this.drawLineInt(inStack.pop(), p, shader);\n    return;\n  }\n\n  var p0 = [\n    x1[0] + validIntersection[0][0] * v[0],\n    x1[1] + validIntersection[0][0] * v[1],\n  ];\n  for (var i = 1; i < validIntersection.length; i++) {\n    var p = [\n      x1[0] + validIntersection[i][0] * v[0],\n      x1[1] + validIntersection[i][0] * v[1],\n    ];\n    var v = diff(p, p0);\n    if (dot(v, v) > 1e-3) {\n      this.drawLineInt(p0, p, shader);\n      return;\n    }\n  }\n  this.drawLineInt(p0, p0, shader);\n};\n\nCanvas.prototype.drawLineInt = function (x1, x2, shader) {\n  x1 = floor(x1);\n  x2 = floor(x2);\n\n  var index = [-1, 0, 1];\n\n  var n = index.length;\n  var nn = n * n;\n\n  var x = [];\n  x[0] = x1[0];\n  x[1] = x1[1];\n\n  var tangent = diff(x2, x1);\n  var normal = [];\n  normal[0] = -tangent[1];\n  normal[1] = tangent[0];\n\n  shader(x, shader.points, this);\n\n  while (x[0] !== x2[0] || x[1] !== x2[1]) {\n    var fmin = Number.MAX_VALUE;\n    var minDir = [];\n    for (var k = 0; k < nn; k++) {\n      var i = index[k % n];\n      var j = index[Math.floor(k / n)];\n\n      var nextX = add(x, [i, j]);\n\n      var v = diff(nextX, x1);\n      var f = Math.abs(dot(v, normal)) - dot(v, tangent);\n      if (fmin > f) {\n        fmin = f;\n        minDir = [i, j];\n      }\n    }\n\n    x = add(x, minDir);\n    shader(x, shader.points, this);\n  }\n  shader(x, shader.points, this);\n};\n\nCanvas.prototype.drawPolygon = function (\n  array,\n  shader,\n  isInsidePoly = Canvas.isInsidePolygon\n) {\n  let upperBox = [\n    [Number.MAX_VALUE, Number.MAX_VALUE],\n    [Number.MIN_VALUE, Number.MIN_VALUE],\n  ];\n  for (let i = 0; i < array.length; i++) {\n    upperBox[0] = min(array[i], upperBox[0]);\n    upperBox[1] = max(array[i], upperBox[1]);\n  }\n\n  let size = this.getSize();\n  let clampedSize = diff(size, [1, 1]);\n  let zeros = [0, 0];\n  upperBox[0] = floor(min(clampedSize, max(zeros, upperBox[0])));\n  upperBox[1] = floor(min(clampedSize, max(zeros, upperBox[1])));\n\n  for (var i = upperBox[0][0]; i < upperBox[1][0]; i++) {\n    for (var j = upperBox[0][1]; j < upperBox[1][1]; j++) {\n      var x = [i, j];\n      if (isInsidePoly(x, array)) {\n        shader(x, array, this);\n      }\n    }\n  }\n};\n\n/*\n * x1     :   2-dim array\n * x2     :   2-dim array\n * x3     :   2-dim array\n * shader :   is a function that receives a 2-dim array and a triangle (array with 3 points) and returns a rgba 4-dim array\n */\nCanvas.prototype.drawTriangle = function (x1, x2, x3, shader) {\n  var array = [x1, x2, x3];\n  this.drawPolygon(array, shader, Canvas.isInsideConvex);\n};\n\n/* x1     :   2-dim array\n * x2     :   2-dim array\n * x3     :   2-dim array\n * x4     :   2-dim array\n * shader :   is a function that receives a 2-dim array and returns a rgba 4-dim array\n */\nCanvas.prototype.drawQuad = function (x1, x2, x3, x4, shader) {\n  this.drawPolygon([x1, x2, x3, x4], shader);\n};\n\nCanvas.prototype.drawImage = function (img, x) {\n  if (\"isReady\" in img && !img.isReady) return;\n  this.useCanvasCtx((canvas) => canvas.ctx.drawImage(img, x[1], x[0]));\n};\n\nCanvas.prototype.drawCircle = function (x, r, shader) {\n  var corner = scale([1, 1], r);\n  var upperBox = [diff(x, corner), add(x, corner)];\n  var size = this.getSize();\n  upperBox[0] = floor(min(diff(size, [1, 1]), max([0, 0], upperBox[0])));\n  upperBox[1] = floor(min(diff(size, [1, 1]), max([0, 0], upperBox[1])));\n  for (var i = upperBox[0][0]; i <= upperBox[1][0]; i++) {\n    for (var j = upperBox[0][1]; j <= upperBox[1][1]; j++) {\n      var p = [i, j];\n      if (this.isInsideCircle(p, x, r)) {\n        shader(p, [x, r], this);\n      }\n    }\n  }\n};\n\nCanvas.prototype.isInsideCircle = function (p, x, r) {\n  return squareNorm(diff(p, x)) <= r * r;\n};\n\nCanvas.prototype.addEventListener = function (key, lambda, useCapture) {\n  this.canvas.addEventListener(key, lambda, useCapture);\n};\n\nCanvas.prototype.drawString = function (x, string, contextShader) {\n  this.useCanvasCtx((canvas) => {\n    contextShader(canvas.ctx);\n    canvas.ctx.fillText(string, x[1], x[0]);\n  });\n};\n\n// Static functions\n\n// slower than isInsideConvex method\nCanvas.isInsidePolygon = function (x, array) {\n  var v = [];\n  var theta = 0;\n  var n = array.length;\n  for (var i = 0; i < n; i++) {\n    v[0] = diff(array[(i + 1) % n], x);\n    v[1] = diff(array[i], x);\n    theta += Math.acos(dot(v[0], v[1]) / (norm(v[0]) * norm(v[1])));\n  }\n  return Math.abs(theta - 2 * Math.PI) < 1e-3;\n};\n\nCanvas.isInsideConvex = function (x, array) {\n  var m = array.length;\n  var v = [];\n  var vDotN = [];\n  for (var i = 0; i < m; i++) {\n    v[i] = diff(array[(i + 1) % m], array[i]);\n    let n = [-v[i][1], v[i][0]];\n    let r = diff(x, array[i]);\n    vDotN[i] = dot(r, n);\n  }\n  let orientation = v[0][0] * v[1][1] - v[0][1] * v[1][0] > 0 ? 1 : -1;\n  for (var i = 0; i < m; i++) {\n    var myDot = vDotN[i] * orientation;\n    if (myDot < 0) return false;\n  }\n  return true;\n};\n\nCanvas.simpleShader = function (color) {\n  return (x, element, canvas) => canvas.drawPxl(x, color);\n};\n\nCanvas.colorShader = function (colors) {\n  var auxShader = (x, poly, canvas, alpha) => {\n    var interpolateColors = [0, 0, 0, 0];\n    for (var i = 0; i < poly.length; i++) {\n      interpolateColors[0] = interpolateColors[0] + colors[i][0] * alpha[i];\n      interpolateColors[1] = interpolateColors[1] + colors[i][1] * alpha[i];\n      interpolateColors[2] = interpolateColors[2] + colors[i][2] * alpha[i];\n      interpolateColors[3] = interpolateColors[3] + colors[i][3] * alpha[i];\n    }\n    canvas.drawPxl(x, interpolateColors);\n  };\n  return Canvas.interpolateTriangleShader(auxShader);\n};\n\nCanvas.interpolateQuadShader = function (shader) {\n  return function (x, quad, canvas) {\n    var t1 = [quad[0], quad[1], quad[2]];\n    var t2 = [quad[2], quad[3], quad[0]];\n    var alpha = Canvas.triangleBaryCoord(x, t1);\n    if (\n      alpha[0] > 0 &&\n      alpha[1] > 0 &&\n      alpha[2] > 0 &&\n      Math.abs(alpha[0] + alpha[1] + alpha[2] - 1) < 1e-10\n    ) {\n      shader(x, quad, canvas, [alpha[0], alpha[1], alpha[2], 0]);\n    } else {\n      alpha = Canvas.triangleBaryCoord(x, t2);\n      shader(x, quad, canvas, [alpha[2], 0, alpha[0], alpha[1]]);\n    }\n  };\n};\n\nCanvas.interpolateTriangleShader = function (shader) {\n  return (x, triangle, canvas) => {\n    const alpha = Canvas.triangleBaryCoord(x, triangle);\n    shader(x, triangle, canvas, alpha);\n  };\n};\n\nCanvas.interpolateLineShader = function (shader) {\n  return (x, line, canvas) => {\n    var v = diff(line[1], line[0]);\n    var z = diff(x, line[0]);\n    var vnorm = squareNorm(v);\n    var projection = dot(z, v);\n    var t = vnorm == 0.0 ? 0 : projection / vnorm;\n    shader(x, line, canvas, t);\n  };\n};\n\n/**\n * img: html loaded image.\n * quadTexCoord: [0, 1]^{2 * 4}, texture coordinates\n */\nCanvas.quadTextureShader = function (\n  img,\n  quadTexCoord,\n  interpolation = Canvas.bilinearInterpolation\n) {\n  let imageCache = null;\n  const imageShader = (x, quad, canvas, alpha) => {\n    if (!img.isReady || imageCache == null)\n      imageCache = new Canvas(ImageIO.getImageCanvas(img));\n    const imageCanvas = imageCache;\n    const imgSize = imageCanvas.getSize();\n    const interpolateTexCoord = [0, 0];\n    for (let i = 0; i < quadTexCoord.length; i++) {\n      interpolateTexCoord[0] =\n        interpolateTexCoord[0] + quadTexCoord[i][0] * alpha[i];\n      interpolateTexCoord[1] =\n        interpolateTexCoord[1] + quadTexCoord[i][1] * alpha[i];\n    }\n    var i = [\n      (1 - interpolateTexCoord[1]) * (imgSize[1] - 1),\n      (imgSize[0] - 1) * interpolateTexCoord[0],\n    ];\n    // bound coordinates\n    i = max([0, 0], min(diff([imgSize[0], imgSize[1]], [1, 1]), i));\n    // pxl lower corner\n    var j = floor(i);\n    var cornerColors = [\n      imageCanvas.getPxl(j),\n      imageCanvas.getPxl(add(j, [1, 0])),\n      imageCanvas.getPxl(add(j, [1, 1])),\n      imageCanvas.getPxl(add(j, [0, 1])),\n    ];\n    var finalColor = interpolation(cornerColors, diff(i, j));\n    canvas.drawPxl(x, finalColor);\n  };\n  return Canvas.interpolateQuadShader(imageShader);\n};\n\nCanvas.triangleCache = (() => {\n  const hashMap = [];\n  const size = 3;\n  return {\n    constains: (triangleHash) => hashMap[triangleHash % size] != undefined,\n    get: (triangleHash) => hashMap[triangleHash % size],\n    set: (triangleHash, value) => (hashMap[triangleHash % size] = value),\n  };\n})(); //{triangle: null, u: [], v:[], det:null, hash:null}\n\nCanvas.triangleHash = (triangle) => {\n  const array = [\n    triangle[0][0],\n    triangle[1][0],\n    triangle[2][0],\n    triangle[0][1],\n    triangle[1][1],\n    triangle[2][1],\n  ];\n  return array.reduce((h, x) => 31 * h + x, 1);\n};\n\nCanvas.triangleBaryCoord = function (x, triangle) {\n  const hash = Canvas.triangleHash(triangle);\n  const y = [x[0] - triangle[0][0], x[1] - triangle[0][1]];\n  if (!Canvas.triangleCache.constains(hash)) {\n    const u = [\n      triangle[1][0] - triangle[0][0],\n      triangle[1][1] - triangle[0][1],\n    ];\n    const v = [\n      triangle[2][0] - triangle[0][0],\n      triangle[2][1] - triangle[0][1],\n    ];\n    const det = u[0] * v[1] - u[1] * v[0];\n    Canvas.triangleCache.set(hash, {\n      triangle: triangle,\n      u: u.map((x) => x / det),\n      v: v.map((x) => x / det),\n      det: det,\n      hash: hash,\n    });\n  }\n  const cache = Canvas.triangleCache.get(hash);\n  const u = cache.u;\n  const v = cache.v;\n  const det = cache.det;\n  if (det == 0) return [0, 0, 0];\n  var alpha = [v[1] * y[0] - v[0] * y[1], u[0] * y[1] - u[1] * y[0]];\n  return [1 - alpha[0] - alpha[1], alpha[0], alpha[1]];\n};\n\n/**\n * values \\in R^{k * 4}\n * x \\in [0,1]^2\n */\nCanvas.bilinearInterpolation = function (values, x) {\n  var acc = [];\n  for (var k = 0; k < values.length; k++) {\n    var f03 = values[0][k] + (values[3][k] - values[0][k]) * x[1];\n    var f12 = values[1][k] + (values[2][k] - values[1][k]) * x[1];\n    var f = f03 + (f12 - f03) * x[0];\n    acc.push(f);\n  }\n  return acc;\n};\n/**\n * size: is an array with width and height of a HTML5 Canvas.\n * domId: DOM element where the canvas will be added\n *\n * returns Canvas object from the generated html canvas.\n */\nCanvas.createCanvas = function (size, domId) {\n  const canvas = document.createElement(\"canvas\");\n  canvas.setAttribute(\"width\", size[0]);\n  canvas.setAttribute(\"height\", size[1]);\n  document.getElementById(domId).appendChild(canvas);\n  return canvas;\n};\n\nexport default Canvas;\n","import Canvas from \"./Canvas\";\n\n//Note that we can switch from heritage to composition, think about that\n\n// cameraSpace : 2-dim array with two 2-dim arrays that are intervals [a,b] | a < b\nvar Canvas2D = function (canvas, cameraSpace) {\n  Canvas.call(this, canvas);\n  if (\n    cameraSpace.length != 2 ||\n    (cameraSpace[0].length != 2 && cameraSpace[1].length != 2)\n  ) {\n    throw \"camera space must be 2-dim array with 2-dim arrays representing an interval\";\n  }\n  this.cameraSpace = cameraSpace;\n};\n\nCanvas2D.prototype = Object.create(Canvas.prototype);\nCanvas2D.prototype.constructor = Canvas2D;\n\n/* x : 2-dim array in camera space coordinates\n * returns : 2-dim array in integer coordinates\n */\nCanvas2D.prototype.integerTransform = function (x) {\n  var xint =\n    (-(this.canvas.height - 1) /\n      (this.cameraSpace[1][1] - this.cameraSpace[1][0])) *\n    (x[1] - this.cameraSpace[1][1]);\n  var yint =\n    ((this.canvas.width - 1) /\n      (this.cameraSpace[0][1] - this.cameraSpace[0][0])) *\n    (x[0] - this.cameraSpace[0][0]);\n  return [xint, yint];\n};\n\n/* x : 2-dim array in integer coordinates\n * returns : 2-dim array in camera space coordinates\n */\nCanvas2D.prototype.inverseTransform = function (x) {\n  var xt =\n    this.cameraSpace[0][0] +\n    ((this.cameraSpace[0][1] - this.cameraSpace[0][0]) /\n      (this.canvas.width - 1)) *\n      x[1];\n  var yt =\n    this.cameraSpace[1][1] -\n    ((this.cameraSpace[1][1] - this.cameraSpace[1][0]) /\n      (this.canvas.height - 1)) *\n      x[0];\n  return [xt, yt];\n};\n\n/* x1     :   2-dim array\n * x2     :   2-dim array\n * shader :   is a function that receives a 2-dim array and returns a rgba 4-dim array\n */\nCanvas2D.prototype.drawLine = function (x1, x2, shader) {\n  const y1 = this.integerTransform(x1);\n  const y2 = this.integerTransform(x2);\n  Canvas.prototype.drawLine.call(this, y1, y2, shader);\n};\n\n/* x1     :   2-dim array\n * x2     :   2-dim array\n * x3     :   2-dim array\n * shader :   is a function that receives a 2-dim array and returns a rgba 4-dim array\n */\nCanvas2D.prototype.drawTriangle = function (x1, x2, x3, shader) {\n  const y1 = this.integerTransform(x1);\n  const y2 = this.integerTransform(x2);\n  const y3 = this.integerTransform(x3);\n  Canvas.prototype.drawTriangle.call(this, y1, y2, y3, shader);\n};\n\n/* x1     :   2-dim array\n * x2     :   2-dim array\n * x3     :   2-dim array\n * x4     :   2-dim array\n * shader :   is a function that receives a 2-dim array and returns a rgba 4-dim array\n */\nCanvas2D.prototype.drawQuad = function (x1, x2, x3, x4, shader) {\n  const y1 = this.integerTransform(x1);\n  const y2 = this.integerTransform(x2);\n  const y3 = this.integerTransform(x3);\n  const y4 = this.integerTransform(x4);\n  Canvas.prototype.drawQuad.call(this, y1, y2, y3, y4, shader);\n};\n\nCanvas2D.prototype.drawCircle = function (x, r, shader) {\n  // it assumes squared canvas, for now ...\n  const y = this.integerTransform(x);\n  const z = this.integerTransform([r, 0])[1] - this.integerTransform([0, 0])[1];\n  Canvas.prototype.drawCircle.call(this, y, z, shader);\n};\n\nCanvas2D.prototype.drawImage = function (img, x) {\n  Canvas.prototype.drawImage.call(this, img, this.integerTransform(x));\n};\n\nCanvas2D.prototype.drawString = function (x, string, contextShader) {\n  const y = this.integerTransform(x);\n  Canvas.prototype.drawString.call(this, y, string, contextShader);\n};\n\n// camera : 2-dim array with two 2-dim arrays that are intervals [a,b] | a < b\nCanvas2D.prototype.setCamera = function (camera) {\n  if (camera.length != 2 || (camera[0].length != 2 && camera[1].length != 2)) {\n    throw \"camera space must be 2-dim array with 2-dim arrays representing an interval\";\n  }\n  this.cameraSpace = camera;\n};\n\nexport default Canvas2D;\n","const ImageIO = {\n  // empty object\n};\n\n/**\n * img : html image\n */\nImageIO.getImageCanvas = img => {\n  const canvasAux = document.createElement(\"canvas\");\n  canvasAux.width = img.width;\n  canvasAux.height = img.height;\n  const contextAux = canvasAux.getContext(\"2d\");\n  contextAux.fillStyle = \"rgba(0, 0, 0, 0)\";\n  contextAux.globalCompositeOperation = \"source-over\";\n  contextAux.fillRect(0, 0, canvasAux.width, canvasAux.height);\n  contextAux.drawImage(img, 0, 0);\n  return canvasAux;\n};\n\n/**\n * img : html image\n */\nImageIO.getDataFromImage = img => {\n  canvas = ImageIO.getImageCanvas(img);\n  return canvas.getContext(\"2d\").getImageData(0, 0, img.width, img.height);\n};\n\nImageIO.loadImage = src => {\n  const img = new Image();\n  img.src = src;\n  img.isReady = false;\n  img.onload = () => (img.isReady = true);\n  return img;\n};\n\nImageIO.generateImageReadyPredicate = img => () => img.isReady;\n\nexport default ImageIO;\n","export default class Color {\n  /**\n   *\n   * @param {*} rgba: Uint8Array\n   */\n  constructor(rgba) {\n    this.rgba = rgba;\n  }\n\n  getRGBA() {\n    return this.rgba;\n  }\n\n  static ofRGBA(red = 0, green = 0, blue = 0, alpha = 255) {\n    const rgba = new Uint8Array(4);\n    rgba[0] = red;\n    rgba[1] = green;\n    rgba[2] = blue;\n    rgba[3] = alpha;\n    return new Color(rgba);\n  }\n\n  static random() {\n    const r = () => Math.random() * 256;\n    return Color.ofRGBA(r(), r(), r(), r());\n  }\n\n  get red() {\n    return this.rgba[0];\n  }\n\n  get green() {\n    return this.rgba[1];\n  }\n\n  get blue() {\n    return this.rgba[2];\n  }\n\n  get alpha() {\n    return this.rgba[3];\n  }\n}\n","const ArrayUtils = {};\n\nArrayUtils.TYPED_ARRAY = {\n  Uint8Array: (...array) => Uint8ArrayFactory(array),\n};\n\nexport { ArrayUtils };\n\nexport const perf = (lambda) => {\n  const t = performance.now();\n  lambda();\n  return performance.now() - t;\n};\n\nfunction Uint8ArrayFactory(array) {\n  const answer = new Uint8Array(array.length);\n  for (let i = 0; i < answer.length; i++) {\n    answer[i] = array[i];\n  }\n  return answer;\n}\n","import Canvas_old from \"./Canvas_old/main/Canvas\";\nimport Canvas2D_old from \"./Canvas_old/main/Canvas2D\";\nimport ImageIO from \"./Canvas_old/main/ImageIO\";\nimport Canvas from \"./Canvas/main/Canvas\";\nimport Color from \"./Color/main/Color\";\nimport * as Utils from \"./Utils/main/Utils\";\nimport Animator from \"./Animator/main/Animator\";\nexport { Canvas_old, Canvas2D_old, ImageIO, Canvas, Color, Utils, Animator };\n"],"sourceRoot":""}