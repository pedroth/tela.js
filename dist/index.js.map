{"version":3,"sources":["webpack://Tela/webpack/universalModuleDefinition","webpack://Tela/webpack/bootstrap","webpack://Tela/./node_modules/@babel/runtime/helpers/typeof.js","webpack://Tela/./src/Canvas_old/main/ImageIO.js","webpack://Tela/./src/Canvas_old/main/Canvas.js","webpack://Tela/./src/Canvas_old/main/Canvas2D.js","webpack://Tela/./node_modules/@babel/runtime/helpers/esm/arrayLikeToArray.js","webpack://Tela/./node_modules/@babel/runtime/helpers/esm/unsupportedIterableToArray.js","webpack://Tela/./node_modules/@babel/runtime/helpers/esm/toConsumableArray.js","webpack://Tela/./node_modules/@babel/runtime/helpers/esm/arrayWithoutHoles.js","webpack://Tela/./node_modules/@babel/runtime/helpers/esm/iterableToArray.js","webpack://Tela/./node_modules/@babel/runtime/helpers/esm/nonIterableSpread.js","webpack://Tela/./node_modules/@babel/runtime/helpers/esm/slicedToArray.js","webpack://Tela/./node_modules/@babel/runtime/helpers/esm/arrayWithHoles.js","webpack://Tela/./node_modules/@babel/runtime/helpers/esm/iterableToArrayLimit.js","webpack://Tela/./node_modules/@babel/runtime/helpers/esm/nonIterableRest.js","webpack://Tela/./node_modules/@babel/runtime/helpers/esm/classCallCheck.js","webpack://Tela/./node_modules/@babel/runtime/helpers/esm/createClass.js","webpack://Tela/./node_modules/@babel/runtime/helpers/esm/defineProperty.js","webpack://Tela/./src/Color/main/Color.js","webpack://Tela/./node_modules/@babel/runtime/helpers/esm/setPrototypeOf.js","webpack://Tela/./node_modules/@babel/runtime/helpers/esm/inherits.js","webpack://Tela/./node_modules/@babel/runtime/helpers/esm/assertThisInitialized.js","webpack://Tela/./node_modules/@babel/runtime/helpers/esm/possibleConstructorReturn.js","webpack://Tela/./node_modules/@babel/runtime/helpers/esm/getPrototypeOf.js","webpack://Tela/./node_modules/@babel/runtime/helpers/esm/isNativeReflectConstruct.js","webpack://Tela/./node_modules/@babel/runtime/helpers/esm/construct.js","webpack://Tela/./node_modules/@babel/runtime/helpers/esm/wrapNativeSuper.js","webpack://Tela/./node_modules/@babel/runtime/helpers/esm/isNativeFunction.js","webpack://Tela/./src/Matrix/main/Matrix.js","webpack://Tela/./src/BBox/main/BBox.js","webpack://Tela/./src/Canvas/main/Canvas.js","webpack://Tela/./src/Utils/main/Utils.js","webpack://Tela/./src/Animator/main/Animator.js","webpack://Tela/./node_modules/@babel/runtime/helpers/esm/get.js","webpack://Tela/./node_modules/@babel/runtime/helpers/esm/superPropBase.js","webpack://Tela/./src/Canvas2d/main/Canvas2d.js"],"names":["root","factory","exports","module","define","amd","window","installedModules","__webpack_require__","moduleId","i","l","modules","call","m","c","d","name","getter","o","Object","defineProperty","enumerable","get","r","Symbol","toStringTag","value","t","mode","__esModule","ns","create","key","bind","n","object","property","prototype","hasOwnProperty","p","s","_typeof","obj","iterator","constructor","ImageIO","img","canvasAux","document","createElement","width","height","contextAux","getContext","fillStyle","globalCompositeOperation","fillRect","drawImage","canvas","getImageCanvas","getImageData","src","Image","isReady","onload","add","u","v","ans","floor","x","Math","diff","dot","squareNorm","norm","sqrt","min","max","solve2by2UpperTriMatrix","h","z","aux","solve2by2LowerTriMatrix","w","hashMap","Canvas","this","ctx","image","imageData","data","getSize","paintImage","putImageData","getCanvas","clearImage","rgba","useCanvasCtx","size","lambda","isClearImage","getImageIndex","getPxl","index","drawPxl","rgb","drawLine","x1","x2","shader","points","stack","push","inStack","outStack","length","intersectionSolutions","validIntersection","drawLineInt","pop","p0","nn","tangent","normal","fmin","Number","MAX_VALUE","minDir","k","j","f","abs","drawPolygon","array","isInsidePoly","isInsidePolygon","upperBox","MIN_VALUE","clampedSize","zeros","drawTriangle","x3","isInsideConvex","drawQuad","x4","drawCircle","corner","scale","isInsideCircle","addEventListener","useCapture","drawString","string","contextShader","fillText","theta","acos","PI","vDotN","orientation","simpleShader","color","element","colorShader","colors","interpolateTriangleShader","poly","alpha","interpolateColors","interpolateQuadShader","quad","t1","t2","triangleBaryCoord","triangle","interpolateLineShader","line","vnorm","projection","quadTextureShader","quadTexCoord","interpolation","bilinearInterpolation","imageCache","imageShader","imageCanvas","imgSize","interpolateTexCoord","cornerColors","finalColor","triangleCache","constains","triangleHash","undefined","set","reduce","hash","y","det","map","cache","values","acc","f03","createCanvas","domId","setAttribute","getElementById","appendChild","Canvas2D","cameraSpace","integerTransform","inverseTransform","y1","y2","y3","y4","setCamera","camera","_arrayLikeToArray","arr","len","arr2","Array","_unsupportedIterableToArray","minLen","toString","slice","from","test","_toConsumableArray","isArray","iter","TypeError","_slicedToArray","_i","_s","_e","_arr","_n","_d","next","done","err","_classCallCheck","instance","Constructor","_defineProperties","target","props","descriptor","configurable","writable","_createClass","protoProps","staticProps","_defineProperty","Color","red","green","blue","Uint8Array","random","ofRGBA","_setPrototypeOf","setPrototypeOf","__proto__","_inherits","subClass","superClass","_assertThisInitialized","self","ReferenceError","_possibleConstructorReturn","_getPrototypeOf","getPrototypeOf","_isNativeReflectConstruct","Reflect","construct","sham","Proxy","Boolean","valueOf","e","Parent","args","Class","a","apply","Function","arguments","_cache","Map","fn","indexOf","has","Wrapper","getIndexFromCoord","_","getCoordFromIndex","MatrixBuilder","_size","MatrixError","index2Key","Float64Array","indexer","keys","forEach","split","Matrix","RowBuilder","rows","dim","_buildWithRows","cols","indexF","ColBuilder","shape","matrix","prod","getCoord","identity","binaryLambda","mRows","mCols","op","b","real","precision","sub","error","builder","build","addCol","addRow","en","matrixBuilder","colBuilder","of","vec","e0","e1","ZERO","e2","Error","BBox","isEmpty","center","diagonal","box","EMPTY","newMin","newMax","every","vector","actionByTypes","type","action","equals","point","vec2","imgBuffer","start","end","_clipLine","toArray","p1","p2","_drawConvexPolygon","arrayOfPoints","canvasBox","boundingBox","ofPoint","finalBox","inter","xMin","yMin","xMax","yMax","_isInsideConvex","vi","bbox","pointStack","collidesWith","inPoint","outPoint","_getLineCanvasIntersection","boundary","solution","_solveLowTriMatrix","_solveUpTriMatrix","validIntersections","v1","v2","av1","f1","f2","av2","CanvasBuilder","_width","_height","_canvas","perf","performance","now","testBuilder","canvasBuilder","canvasFactory","title","timeInMillis","domTest","testTitle","innerText","getDom","timeDom","body","Animator","state","doWhile","requestAnimeId","requestAnimationFrame","stop","play","cancelAnimationFrame","AnimatorBuilder","_state","_next","_end","some","receiver","base","desc","getOwnPropertyDescriptor","Canvas2d","forwardCoord","inverseCoord","startPos","endPos","q0","q1","q2","minX","minY","maxX","maxY","Canvas2dBuilder","_camera","canvasBase"],"mappings":"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","file":"index.js","sourcesContent":["(function webpackUniversalModuleDefinition(root, factory) {\n\tif(typeof exports === 'object' && typeof module === 'object')\n\t\tmodule.exports = factory();\n\telse if(typeof define === 'function' && define.amd)\n\t\tdefine([], factory);\n\telse if(typeof exports === 'object')\n\t\texports[\"Tela\"] = factory();\n\telse\n\t\troot[\"Tela\"] = factory();\n})(window, function() {\nreturn "," \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId]) {\n \t\t\treturn installedModules[moduleId].exports;\n \t\t}\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, { enumerable: true, get: getter });\n \t\t}\n \t};\n\n \t// define __esModule on exports\n \t__webpack_require__.r = function(exports) {\n \t\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n \t\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n \t\t}\n \t\tObject.defineProperty(exports, '__esModule', { value: true });\n \t};\n\n \t// create a fake namespace object\n \t// mode & 1: value is a module id, require it\n \t// mode & 2: merge all properties of value into the ns\n \t// mode & 4: return value when already ns object\n \t// mode & 8|1: behave like require\n \t__webpack_require__.t = function(value, mode) {\n \t\tif(mode & 1) value = __webpack_require__(value);\n \t\tif(mode & 8) return value;\n \t\tif((mode & 4) && typeof value === 'object' && value && value.__esModule) return value;\n \t\tvar ns = Object.create(null);\n \t\t__webpack_require__.r(ns);\n \t\tObject.defineProperty(ns, 'default', { enumerable: true, value: value });\n \t\tif(mode & 2 && typeof value != 'string') for(var key in value) __webpack_require__.d(ns, key, function(key) { return value[key]; }.bind(null, key));\n \t\treturn ns;\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(__webpack_require__.s = 1);\n","function _typeof(obj) {\n  \"@babel/helpers - typeof\";\n\n  if (typeof Symbol === \"function\" && typeof Symbol.iterator === \"symbol\") {\n    module.exports = _typeof = function _typeof(obj) {\n      return typeof obj;\n    };\n\n    module.exports[\"default\"] = module.exports, module.exports.__esModule = true;\n  } else {\n    module.exports = _typeof = function _typeof(obj) {\n      return obj && typeof Symbol === \"function\" && obj.constructor === Symbol && obj !== Symbol.prototype ? \"symbol\" : typeof obj;\n    };\n\n    module.exports[\"default\"] = module.exports, module.exports.__esModule = true;\n  }\n\n  return _typeof(obj);\n}\n\nmodule.exports = _typeof;\nmodule.exports[\"default\"] = module.exports, module.exports.__esModule = true;","const ImageIO = {\n  // empty object\n};\n\n/**\n * img : html image\n */\nImageIO.getImageCanvas = img => {\n  const canvasAux = document.createElement(\"canvas\");\n  canvasAux.width = img.width;\n  canvasAux.height = img.height;\n  const contextAux = canvasAux.getContext(\"2d\");\n  contextAux.fillStyle = \"rgba(0, 0, 0, 0)\";\n  contextAux.globalCompositeOperation = \"source-over\";\n  contextAux.fillRect(0, 0, canvasAux.width, canvasAux.height);\n  contextAux.drawImage(img, 0, 0);\n  return canvasAux;\n};\n\n/**\n * img : html image\n */\nImageIO.getDataFromImage = img => {\n  canvas = ImageIO.getImageCanvas(img);\n  return canvas.getContext(\"2d\").getImageData(0, 0, img.width, img.height);\n};\n\nImageIO.loadImage = src => {\n  const img = new Image();\n  img.src = src;\n  img.isReady = false;\n  img.onload = () => (img.isReady = true);\n  return img;\n};\n\nImageIO.generateImageReadyPredicate = img => () => img.isReady;\n\nexport default ImageIO;\n","import ImageIO from \"./ImageIO\";\n/*\n Canvas coordinates\n\n 0                  W-1\n +-------------> y\n |\n |\n |       *\n |\n |\n v x\n\n H-1\n */\n\n/*\n\nThe point xe_1 + ye_2 corresponds to a point in the middle of a pxl.\n\nThe canvas data is an array of length colors(C) * width(W) * height(H). Is a 3D-array.\nThe index is a number in [0, C * W * H - 1].\nHaving (x, y, z) where z is the color axis, the formula to index the array is :\n\nf(x, y, z) = C * W * x + C * y + z.\n\nWhere x in [0, H - 1], y in [0, W - 1] and z in [0, C - 1].\n\nNote that f(H - 1, W - 1, C - 1) = C * W * H - 1.\n*/\n\n// Auxiliary functions\nfunction scale(u, r) {\n  var ans = [];\n  ans[0] = u[0] * r;\n  ans[1] = u[1] * r;\n  return ans;\n}\n\nfunction add(u, v) {\n  var ans = [];\n  ans[0] = u[0] + v[0];\n  ans[1] = u[1] + v[1];\n  return ans;\n}\n\nfunction floor(x) {\n  var ans = [];\n  ans[0] = Math.floor(x[0]);\n  ans[1] = Math.floor(x[1]);\n  return ans;\n}\n\nfunction diff(u, v) {\n  var ans = [];\n  ans[0] = u[0] - v[0];\n  ans[1] = u[1] - v[1];\n  return ans;\n}\n\nfunction dot(u, v) {\n  return u[0] * v[0] + u[1] * v[1];\n}\n\nfunction squareNorm(x) {\n  return dot(x, x);\n}\n\nfunction norm(x) {\n  return Math.sqrt(dot(x, x));\n}\n\nfunction min(u, v) {\n  var ans = [];\n  ans[0] = Math.min(u[0], v[0]);\n  ans[1] = Math.min(u[1], v[1]);\n  return ans;\n}\n\nfunction max(u, v) {\n  var ans = [];\n  ans[0] = Math.max(u[0], v[0]);\n  ans[1] = Math.max(u[1], v[1]);\n  return ans;\n}\n\n/**\n * return solution to : [ u_0 , h] x = z_0\n *\n *                       [ u_1,  0] y = z_1\n */\nfunction solve2by2UpperTriMatrix(u, h, z) {\n  var aux = z[1] / u[1];\n  return [aux, (-u[0] * aux + z[0]) / h];\n}\n/**\n * return solution to : [ u_0 , 0] x = z_0\n *\n *                       [ u_1,  w] y = z_1\n */\nfunction solve2by2LowerTriMatrix(u, w, z) {\n  var aux = z[0] / u[0];\n  return [aux, (-u[1] * aux + z[1]) / w];\n}\n\n// Canvas\nvar Canvas = function (canvas) {\n  this.canvas = canvas;\n  this.ctx = canvas.getContext(\"2d\");\n  this.image = this.ctx.getImageData(0, 0, canvas.width, canvas.height);\n  // width * height * 4 array of integers\n  this.imageData = this.image.data;\n};\n\n/**\n * Returns a two vector with Height as first coordinate and Width as second. [Height, Width].\n */\nCanvas.prototype.getSize = function () {\n  return [this.canvas.height, this.canvas.width];\n};\n\n/**\n *  Draw update image on canvas.\n */\nCanvas.prototype.paintImage = function () {\n  this.ctx.putImageData(this.image, 0, 0);\n};\n\nCanvas.prototype.getCanvas = function () {\n  return this.canvas;\n};\n\n/**\n * Clear Image with @rgba color.\n *\n * @param rgba\n */\nCanvas.prototype.clearImage = function (rgba) {\n  this.useCanvasCtx((canvas) => {\n    var size = canvas.getSize();\n    canvas.ctx.fillStyle =\n      \"rgba(\" + rgba[0] + \",\" + rgba[1] + \",\" + rgba[2] + \",\" + rgba[3] + \")\";\n    canvas.ctx.globalCompositeOperation = \"source-over\";\n    canvas.ctx.fillRect(0, 0, size[1], size[0]);\n  }, true);\n};\n\nCanvas.prototype.useCanvasCtx = function (lambda, isClearImage = false) {\n  if (!isClearImage) {\n    this.ctx.putImageData(this.image, 0, 0);\n  }\n  lambda(this);\n  this.image = this.ctx.getImageData(\n    0,\n    0,\n    this.canvas.width,\n    this.canvas.height\n  );\n  this.imageData = this.image.data;\n};\n\nCanvas.prototype.getImageIndex = function (x) {\n  return 4 * (this.canvas.width * x[0] + x[1]);\n};\n\nCanvas.prototype.getPxl = function (x) {\n  var index = this.getImageIndex(x);\n  return [\n    this.imageData[index],\n    this.imageData[index + 1],\n    this.imageData[index + 2],\n    this.imageData[index + 3],\n  ];\n};\n\nCanvas.prototype.drawPxl = function (x, rgb) {\n  var index = this.getImageIndex(x);\n  this.imageData[index] = rgb[0];\n  this.imageData[index + 1] = rgb[1];\n  this.imageData[index + 2] = rgb[2];\n  this.imageData[index + 3] = rgb[3];\n};\n\n/*\n * x1     :   2-dim array\n * x2     :   2-dim array\n * shader :   is a function that receives a 2-dim array and a line (array with 2 points) and returns a rgba 4-dim array\n */\nCanvas.prototype.drawLine = function (x1, x2, shader) {\n  // add points before clip\n  shader.points = [x1, x2];\n\n  // do clipping\n  var stack = [];\n  stack.push(x1);\n  stack.push(x2);\n  var inStack = [];\n  var outStack = [];\n  for (var i = 0; i < stack.length; i++) {\n    var x = stack[i];\n    if (\n      0 <= x[0] &&\n      x[0] < this.canvas.height &&\n      0 <= x[1] &&\n      x[1] < this.canvas.width\n    ) {\n      inStack.push(x);\n    } else {\n      outStack.push(x);\n    }\n  }\n  // both points are inside canvas\n  if (inStack.length == 2) {\n    this.drawLineInt(inStack[0], inStack[1], shader);\n    return;\n  }\n  //intersecting line with canvas\n  var intersectionSolutions = [];\n  var v = [x2[0] - x1[0], x2[1] - x1[1]];\n  // Let s \\in [0,1]\n  // line intersection with [0, 0]^T + [H - 1, 0]^T s\n  intersectionSolutions.push(\n    solve2by2UpperTriMatrix(v, -(this.canvas.height - 1), [-x1[0], -x1[1]])\n  );\n  // line intersection with [H - 1, 0]^T + [0, W - 1]^T s\n  intersectionSolutions.push(\n    solve2by2LowerTriMatrix(v, -(this.canvas.width - 1), [\n      this.canvas.height - 1 - x1[0],\n      -x1[1],\n    ])\n  );\n  // line intersection with [H - 1, W - 1]^T + [-(H - 1), 0]^T s\n  intersectionSolutions.push(\n    solve2by2UpperTriMatrix(v, this.canvas.height - 1, [\n      this.canvas.height - 1 - x1[0],\n      this.canvas.width - 1 - x1[1],\n    ])\n  );\n  // line intersection with [0, W - 1]^T + [0, -(W - 1)]^T s\n  intersectionSolutions.push(\n    solve2by2LowerTriMatrix(v, this.canvas.width - 1, [\n      -x1[0],\n      this.canvas.width - 1 - x1[1],\n    ])\n  );\n\n  var validIntersection = [];\n  for (var i = 0; i < intersectionSolutions.length; i++) {\n    var x = intersectionSolutions[i];\n    if (0 <= x[0] && x[0] <= 1 && 0 <= x[1] && x[1] <= 1) {\n      validIntersection.push(x);\n    }\n  }\n\n  if (validIntersection.length == 0) return;\n\n  //it can be shown that at this point there is at least one valid intersection.\n  if (inStack.length > 0) {\n    var p = [\n      x1[0] + validIntersection[0][0] * v[0],\n      x1[1] + validIntersection[0][0] * v[1],\n    ];\n    this.drawLineInt(inStack.pop(), p, shader);\n    return;\n  }\n\n  var p0 = [\n    x1[0] + validIntersection[0][0] * v[0],\n    x1[1] + validIntersection[0][0] * v[1],\n  ];\n  for (var i = 1; i < validIntersection.length; i++) {\n    var p = [\n      x1[0] + validIntersection[i][0] * v[0],\n      x1[1] + validIntersection[i][0] * v[1],\n    ];\n    var v = diff(p, p0);\n    if (dot(v, v) > 1e-3) {\n      this.drawLineInt(p0, p, shader);\n      return;\n    }\n  }\n  this.drawLineInt(p0, p0, shader);\n};\n\nCanvas.prototype.drawLineInt = function (x1, x2, shader) {\n  x1 = floor(x1);\n  x2 = floor(x2);\n\n  var index = [-1, 0, 1];\n\n  var n = index.length;\n  var nn = n * n;\n\n  var x = [];\n  x[0] = x1[0];\n  x[1] = x1[1];\n\n  var tangent = diff(x2, x1);\n  var normal = [];\n  normal[0] = -tangent[1];\n  normal[1] = tangent[0];\n\n  shader(x, shader.points, this);\n\n  while (x[0] !== x2[0] || x[1] !== x2[1]) {\n    var fmin = Number.MAX_VALUE;\n    var minDir = [];\n    for (var k = 0; k < nn; k++) {\n      var i = index[k % n];\n      var j = index[Math.floor(k / n)];\n\n      var nextX = add(x, [i, j]);\n\n      var v = diff(nextX, x1);\n      var f = Math.abs(dot(v, normal)) - dot(v, tangent);\n      if (fmin > f) {\n        fmin = f;\n        minDir = [i, j];\n      }\n    }\n\n    x = add(x, minDir);\n    shader(x, shader.points, this);\n  }\n  shader(x, shader.points, this);\n};\n\nCanvas.prototype.drawPolygon = function (\n  array,\n  shader,\n  isInsidePoly = Canvas.isInsidePolygon\n) {\n  let upperBox = [\n    [Number.MAX_VALUE, Number.MAX_VALUE],\n    [Number.MIN_VALUE, Number.MIN_VALUE],\n  ];\n  for (let i = 0; i < array.length; i++) {\n    upperBox[0] = min(array[i], upperBox[0]);\n    upperBox[1] = max(array[i], upperBox[1]);\n  }\n\n  let size = this.getSize();\n  let clampedSize = diff(size, [1, 1]);\n  let zeros = [0, 0];\n  upperBox[0] = floor(min(clampedSize, max(zeros, upperBox[0])));\n  upperBox[1] = floor(min(clampedSize, max(zeros, upperBox[1])));\n\n  for (var i = upperBox[0][0]; i < upperBox[1][0]; i++) {\n    for (var j = upperBox[0][1]; j < upperBox[1][1]; j++) {\n      var x = [i, j];\n      if (isInsidePoly(x, array)) {\n        shader(x, array, this);\n      }\n    }\n  }\n};\n\n/*\n * x1     :   2-dim array\n * x2     :   2-dim array\n * x3     :   2-dim array\n * shader :   is a function that receives a 2-dim array and a triangle (array with 3 points) and returns a rgba 4-dim array\n */\nCanvas.prototype.drawTriangle = function (x1, x2, x3, shader) {\n  var array = [x1, x2, x3];\n  this.drawPolygon(array, shader, Canvas.isInsideConvex);\n};\n\n/* x1     :   2-dim array\n * x2     :   2-dim array\n * x3     :   2-dim array\n * x4     :   2-dim array\n * shader :   is a function that receives a 2-dim array and returns a rgba 4-dim array\n */\nCanvas.prototype.drawQuad = function (x1, x2, x3, x4, shader) {\n  this.drawPolygon([x1, x2, x3, x4], shader);\n};\n\nCanvas.prototype.drawImage = function (img, x) {\n  if (\"isReady\" in img && !img.isReady) return;\n  this.useCanvasCtx((canvas) => canvas.ctx.drawImage(img, x[1], x[0]));\n};\n\nCanvas.prototype.drawCircle = function (x, r, shader) {\n  var corner = scale([1, 1], r);\n  var upperBox = [diff(x, corner), add(x, corner)];\n  var size = this.getSize();\n  upperBox[0] = floor(min(diff(size, [1, 1]), max([0, 0], upperBox[0])));\n  upperBox[1] = floor(min(diff(size, [1, 1]), max([0, 0], upperBox[1])));\n  for (var i = upperBox[0][0]; i <= upperBox[1][0]; i++) {\n    for (var j = upperBox[0][1]; j <= upperBox[1][1]; j++) {\n      var p = [i, j];\n      if (this.isInsideCircle(p, x, r)) {\n        shader(p, [x, r], this);\n      }\n    }\n  }\n};\n\nCanvas.prototype.isInsideCircle = function (p, x, r) {\n  return squareNorm(diff(p, x)) <= r * r;\n};\n\nCanvas.prototype.addEventListener = function (key, lambda, useCapture) {\n  this.canvas.addEventListener(key, lambda, useCapture);\n};\n\nCanvas.prototype.drawString = function (x, string, contextShader) {\n  this.useCanvasCtx((canvas) => {\n    contextShader(canvas.ctx);\n    canvas.ctx.fillText(string, x[1], x[0]);\n  });\n};\n\n// Static functions\n\n// slower than isInsideConvex method\nCanvas.isInsidePolygon = function (x, array) {\n  var v = [];\n  var theta = 0;\n  var n = array.length;\n  for (var i = 0; i < n; i++) {\n    v[0] = diff(array[(i + 1) % n], x);\n    v[1] = diff(array[i], x);\n    theta += Math.acos(dot(v[0], v[1]) / (norm(v[0]) * norm(v[1])));\n  }\n  return Math.abs(theta - 2 * Math.PI) < 1e-3;\n};\n\nCanvas.isInsideConvex = function (x, array) {\n  var m = array.length;\n  var v = [];\n  var vDotN = [];\n  for (var i = 0; i < m; i++) {\n    v[i] = diff(array[(i + 1) % m], array[i]);\n    let n = [-v[i][1], v[i][0]];\n    let r = diff(x, array[i]);\n    vDotN[i] = dot(r, n);\n  }\n  let orientation = v[0][0] * v[1][1] - v[0][1] * v[1][0] > 0 ? 1 : -1;\n  for (var i = 0; i < m; i++) {\n    var myDot = vDotN[i] * orientation;\n    if (myDot < 0) return false;\n  }\n  return true;\n};\n\nCanvas.simpleShader = function (color) {\n  return (x, element, canvas) => canvas.drawPxl(x, color);\n};\n\nCanvas.colorShader = function (colors) {\n  var auxShader = (x, poly, canvas, alpha) => {\n    var interpolateColors = [0, 0, 0, 0];\n    for (var i = 0; i < poly.length; i++) {\n      interpolateColors[0] = interpolateColors[0] + colors[i][0] * alpha[i];\n      interpolateColors[1] = interpolateColors[1] + colors[i][1] * alpha[i];\n      interpolateColors[2] = interpolateColors[2] + colors[i][2] * alpha[i];\n      interpolateColors[3] = interpolateColors[3] + colors[i][3] * alpha[i];\n    }\n    canvas.drawPxl(x, interpolateColors);\n  };\n  return Canvas.interpolateTriangleShader(auxShader);\n};\n\nCanvas.interpolateQuadShader = function (shader) {\n  return function (x, quad, canvas) {\n    var t1 = [quad[0], quad[1], quad[2]];\n    var t2 = [quad[2], quad[3], quad[0]];\n    var alpha = Canvas.triangleBaryCoord(x, t1);\n    if (\n      alpha[0] > 0 &&\n      alpha[1] > 0 &&\n      alpha[2] > 0 &&\n      Math.abs(alpha[0] + alpha[1] + alpha[2] - 1) < 1e-10\n    ) {\n      shader(x, quad, canvas, [alpha[0], alpha[1], alpha[2], 0]);\n    } else {\n      alpha = Canvas.triangleBaryCoord(x, t2);\n      shader(x, quad, canvas, [alpha[2], 0, alpha[0], alpha[1]]);\n    }\n  };\n};\n\nCanvas.interpolateTriangleShader = function (shader) {\n  return (x, triangle, canvas) => {\n    const alpha = Canvas.triangleBaryCoord(x, triangle);\n    shader(x, triangle, canvas, alpha);\n  };\n};\n\nCanvas.interpolateLineShader = function (shader) {\n  return (x, line, canvas) => {\n    var v = diff(line[1], line[0]);\n    var z = diff(x, line[0]);\n    var vnorm = squareNorm(v);\n    var projection = dot(z, v);\n    var t = vnorm == 0.0 ? 0 : projection / vnorm;\n    shader(x, line, canvas, t);\n  };\n};\n\n/**\n * img: html loaded image.\n * quadTexCoord: [0, 1]^{2 * 4}, texture coordinates\n */\nCanvas.quadTextureShader = function (\n  img,\n  quadTexCoord,\n  interpolation = Canvas.bilinearInterpolation\n) {\n  let imageCache = null;\n  const imageShader = (x, quad, canvas, alpha) => {\n    if (!img.isReady || imageCache == null)\n      imageCache = new Canvas(ImageIO.getImageCanvas(img));\n    const imageCanvas = imageCache;\n    const imgSize = imageCanvas.getSize();\n    const interpolateTexCoord = [0, 0];\n    for (let i = 0; i < quadTexCoord.length; i++) {\n      interpolateTexCoord[0] =\n        interpolateTexCoord[0] + quadTexCoord[i][0] * alpha[i];\n      interpolateTexCoord[1] =\n        interpolateTexCoord[1] + quadTexCoord[i][1] * alpha[i];\n    }\n    var i = [\n      (1 - interpolateTexCoord[1]) * (imgSize[1] - 1),\n      (imgSize[0] - 1) * interpolateTexCoord[0],\n    ];\n    // bound coordinates\n    i = max([0, 0], min(diff([imgSize[0], imgSize[1]], [1, 1]), i));\n    // pxl lower corner\n    var j = floor(i);\n    var cornerColors = [\n      imageCanvas.getPxl(j),\n      imageCanvas.getPxl(add(j, [1, 0])),\n      imageCanvas.getPxl(add(j, [1, 1])),\n      imageCanvas.getPxl(add(j, [0, 1])),\n    ];\n    var finalColor = interpolation(cornerColors, diff(i, j));\n    canvas.drawPxl(x, finalColor);\n  };\n  return Canvas.interpolateQuadShader(imageShader);\n};\n\nCanvas.triangleCache = (() => {\n  const hashMap = [];\n  const size = 3;\n  return {\n    constains: (triangleHash) => hashMap[triangleHash % size] != undefined,\n    get: (triangleHash) => hashMap[triangleHash % size],\n    set: (triangleHash, value) => (hashMap[triangleHash % size] = value),\n  };\n})(); //{triangle: null, u: [], v:[], det:null, hash:null}\n\nCanvas.triangleHash = (triangle) => {\n  const array = [\n    triangle[0][0],\n    triangle[1][0],\n    triangle[2][0],\n    triangle[0][1],\n    triangle[1][1],\n    triangle[2][1],\n  ];\n  return array.reduce((h, x) => 31 * h + x, 1);\n};\n\nCanvas.triangleBaryCoord = function (x, triangle) {\n  const hash = Canvas.triangleHash(triangle);\n  const y = [x[0] - triangle[0][0], x[1] - triangle[0][1]];\n  if (!Canvas.triangleCache.constains(hash)) {\n    const u = [\n      triangle[1][0] - triangle[0][0],\n      triangle[1][1] - triangle[0][1],\n    ];\n    const v = [\n      triangle[2][0] - triangle[0][0],\n      triangle[2][1] - triangle[0][1],\n    ];\n    const det = u[0] * v[1] - u[1] * v[0];\n    Canvas.triangleCache.set(hash, {\n      triangle: triangle,\n      u: u.map((x) => x / det),\n      v: v.map((x) => x / det),\n      det: det,\n      hash: hash,\n    });\n  }\n  const cache = Canvas.triangleCache.get(hash);\n  const u = cache.u;\n  const v = cache.v;\n  const det = cache.det;\n  if (det == 0) return [0, 0, 0];\n  var alpha = [v[1] * y[0] - v[0] * y[1], u[0] * y[1] - u[1] * y[0]];\n  return [1 - alpha[0] - alpha[1], alpha[0], alpha[1]];\n};\n\n/**\n * values \\in R^{k * 4}\n * x \\in [0,1]^2\n */\nCanvas.bilinearInterpolation = function (values, x) {\n  var acc = [];\n  for (var k = 0; k < values.length; k++) {\n    var f03 = values[0][k] + (values[3][k] - values[0][k]) * x[1];\n    var f12 = values[1][k] + (values[2][k] - values[1][k]) * x[1];\n    var f = f03 + (f12 - f03) * x[0];\n    acc.push(f);\n  }\n  return acc;\n};\n/**\n * size: is an array with width and height of a HTML5 Canvas.\n * domId: DOM element where the canvas will be added\n *\n * returns Canvas object from the generated html canvas.\n */\nCanvas.createCanvas = function (size, domId) {\n  const canvas = document.createElement(\"canvas\");\n  canvas.setAttribute(\"width\", size[0]);\n  canvas.setAttribute(\"height\", size[1]);\n  document.getElementById(domId).appendChild(canvas);\n  return canvas;\n};\n\nexport default Canvas;\n","import Canvas from \"./Canvas\";\n\n//Note that we can switch from heritage to composition, think about that\n\n// cameraSpace : 2-dim array with two 2-dim arrays that are intervals [a,b] | a < b\nvar Canvas2D = function (canvas, cameraSpace) {\n  Canvas.call(this, canvas);\n  if (\n    cameraSpace.length != 2 ||\n    (cameraSpace[0].length != 2 && cameraSpace[1].length != 2)\n  ) {\n    throw \"camera space must be 2-dim array with 2-dim arrays representing an interval\";\n  }\n  this.cameraSpace = cameraSpace;\n};\n\nCanvas2D.prototype = Object.create(Canvas.prototype);\nCanvas2D.prototype.constructor = Canvas2D;\n\n/* x : 2-dim array in camera space coordinates\n * returns : 2-dim array in integer coordinates\n */\nCanvas2D.prototype.integerTransform = function (x) {\n  var xint =\n    (-(this.canvas.height - 1) /\n      (this.cameraSpace[1][1] - this.cameraSpace[1][0])) *\n    (x[1] - this.cameraSpace[1][1]);\n  var yint =\n    ((this.canvas.width - 1) /\n      (this.cameraSpace[0][1] - this.cameraSpace[0][0])) *\n    (x[0] - this.cameraSpace[0][0]);\n  return [xint, yint];\n};\n\n/* x : 2-dim array in integer coordinates\n * returns : 2-dim array in camera space coordinates\n */\nCanvas2D.prototype.inverseTransform = function (x) {\n  var xt =\n    this.cameraSpace[0][0] +\n    ((this.cameraSpace[0][1] - this.cameraSpace[0][0]) /\n      (this.canvas.width - 1)) *\n      x[1];\n  var yt =\n    this.cameraSpace[1][1] -\n    ((this.cameraSpace[1][1] - this.cameraSpace[1][0]) /\n      (this.canvas.height - 1)) *\n      x[0];\n  return [xt, yt];\n};\n\n/* x1     :   2-dim array\n * x2     :   2-dim array\n * shader :   is a function that receives a 2-dim array and returns a rgba 4-dim array\n */\nCanvas2D.prototype.drawLine = function (x1, x2, shader) {\n  const y1 = this.integerTransform(x1);\n  const y2 = this.integerTransform(x2);\n  Canvas.prototype.drawLine.call(this, y1, y2, shader);\n};\n\n/* x1     :   2-dim array\n * x2     :   2-dim array\n * x3     :   2-dim array\n * shader :   is a function that receives a 2-dim array and returns a rgba 4-dim array\n */\nCanvas2D.prototype.drawTriangle = function (x1, x2, x3, shader) {\n  const y1 = this.integerTransform(x1);\n  const y2 = this.integerTransform(x2);\n  const y3 = this.integerTransform(x3);\n  Canvas.prototype.drawTriangle.call(this, y1, y2, y3, shader);\n};\n\n/* x1     :   2-dim array\n * x2     :   2-dim array\n * x3     :   2-dim array\n * x4     :   2-dim array\n * shader :   is a function that receives a 2-dim array and returns a rgba 4-dim array\n */\nCanvas2D.prototype.drawQuad = function (x1, x2, x3, x4, shader) {\n  const y1 = this.integerTransform(x1);\n  const y2 = this.integerTransform(x2);\n  const y3 = this.integerTransform(x3);\n  const y4 = this.integerTransform(x4);\n  Canvas.prototype.drawQuad.call(this, y1, y2, y3, y4, shader);\n};\n\nCanvas2D.prototype.drawCircle = function (x, r, shader) {\n  // it assumes squared canvas, for now ...\n  const y = this.integerTransform(x);\n  const z = this.integerTransform([r, 0])[1] - this.integerTransform([0, 0])[1];\n  Canvas.prototype.drawCircle.call(this, y, z, shader);\n};\n\nCanvas2D.prototype.drawImage = function (img, x) {\n  Canvas.prototype.drawImage.call(this, img, this.integerTransform(x));\n};\n\nCanvas2D.prototype.drawString = function (x, string, contextShader) {\n  const y = this.integerTransform(x);\n  Canvas.prototype.drawString.call(this, y, string, contextShader);\n};\n\n// camera : 2-dim array with two 2-dim arrays that are intervals [a,b] | a < b\nCanvas2D.prototype.setCamera = function (camera) {\n  if (camera.length != 2 || (camera[0].length != 2 && camera[1].length != 2)) {\n    throw \"camera space must be 2-dim array with 2-dim arrays representing an interval\";\n  }\n  this.cameraSpace = camera;\n};\n\nexport default Canvas2D;\n","export default function _arrayLikeToArray(arr, len) {\n  if (len == null || len > arr.length) len = arr.length;\n\n  for (var i = 0, arr2 = new Array(len); i < len; i++) {\n    arr2[i] = arr[i];\n  }\n\n  return arr2;\n}","import arrayLikeToArray from \"./arrayLikeToArray.js\";\nexport default function _unsupportedIterableToArray(o, minLen) {\n  if (!o) return;\n  if (typeof o === \"string\") return arrayLikeToArray(o, minLen);\n  var n = Object.prototype.toString.call(o).slice(8, -1);\n  if (n === \"Object\" && o.constructor) n = o.constructor.name;\n  if (n === \"Map\" || n === \"Set\") return Array.from(o);\n  if (n === \"Arguments\" || /^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)) return arrayLikeToArray(o, minLen);\n}","import arrayWithoutHoles from \"./arrayWithoutHoles.js\";\nimport iterableToArray from \"./iterableToArray.js\";\nimport unsupportedIterableToArray from \"./unsupportedIterableToArray.js\";\nimport nonIterableSpread from \"./nonIterableSpread.js\";\nexport default function _toConsumableArray(arr) {\n  return arrayWithoutHoles(arr) || iterableToArray(arr) || unsupportedIterableToArray(arr) || nonIterableSpread();\n}","import arrayLikeToArray from \"./arrayLikeToArray.js\";\nexport default function _arrayWithoutHoles(arr) {\n  if (Array.isArray(arr)) return arrayLikeToArray(arr);\n}","export default function _iterableToArray(iter) {\n  if (typeof Symbol !== \"undefined\" && iter[Symbol.iterator] != null || iter[\"@@iterator\"] != null) return Array.from(iter);\n}","export default function _nonIterableSpread() {\n  throw new TypeError(\"Invalid attempt to spread non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.\");\n}","import arrayWithHoles from \"./arrayWithHoles.js\";\nimport iterableToArrayLimit from \"./iterableToArrayLimit.js\";\nimport unsupportedIterableToArray from \"./unsupportedIterableToArray.js\";\nimport nonIterableRest from \"./nonIterableRest.js\";\nexport default function _slicedToArray(arr, i) {\n  return arrayWithHoles(arr) || iterableToArrayLimit(arr, i) || unsupportedIterableToArray(arr, i) || nonIterableRest();\n}","export default function _arrayWithHoles(arr) {\n  if (Array.isArray(arr)) return arr;\n}","export default function _iterableToArrayLimit(arr, i) {\n  var _i = arr == null ? null : typeof Symbol !== \"undefined\" && arr[Symbol.iterator] || arr[\"@@iterator\"];\n\n  if (_i == null) return;\n  var _arr = [];\n  var _n = true;\n  var _d = false;\n\n  var _s, _e;\n\n  try {\n    for (_i = _i.call(arr); !(_n = (_s = _i.next()).done); _n = true) {\n      _arr.push(_s.value);\n\n      if (i && _arr.length === i) break;\n    }\n  } catch (err) {\n    _d = true;\n    _e = err;\n  } finally {\n    try {\n      if (!_n && _i[\"return\"] != null) _i[\"return\"]();\n    } finally {\n      if (_d) throw _e;\n    }\n  }\n\n  return _arr;\n}","export default function _nonIterableRest() {\n  throw new TypeError(\"Invalid attempt to destructure non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.\");\n}","export default function _classCallCheck(instance, Constructor) {\n  if (!(instance instanceof Constructor)) {\n    throw new TypeError(\"Cannot call a class as a function\");\n  }\n}","function _defineProperties(target, props) {\n  for (var i = 0; i < props.length; i++) {\n    var descriptor = props[i];\n    descriptor.enumerable = descriptor.enumerable || false;\n    descriptor.configurable = true;\n    if (\"value\" in descriptor) descriptor.writable = true;\n    Object.defineProperty(target, descriptor.key, descriptor);\n  }\n}\n\nexport default function _createClass(Constructor, protoProps, staticProps) {\n  if (protoProps) _defineProperties(Constructor.prototype, protoProps);\n  if (staticProps) _defineProperties(Constructor, staticProps);\n  return Constructor;\n}","export default function _defineProperty(obj, key, value) {\n  if (key in obj) {\n    Object.defineProperty(obj, key, {\n      value: value,\n      enumerable: true,\n      configurable: true,\n      writable: true\n    });\n  } else {\n    obj[key] = value;\n  }\n\n  return obj;\n}","export default class Color {\n  /**\n   *\n   * @param {Uint8Array} rgba\n   */\n  constructor(rgba) {\n    this.rgba = rgba;\n  }\n\n  getRGBA() {\n    return this.rgba;\n  }\n\n  get red() {\n    return this.rgba[0];\n  }\n\n  get green() {\n    return this.rgba[1];\n  }\n\n  get blue() {\n    return this.rgba[2];\n  }\n\n  get alpha() {\n    return this.rgba[3];\n  }\n\n  /**\n   *\n   * @param {Color} color\n   * @returns {Boolean}\n   */\n  equals(color) {\n    for (let i = 0; i < this.rgba.length; i++) {\n      if (this.rgba[i] !== color.rgba[i]) {\n        return false;\n      }\n    }\n    return true;\n  }\n\n  static ofRGBA(red = 0, green = 0, blue = 0, alpha = 255) {\n    const rgba = new Uint8Array(4);\n    rgba[0] = red;\n    rgba[1] = green;\n    rgba[2] = blue;\n    rgba[3] = alpha;\n    return new Color(rgba);\n  }\n\n  static random() {\n    const r = () => Math.random() * 256;\n    return Color.ofRGBA(r(), r(), r(), r());\n  }\n\n  static RED = Color.ofRGBA(255, 0, 0);\n  static GREEN = Color.ofRGBA(0, 255, 0);\n  static BLUE = Color.ofRGBA(0, 0, 255);\n  static BLACK = Color.ofRGBA(0, 0, 0);\n  static WHITE = Color.ofRGBA(255, 255, 255);\n}\n","export default function _setPrototypeOf(o, p) {\n  _setPrototypeOf = Object.setPrototypeOf || function _setPrototypeOf(o, p) {\n    o.__proto__ = p;\n    return o;\n  };\n\n  return _setPrototypeOf(o, p);\n}","import setPrototypeOf from \"./setPrototypeOf.js\";\nexport default function _inherits(subClass, superClass) {\n  if (typeof superClass !== \"function\" && superClass !== null) {\n    throw new TypeError(\"Super expression must either be null or a function\");\n  }\n\n  subClass.prototype = Object.create(superClass && superClass.prototype, {\n    constructor: {\n      value: subClass,\n      writable: true,\n      configurable: true\n    }\n  });\n  if (superClass) setPrototypeOf(subClass, superClass);\n}","export default function _assertThisInitialized(self) {\n  if (self === void 0) {\n    throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\");\n  }\n\n  return self;\n}","import _typeof from \"@babel/runtime/helpers/typeof\";\nimport assertThisInitialized from \"./assertThisInitialized.js\";\nexport default function _possibleConstructorReturn(self, call) {\n  if (call && (_typeof(call) === \"object\" || typeof call === \"function\")) {\n    return call;\n  }\n\n  return assertThisInitialized(self);\n}","export default function _getPrototypeOf(o) {\n  _getPrototypeOf = Object.setPrototypeOf ? Object.getPrototypeOf : function _getPrototypeOf(o) {\n    return o.__proto__ || Object.getPrototypeOf(o);\n  };\n  return _getPrototypeOf(o);\n}","export default function _isNativeReflectConstruct() {\n  if (typeof Reflect === \"undefined\" || !Reflect.construct) return false;\n  if (Reflect.construct.sham) return false;\n  if (typeof Proxy === \"function\") return true;\n\n  try {\n    Boolean.prototype.valueOf.call(Reflect.construct(Boolean, [], function () {}));\n    return true;\n  } catch (e) {\n    return false;\n  }\n}","import setPrototypeOf from \"./setPrototypeOf.js\";\nimport isNativeReflectConstruct from \"./isNativeReflectConstruct.js\";\nexport default function _construct(Parent, args, Class) {\n  if (isNativeReflectConstruct()) {\n    _construct = Reflect.construct;\n  } else {\n    _construct = function _construct(Parent, args, Class) {\n      var a = [null];\n      a.push.apply(a, args);\n      var Constructor = Function.bind.apply(Parent, a);\n      var instance = new Constructor();\n      if (Class) setPrototypeOf(instance, Class.prototype);\n      return instance;\n    };\n  }\n\n  return _construct.apply(null, arguments);\n}","import getPrototypeOf from \"./getPrototypeOf.js\";\nimport setPrototypeOf from \"./setPrototypeOf.js\";\nimport isNativeFunction from \"./isNativeFunction.js\";\nimport construct from \"./construct.js\";\nexport default function _wrapNativeSuper(Class) {\n  var _cache = typeof Map === \"function\" ? new Map() : undefined;\n\n  _wrapNativeSuper = function _wrapNativeSuper(Class) {\n    if (Class === null || !isNativeFunction(Class)) return Class;\n\n    if (typeof Class !== \"function\") {\n      throw new TypeError(\"Super expression must either be null or a function\");\n    }\n\n    if (typeof _cache !== \"undefined\") {\n      if (_cache.has(Class)) return _cache.get(Class);\n\n      _cache.set(Class, Wrapper);\n    }\n\n    function Wrapper() {\n      return construct(Class, arguments, getPrototypeOf(this).constructor);\n    }\n\n    Wrapper.prototype = Object.create(Class.prototype, {\n      constructor: {\n        value: Wrapper,\n        enumerable: false,\n        writable: true,\n        configurable: true\n      }\n    });\n    return setPrototypeOf(Wrapper, Class);\n  };\n\n  return _wrapNativeSuper(Class);\n}","export default function _isNativeFunction(fn) {\n  return Function.toString.call(fn).indexOf(\"[native code]\") !== -1;\n}","//========================================================================================\n/*                                                                                      *\n *                              MATRIX UTILS (order counts)                             *\n *                                                                                      */\n//========================================================================================\n\nconst getIndexFromCoord = (_, m) => (i, j) => j + i * m;\nconst getCoordFromIndex = (_, m) => (k) => [k / m, k % m].map(Math.floor);\nconst index2Key = (i, j) => `${i},${j}`;\nconst key2Index = (k) => k.split(\",\").map(Number);\n\nclass MatrixBuilder {\n  constructor() {\n    this._size = [];\n    this.data = {};\n  }\n\n  size(n, m = 1) {\n    this._size = [n, m];\n    return this;\n  }\n\n  set(i, j, v) {\n    if (this._size.length === 0)\n      throw new MatrixError(\"Setting value to empty matrix\");\n    this.data[index2Key(i, j)] = v;\n    return this;\n  }\n\n  build() {\n    const [n, m] = this._size;\n    const data = new Float64Array(n * m);\n    const indexer = getIndexFromCoord(n, m);\n    Object.keys(this.data).forEach((key) => {\n      data[indexer(...key2Index(key))] = this.data[key];\n    });\n    return new Matrix(data, this._size);\n  }\n}\n\nclass RowBuilder {\n  constructor() {\n    this.rows = [];\n    this.dim = 0;\n  }\n\n  addRow(...array) {\n    if (this.dim === 0) {\n      this.dim = array.length;\n    }\n    if (this.dim !== array.length)\n      throw new MatrixError(\n        `Added row of different dimension, actual dim is ${this.dim}`\n      );\n    this.rows.push(array);\n    return this;\n  }\n\n  build() {\n    if (this.rows.length > 0) return this._buildWithRows();\n    throw new MatrixError(\"Building empty matrix\");\n  }\n\n  _buildWithRows() {\n    const rows = this.rows.length;\n    const cols = this.dim;\n    const data = new Float64Array(rows * cols);\n    const indexF = getIndexFromCoord(rows, cols);\n    for (let i = 0; i < rows; i++) {\n      for (let j = 0; j < cols; j++) {\n        data[indexF(i, j)] = this.rows[i][j];\n      }\n    }\n    return new Matrix(data, [rows, cols]);\n  }\n}\n\nclass ColBuilder {\n  constructor() {\n    this.cols = [];\n    this.dim = 0;\n  }\n\n  addCol(...array) {\n    if (this.dim === 0) {\n      this.dim = array.length;\n    }\n    if (this.dim !== array.length)\n      throw new MatrixError(\n        `Added col of different dimension, actual dim is ${this.dim}`\n      );\n    this.cols.push(array);\n    return this;\n  }\n\n  build() {\n    if (this.cols.length > 0) return this.#buildWithCols();\n    throw new MatrixError(\"Building empty matrix\");\n  }\n\n  #buildWithCols() {\n    const rows = this.dim;\n    const cols = this.cols.length;\n    const data = new Float64Array(rows * cols);\n    const indexF = getIndexFromCoord(rows, cols);\n    for (let i = 0; i < rows; i++) {\n      for (let j = 0; j < cols; j++) {\n        data[indexF(i, j)] = this.cols[j][i];\n      }\n    }\n    return new Matrix(data, [rows, cols]);\n  }\n}\n\n//========================================================================================\n/*                                                                                      *\n *                                        MATRIX                                        *\n *                                                                                      */\n//========================================================================================\n\nexport default class Matrix {\n  /**\n   *\n   * @param {Float64Array} data: Matrix data in major row format\n   * @param {Array} shape: 2-array [rows,columns]\n   */\n  constructor(data, shape) {\n    this.data = data;\n    this.shape = shape;\n  }\n\n  get rows() {\n    return this.shape[0];\n  }\n\n  get cols() {\n    return this.shape[1];\n  }\n\n  get(i = 0, j = 0) {\n    const [_, cols] = this.shape;\n    return this.data[j + i * cols];\n  }\n\n  prod(matrix) {\n    if (this.cols !== matrix.rows) {\n      throw new MatrixError(\n        `Incompatible product size. Left ${this.shape}, right ${matrix.shape}`\n      );\n    }\n    const n = this.rows;\n    const m = this.cols;\n    const l = matrix.cols;\n    const prod = new Float64Array(n * l);\n    const indexer = getIndexFromCoord(n, l);\n    for (let i = 0; i < n; i++) {\n      for (let j = 0; j < l; j++) {\n        let acc = 0;\n        for (let k = 0; k < m; k++) {\n          acc += this.get(i, k) * matrix.get(k, j);\n        }\n        prod[indexer(i, j)] = acc;\n      }\n    }\n\n    return new Matrix(prod, [n, l]);\n  }\n\n  dot(matrix) {\n    if (this.rows !== matrix.rows)\n      throw new MatrixError(\n        `Incompatible product size. Left ${this.shape}, right ${matrix.shape}`\n      );\n    const n = this.rows;\n    const m = this.cols;\n    const l = matrix.cols;\n    const prod = new Float64Array(m * l);\n    const indexer = getIndexFromCoord(m, l);\n    for (let i = 0; i < m; i++) {\n      for (let j = 0; j < l; j++) {\n        let acc = 0;\n        for (let k = 0; k < n; k++) {\n          acc += this.get(k, i) * matrix.get(k, j);\n        }\n        prod[indexer(i, j)] = acc;\n      }\n    }\n\n    return new Matrix(prod, [m, l]);\n  }\n\n  /**\n   *\n   * @param {*} lambda: (number, i, j) => number\n   * @returns Matrix\n   */\n  map(lambda = (x) => x) {\n    const getCoord = getCoordFromIndex(...this.shape);\n    return new Matrix(\n      this.data.map((x, k) => {\n        const [i, j] = getCoord(k);\n        return lambda(x, i, j);\n      }),\n      this.shape\n    );\n  }\n\n  /**\n   *\n   * @param {*} lambda (accumulator, number, i, j) => number\n   * @param {*} identity\n   */\n  reduce(lambda, identity = 0) {\n    const getCoord = getCoordFromIndex(...this.shape);\n    return this.data.reduce((e, x, k) => {\n      const [i, j] = getCoord(k);\n      return lambda(e, x, i, j);\n    }, identity);\n  }\n\n  fold = this.reduce;\n\n  /**\n   *\n   * @param {*} binaryLambda: (number,number) => number\n   */\n  op(matrix, binaryLambda) {\n    const [rows, cols] = this.shape;\n    const [mRows, mCols] = matrix.shape;\n    if (rows !== mRows || cols !== mCols)\n      throw new MatrixError(\"Matrix must be of same size\");\n    return new Matrix(\n      this.data.map((x, i) => binaryLambda(x, matrix.data[i])),\n      this.shape\n    );\n  }\n\n  add(matrix) {\n    return this.op(matrix, (a, b) => a + b);\n  }\n\n  sub(matrix) {\n    return this.op(matrix, (a, b) => a - b);\n  }\n\n  mul(matrix) {\n    return this.op(matrix, (a, b) => a * b);\n  }\n\n  div(matrix) {\n    return this.op(matrix, (a, b) => a / b);\n  }\n\n  scale(real) {\n    return this.map((x) => x * real);\n  }\n\n  norm() {\n    let acc = 0;\n    for (let i = 0; i < this.data.length; i++) {\n      acc += this.data[i] * this.data[i];\n    }\n    return Math.sqrt(acc);\n  }\n\n  length = this.norm;\n\n  equals(matrix, precision = 1e-6) {\n    if (!(matrix instanceof Matrix)) return false;\n    try {\n      return this.sub(matrix).length() < precision;\n    } catch (error) {\n      return false;\n    }\n  }\n\n  toArray() {\n    return this.data;\n  }\n\n  static id = (n, m = n) => {\n    const en = Matrix.e(n);\n    let matrixBuilder = Matrix.colBuilder();\n    for (let i = 0; i < m; i++) {\n      matrixBuilder = matrixBuilder.addCol(...en(i).data);\n    }\n    return matrixBuilder.build();\n  };\n\n  static e = (n) => (i) => {\n    return new Matrix(\n      new Float64Array(n).map((_, j) => (i === j ? 1 : 0)),\n      [n, 1]\n    );\n  };\n\n  static dx = (n) => (i) => {\n    return new Matrix(\n      new Float64Array(n).map((_, j) => (i === j ? 1 : 0)),\n      [1, n]\n    );\n  };\n\n  static ZERO(n, m = 1) {\n    return Matrix.builder().size(n, m).build();\n  }\n\n  static random(n, m = 1) {\n    const data = new Float64Array(n * m);\n    for (let i = 0; i < data.length; i++) {\n      data[i] = Math.random();\n    }\n    return new Matrix(data, [n, m]);\n  }\n\n  static builder() {\n    return new MatrixBuilder();\n  }\n\n  static rowBuilder() {\n    return new RowBuilder();\n  }\n\n  static colBuilder() {\n    return new ColBuilder();\n  }\n\n  static vec(...array) {\n    return new ColBuilder().addCol(...array).build();\n  }\n\n  static cov(...array) {\n    return new RowBuilder().addRow(...array).build();\n  }\n\n  static vec2 = {\n    of: (x = 0, y = 0) => Matrix.vec(x, y),\n    e0: Matrix.vec(1, 0),\n    e1: Matrix.vec(0, 1),\n    ZERO: Matrix.ZERO(2, 1),\n  };\n\n  static vec3 = {\n    of: (x = 0, y = 0, z = 0) => Matrix.vec(x, y, z),\n    e0: Matrix.vec(1, 0, 0),\n    e1: Matrix.vec(0, 1, 0),\n    e2: Matrix.vec(0, 0, 1),\n    ZERO: Matrix.ZERO(3, 1),\n  };\n}\n\nexport class MatrixError extends Error {}\n","import Matrix from \"../../Matrix/main/Matrix\";\n\nexport default class BBox {\n  constructor(min, max) {\n    this.isEmpty = min === undefined || max === undefined;\n    if (this.isEmpty) return this;\n    this.min = min.op(max, Math.min);\n    this.max = max.op(min, Math.max);\n    this.center = min.add(max).scale(1 / 2);\n    this.diagonal = max.sub(min);\n  }\n  /**\n   * Union of boxes\n   * @param {*} box\n   */\n  add(box) {\n    if (this === BBox.EMPTY) return box;\n    const { min, max } = this;\n    return new BBox(min.op(box.min, Math.min), max.op(box.max, Math.max));\n  }\n\n  union = this.add;\n\n  /**\n   * Intersection of boxes\n   * @param {*} box\n   */\n  sub(box) {\n    if (this === BBox.EMPTY) return BBox.EMPTY;\n    const { min, max } = this;\n    const newMin = min.op(box.min, Math.max);\n    const newMax = max.op(box.max, Math.min);\n    const newDiag = newMax.sub(newMin);\n    const isAllPositive = newDiag.data.every((x) => x >= 0);\n    return !isAllPositive ? BBox.EMPTY : new BBox(newMin, newMax);\n  }\n\n  inter = this.sub;\n\n  move(vector) {\n    return new BBox(this.min.add(vector), this.max.add(vector));\n  }\n\n  collidesWith(box) {\n    const actionByTypes = [\n      { type: BBox, action: () => !this.sub(box).isEmpty },\n      { type: Matrix, action: () => !this.sub(new BBox(box, box)).isEmpty },\n    ];\n    for (let i = 0; i < actionByTypes.length; i++) {\n      if (box instanceof actionByTypes[i].type) {\n        return actionByTypes[i].action();\n      }\n    }\n  }\n\n  equals(box) {\n    if (!(box instanceof BBox)) return false;\n    if (this == BBox.EMPTY) return true;\n    return this.min.equals(box.min) && this.max.equals(box.max);\n  }\n\n  static ofPoint(...array) {\n    const point = Matrix.vec(...array);\n    return new BBox(point, point);\n  }\n  static EMPTY = new BBox();\n}\n","import Color from \"../../Color/main/Color\";\nimport Matrix from \"../../Matrix/main/Matrix\";\nimport BBox from \"../../BBox/main/BBox\";\nconst { vec2 } = Matrix;\n/*\n Canvas coordinates\n\n 0                  W-1\n +-------------> y\n |\n |\n |       *\n |\n |\n v x\n\n H-1\n */\n\n/*\n\nThe point xe_1 + ye_2 corresponds to a point in the middle of a pxl.\n\nThe canvas data is an array of length colors(C) * width(W) * height(H). Is a 3D-array.\nThe index is a number in [0, C * W * H - 1].\nHaving (x, y, z) where z is the color axis, the formula to index the array is :\n\nf(x, y, z) = C * W * x + C * y + z.\n\nWhere x in [0, H - 1], y in [0, W - 1] and z in [0, C - 1].\n\nNote that f(H - 1, W - 1, C - 1) = C * W * H - 1.\n*/\n\nexport default class Canvas {\n  /**\n   *\n   * @param {canvasDOM} canvas: DOM element of type canvas\n   */\n  constructor(canvas) {\n    this.canvas = canvas;\n    this.ctx = canvas.getContext(\"2d\");\n    this.image = this.ctx.getImageData(0, 0, canvas.width, canvas.height);\n    // width * height * 4 array of integers\n    this.data = this.image.data;\n  }\n\n  getCanvas() {\n    return this.canvas;\n  }\n\n  getDom = this.getCanvas;\n\n  get width() {\n    return this.canvas.width;\n  }\n\n  get height() {\n    return this.canvas.height;\n  }\n  //========================================================================================\n  /*                                                                                      *\n   *                                 side effects function                                *\n   *                                                                                      */\n  //========================================================================================\n\n  /**\n   * Update color of canvas\n   * @param {Color} color\n   * @returns {Canvas}\n   */\n  fill(color = Color.ofRGBA(255, 255, 255)) {\n    this.ctx.fillStyle = `rgba(${color.red}, ${color.green}, ${color.blue}, ${\n      color.alpha / 255.0\n    })`;\n    this.ctx.fillRect(0, 0, this.canvas.width, this.canvas.height);\n    this.image = this.ctx.getImageData(\n      0,\n      0,\n      this.canvas.width,\n      this.canvas.height\n    );\n    this.data = this.image.data;\n    return this;\n  }\n\n  /**\n   *\n   * @param {(Color, Number, Number) => Color} lambda\n   * @returns {Canvas}\n   */\n  map(lambda = () => {}) {\n    const n = this.data.length;\n    const { width: w } = this.canvas;\n    for (let i = 0; i < n; i += 4) {\n      const x = Math.floor(i / (4 * w));\n      const y = Math.floor(i / 4) % w;\n      const color = lambda(\n        Color.ofRGBA(\n          this.data[i],\n          this.data[i + 1],\n          this.data[i + 2],\n          this.data[i + 3]\n        ),\n        x,\n        y\n      );\n      this.data[i] = color.red;\n      this.data[i + 1] = color.green;\n      this.data[i + 2] = color.blue;\n      this.data[i + 3] = color.alpha;\n    }\n    return this;\n  }\n\n  /**\n   * Return pxl color at (i,j)\n   * @param {Number} i: integer \\in [0,H-1]\n   * @param {Number} j: integer \\in [0,W-1]\n   * @returns {Color}\n   */\n  getPxl(i, j) {\n    const { width, height } = this.canvas;\n    if (i < 0 || i >= height || j < 0 || j >= width) return undefined;\n    const index = 4 * (i * width + j);\n    return Color.ofRGBA(\n      this.imgBuffer[index],\n      this.imgBuffer[index + 1],\n      this.imgBuffer[index + 2],\n      this.imgBuffer[index + 3]\n    );\n  }\n  /**\n   * Set pxl color at (i,j)\n   * @param {Number} i: integer \\in [0,H-1]\n   * @param {Number} j: integer \\in [0,W-1]\n   * @param {Color} color\n   */\n  setPxl(i, j, color) {\n    const { width, height } = this.canvas;\n    if (i < 0 || i >= height || j < 0 || j >= width) return this;\n    const index = 4 * (i * width + j);\n    this.data[index] = color.red;\n    this.data[index + 1] = color.green;\n    this.data[index + 2] = color.blue;\n    this.data[index + 3] = color.alpha;\n    return this;\n  }\n\n  /**\n   *\n   * @param {Array<Number>} start: 2-Array\n   * @param {Array<Number>} end: 2-Array\n   * @param {Canvas}\n   */\n  drawLine(start, end, shader = (x, y) => Color.ofRGBA(0, 0, 0)) {\n    // faster than using vec2\n    const { width, _ } = this.canvas;\n    const line = this._clipLine(start, end).map((x) => x.toArray());\n    if (line.length === 0) return;\n    const [p0, p1] = line;\n    const v = [p1[0] - p0[0], p1[1] - p0[1]];\n    const n = Math.abs(v[0]) + Math.abs(v[1]);\n    for (let k = 0; k < n; k++) {\n      const s = k / n;\n      const x = [p0[0] + v[0] * s, p0[1] + v[1] * s].map(Math.floor);\n      const [i, j] = x;\n      const index = 4 * (i * width + j);\n      const color = shader(i, j);\n      this.data[index] = color.red;\n      this.data[index + 1] = color.green;\n      this.data[index + 2] = color.blue;\n      this.data[index + 3] = color.alpha;\n    }\n    return this;\n  }\n\n  /**\n   *\n   * @param {Array<Number>} p0 : 2-array<number>\n   * @param {Array<Number>} p1 : 2-array<number>\n   * @param {Array<Number>} p2 : 2-array<number>\n   * @param {(Number, Number) => Color} shader : (number, number) => Color\n   * @returns\n   */\n  drawTriangle(p0, p1, p2, shader = (x, y) => Color.ofRGBA(0, 0, 0)) {\n    return this._drawConvexPolygon([p0, p1, p2], shader);\n  }\n\n  paint() {\n    this.ctx.putImageData(this.image, 0, 0);\n  }\n\n  //========================================================================================\n  /*                                                                                      *\n   *                                  Auxiliary functions                                  *\n   *                                                                                      */\n  //========================================================================================\n\n  /**\n   *\n   * @param {*} arrayOfPoints : Array<2-Array<Number>>\n   * @param {*} shader : (x,y) => color\n   * @returns\n   */\n  _drawConvexPolygon(arrayOfPoints, shader) {\n    const { width, height } = this.canvas;\n    const canvasBox = new BBox(vec2.ZERO, vec2.of(height, width));\n    let boundingBox = BBox.EMPTY;\n    arrayOfPoints.forEach((x) => {\n      boundingBox = boundingBox.add(BBox.ofPoint(...x));\n    });\n    const finalBox = canvasBox.inter(boundingBox);\n    const [xMin, yMin] = finalBox.min.toArray();\n    const [xMax, yMax] = finalBox.max.toArray();\n\n    for (let i = xMin; i < xMax; i++) {\n      for (let j = yMin; j < yMax; j++) {\n        if (this._isInsideConvex([i, j], arrayOfPoints)) {\n          const color = shader(i, j);\n          const index = 4 * (i * width + j);\n          this.data[index] = color.red;\n          this.data[index + 1] = color.green;\n          this.data[index + 2] = color.blue;\n          this.data[index + 3] = color.alpha;\n        }\n      }\n    }\n    return this;\n  }\n\n  /**\n   *\n   * @param {*} x: 2-Array<Number>\n   * @param {*} points: Array<2-Array<Number>>\n   * @returns\n   */\n  _isInsideConvex(x, points) {\n    const m = points.length;\n    const v = [];\n    const vDotN = [];\n    for (let i = 0; i < m; i++) {\n      const p1 = points[(i + 1) % m];\n      const p0 = points[i];\n      v[i] = [p1[0] - p0[0], p1[1] - p0[1]];\n      const vi = v[i];\n      const n = [-vi[1], vi[0]];\n      const r = [x[0] - p0[0], x[1] - p0[1]];\n      vDotN[i] = r[0] * n[0] + r[1] * n[1];\n    }\n    let orientation = v[0][0] * v[1][1] - v[0][1] * v[1][0] >= 0 ? 1 : -1;\n    for (let i = 0; i < m; i++) {\n      const myDot = vDotN[i] * orientation;\n      if (myDot < 0) return false;\n    }\n    return true;\n  }\n\n  /**\n   *\n   * @param {*} start: 2-Array<Number>\n   * @param {*} end: 2-Array<Number>\n   * @returns 2-Array<2-Array<Number>>\n   */\n  _clipLine(start, end) {\n    const { width, height } = this.canvas;\n    const bbox = new BBox(vec2.ZERO, vec2.of(height, width));\n    const pointStack = [start, end].map((x) => vec2.of(...x));\n    const inStack = [];\n    const outStack = [];\n    for (let i = 0; i < pointStack.length; i++) {\n      const p = pointStack[i];\n      if (bbox.collidesWith(p)) {\n        inStack.push(p);\n      } else {\n        outStack.push(p);\n      }\n    }\n    // both points are inside\n    if (inStack.length >= 2) {\n      return inStack;\n    }\n    // one of them is inside\n    if (inStack.length === 1) {\n      const [inPoint] = inStack;\n      const [outPoint] = outStack;\n      return [inPoint, ...this._getLineCanvasIntersection(inPoint, outPoint)];\n    }\n    // both points are outside,need to intersect the boundary\n    return this._getLineCanvasIntersection(...outStack);\n  }\n\n  /**\n   *\n   * @param {*} start: vec2(matrix)\n   * @param {*} end: vec2(matrix)\n   */\n  _getLineCanvasIntersection(start, end) {\n    const { width, height } = this.canvas;\n    const v = end.sub(start);\n    // point and direction of boundary\n    const boundary = [\n      [vec2.ZERO, vec2.of(height, 0)],\n      [vec2.of(height, 0), vec2.of(0, width)],\n      [vec2.of(height, width), vec2.of(-height, 0)],\n      [vec2.of(0, width), vec2.of(0, -width)],\n    ];\n    const intersectionSolutions = [];\n    boundary.forEach(([s, d]) => {\n      if (d.get(0) === 0) {\n        const solution = this._solveLowTriMatrix(v, -d.get(1), s.sub(start));\n        solution !== undefined && intersectionSolutions.push(solution);\n      } else {\n        const solution = this._solveUpTriMatrix(v, -d.get(0), s.sub(start));\n        solution !== undefined && intersectionSolutions.push(solution);\n      }\n    });\n    const validIntersections = [];\n    intersectionSolutions.forEach((solution) => {\n      const [x, y] = [solution.get(0), solution.get(1)];\n      if (0 <= x && x <= 1 && 0 <= y && y <= 1) {\n        validIntersections.push(solution);\n      }\n    });\n    if (validIntersections.length === 0) return [];\n    return validIntersections.map((solution) => {\n      const t = solution.get(0);\n      return start.add(v.scale(t));\n    });\n  }\n\n  /**\n   *\n   * @param {*} v: vec2\n   * @param {*} a: number\n   * @param {*} f: vec2\n   * @returns vec2\n   */\n  _solveLowTriMatrix(v, a, f) {\n    const v1 = v.get(0);\n    const v2 = v.get(1);\n    const av1 = a * v1;\n    if (av1 === 0 || v1 === 0) return undefined;\n    const f1 = f.get(0);\n    const f2 = f.get(1);\n    return vec2.of(f1 / v1, (f2 * v1 - v2 * f1) / av1);\n  }\n\n  /**\n   *\n   * @param {*} v: vec2\n   * @param {*} a: number\n   * @param {*} f: vec2\n   * @returns vec2\n   */\n  _solveUpTriMatrix(v, a, f) {\n    const v1 = v.get(0);\n    const v2 = v.get(1);\n    const av2 = a * v2;\n    if (av2 === 0 || v2 === 0) return undefined;\n    const f1 = f.get(0);\n    const f2 = f.get(1);\n    return vec2.of(f2 / v2, (f1 * v2 - v1 * f2) / av2);\n  }\n\n  //========================================================================================\n  /*                                                                                      *\n   *                                   Static functions                                   *\n   *                                                                                      */\n  //========================================================================================\n\n  static builder() {\n    return new CanvasBuilder();\n  }\n}\n\nexport class CanvasBuilder {\n  _canvas = document.createElement(\"canvas\");\n  _width = 500;\n  _height = 500;\n  constructor() {}\n\n  width(width = this._width) {\n    this._width = width;\n    return this;\n  }\n\n  height(height = this._height) {\n    this._height = height;\n    return this;\n  }\n\n  build() {\n    this._canvas.setAttribute(\"width\", this._width);\n    this._canvas.setAttribute(\"height\", this._height);\n    return new Canvas(this._canvas);\n  }\n}\n","export const perf = (lambda) => {\n  const t = performance.now();\n  lambda();\n  return performance.now() - t;\n};\n\n/**\n *\n * @param {*} canvasBuilder : () => canvas\n * @returns\n */\nexport const testBuilder =\n  (canvasBuilder = canvasFactory) =>\n  /**\n   * Unit test maker\n   * @param {*} title\n   * @param {*} lambda: (canvas) => {}\n   */\n  (title, lambda = () => {}) => {\n    let canvas = canvasBuilder();\n    const timeInMillis = perf(() => lambda(canvas));\n    const domTest = document.createElement(\"div\");\n    const testTitle = document.createElement(\"h3\");\n    testTitle.innerText = title;\n    domTest.appendChild(testTitle);\n    domTest.appendChild(canvas.getDom());\n    const timeDom = document.createElement(\"h4\");\n    timeDom.innerText = `Test took ${timeInMillis}ms`;\n    domTest.appendChild(timeDom);\n    document.body.appendChild(domTest);\n  };\n\nconst canvasFactory = () => Canvas.builder().width(500).height(500).build();\n","export default class Animator {\n  constructor(state, next, doWhile) {\n    this.state = state;\n    this.next = next;\n    this.while = doWhile;\n    this.requestAnimeId = null;\n  }\n\n  play() {\n    this.requestAnimeId = requestAnimationFrame(() => {\n      if (!this.while(this.state)) return this.stop();\n      this.state = this.next(this.state);\n      this.play();\n    });\n    return this;\n  }\n\n  run() {\n    while (this.while(this.state)) {\n      this.state = this.next(this.state);\n    }\n    return this;\n  }\n\n  stop() {\n    cancelAnimationFrame(this.requestAnimeId);\n    return this;\n  }\n\n  static builder() {\n    return new AnimatorBuilder();\n  }\n}\n\nclass AnimatorBuilder {\n  constructor() {\n    this._state = null;\n    this._next = null;\n    this._end = null;\n  }\n\n  initialState(state) {\n    this._state = state;\n    return this;\n  }\n\n  nextState(next) {\n    this._next = next;\n    return this;\n  }\n\n  while(end) {\n    this._end = end;\n    return this;\n  }\n\n  build() {\n    const someAreEmpty = [this._state, this._next, this._end].some(\n      (x) => x === null || x === undefined\n    );\n    if (someAreEmpty) throw new Error(\"Animator properties are missing\");\n    return new Animator(this._state, this._next, this._end);\n  }\n}\n","import superPropBase from \"./superPropBase.js\";\nexport default function _get(target, property, receiver) {\n  if (typeof Reflect !== \"undefined\" && Reflect.get) {\n    _get = Reflect.get;\n  } else {\n    _get = function _get(target, property, receiver) {\n      var base = superPropBase(target, property);\n      if (!base) return;\n      var desc = Object.getOwnPropertyDescriptor(base, property);\n\n      if (desc.get) {\n        return desc.get.call(receiver);\n      }\n\n      return desc.value;\n    };\n  }\n\n  return _get(target, property, receiver || target);\n}","import getPrototypeOf from \"./getPrototypeOf.js\";\nexport default function _superPropBase(object, property) {\n  while (!Object.prototype.hasOwnProperty.call(object, property)) {\n    object = getPrototypeOf(object);\n    if (object === null) break;\n  }\n\n  return object;\n}","import BBox from \"../../BBox/main/BBox\";\nimport Canvas, { CanvasBuilder } from \"../../Canvas/main/Canvas\";\nimport Matrix from \"../../Matrix/main/Matrix\";\nconst { vec2 } = Matrix;\n\nexport default class Canvas2d extends Canvas {\n  constructor(canvas, camera) {\n    super(canvas);\n    this.camera = camera;\n  }\n\n  setCamera(bbox) {\n    this.camera = bbox;\n  }\n\n  map(lambda = () => {}) {\n    return super.map((c, i, j) => {\n      const [x, y] = this.forwardCoord(i, j);\n      return lambda(c, x, y);\n    });\n  }\n\n  getPxl(x, y) {\n    const [i, j] = this.inverseCoord(x, y);\n    return super.getPxl(i, j);\n  }\n\n  setPxl(x, y, color) {\n    const [i, j] = this.inverseCoord(x, y);\n    return super.setPxl(i, j, color);\n  }\n\n  drawLine(start, end, shader) {\n    const startPos = this.inverseCoord(...start);\n    const endPos = this.inverseCoord(...end);\n    return super.drawLine(startPos, endPos, shader);\n  }\n\n  drawTriangle(p0, p1, p2, shader) {\n    const q0 = this.inverseCoord(...p0);\n    const q1 = this.inverseCoord(...p1);\n    const q2 = this.inverseCoord(...p2);\n    return super.drawTriangle(q0, q1, q2, shader);\n  }\n\n  /**\n   * Map from camera coord to canvas coord\n   */\n  inverseCoord(x, y) {\n    const { min, max } = this.camera;\n    const { width, height } = this.canvas;\n    const [minX, minY] = min.data;\n    const [maxX, maxY] = max.data;\n    return [\n      (-(y - maxY) * (height - 1)) / (maxY - minY),\n      ((x - minX) * (width - 1)) / (maxX - minX),\n    ].map(Math.floor);\n  }\n\n  /**\n   * Map from canvas coord to camera coord\n   */\n  forwardCoord(i, j) {\n    const { min, max } = this.camera;\n    const { width, height } = this.canvas;\n    const [minX, minY] = min.data;\n    const [maxX, maxY] = max.data;\n    return [\n      minX + ((maxX - minX) * j) / (width - 1),\n      maxY + ((minY - maxY) * i) / (height - 1),\n    ];\n  }\n\n  static builder() {\n    return new Canvas2dBuilder();\n  }\n}\n\nexport class Canvas2dBuilder extends CanvasBuilder {\n  _camera = new BBox(vec2.of(-1, -1), vec2.of(1, 1));\n\n  camera(bbox = this._camera) {\n    this._camera = bbox;\n    return this;\n  }\n\n  build() {\n    const canvasBase = super.build();\n    return new Canvas2d(canvasBase.canvas, this._camera);\n  }\n}\n"],"sourceRoot":""}