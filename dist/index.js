!function(t,e){"object"==typeof exports&&"object"==typeof module?module.exports=e():"function"==typeof define&&define.amd?define([],e):"object"==typeof exports?exports.Tela=e():t.Tela=e()}(window,(function(){return function(t){var e={};function n(r){if(e[r])return e[r].exports;var i=e[r]={i:r,l:!1,exports:{}};return t[r].call(i.exports,i,i.exports,n),i.l=!0,i.exports}return n.m=t,n.c=e,n.d=function(t,e,r){n.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:r})},n.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},n.t=function(t,e){if(1&e&&(t=n(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var r=Object.create(null);if(n.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var i in t)n.d(r,i,function(e){return t[e]}.bind(null,i));return r},n.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return n.d(e,"a",e),e},n.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},n.p="",n(n.s=1)}([function(t,e){function n(e){return"function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?(t.exports=n=function(t){return typeof t},t.exports.default=t.exports,t.exports.__esModule=!0):(t.exports=n=function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},t.exports.default=t.exports,t.exports.__esModule=!0),n(e)}t.exports=n,t.exports.default=t.exports,t.exports.__esModule=!0},function(t,e,n){"use strict";n.r(e),n.d(e,"Canvas_old",(function(){return y})),n.d(e,"Canvas2D_old",(function(){return b})),n.d(e,"ImageIO",(function(){return a})),n.d(e,"Canvas",(function(){return D})),n.d(e,"Color",(function(){return E})),n.d(e,"Utils",(function(){return r})),n.d(e,"Animator",(function(){return U})),n.d(e,"Matrix",(function(){return rt}));var r={};n.r(r),n.d(r,"perf",(function(){return F})),n.d(r,"test",(function(){return N}));var i={getImageCanvas:function(t){var e=document.createElement("canvas");e.width=t.width,e.height=t.height;var n=e.getContext("2d");return n.fillStyle="rgba(0, 0, 0, 0)",n.globalCompositeOperation="source-over",n.fillRect(0,0,e.width,e.height),n.drawImage(t,0,0),e},getDataFromImage:function(t){return canvas=i.getImageCanvas(t),canvas.getContext("2d").getImageData(0,0,t.width,t.height)},loadImage:function(t){var e=new Image;return e.src=t,e.isReady=!1,e.onload=function(){return e.isReady=!0},e},generateImageReadyPredicate:function(t){return function(){return t.isReady}}},a=i;function o(t,e){var n=[];return n[0]=t[0]+e[0],n[1]=t[1]+e[1],n}function u(t){var e=[];return e[0]=Math.floor(t[0]),e[1]=Math.floor(t[1]),e}function s(t,e){var n=[];return n[0]=t[0]-e[0],n[1]=t[1]-e[1],n}function c(t,e){return t[0]*e[0]+t[1]*e[1]}function h(t){return c(t,t)}function f(t){return Math.sqrt(c(t,t))}function l(t,e){var n=[];return n[0]=Math.min(t[0],e[0]),n[1]=Math.min(t[1],e[1]),n}function d(t,e){var n=[];return n[0]=Math.max(t[0],e[0]),n[1]=Math.max(t[1],e[1]),n}function p(t,e,n){var r=n[1]/t[1];return[r,(-t[0]*r+n[0])/e]}function v(t,e,n){var r=n[0]/t[0];return[r,(-t[1]*r+n[1])/e]}var g,m=function(t){this.canvas=t,this.ctx=t.getContext("2d"),this.image=this.ctx.getImageData(0,0,t.width,t.height),this.imageData=this.image.data};m.prototype.getSize=function(){return[this.canvas.height,this.canvas.width]},m.prototype.paintImage=function(){this.ctx.putImageData(this.image,0,0)},m.prototype.getCanvas=function(){return this.canvas},m.prototype.clearImage=function(t){this.useCanvasCtx((function(e){var n=e.getSize();e.ctx.fillStyle="rgba("+t[0]+","+t[1]+","+t[2]+","+t[3]+")",e.ctx.globalCompositeOperation="source-over",e.ctx.fillRect(0,0,n[1],n[0])}),!0)},m.prototype.useCanvasCtx=function(t){var e=arguments.length>1&&void 0!==arguments[1]&&arguments[1];e||this.ctx.putImageData(this.image,0,0),t(this),this.image=this.ctx.getImageData(0,0,this.canvas.width,this.canvas.height),this.imageData=this.image.data},m.prototype.getImageIndex=function(t){return 4*(this.canvas.width*t[0]+t[1])},m.prototype.getPxl=function(t){var e=this.getImageIndex(t);return[this.imageData[e],this.imageData[e+1],this.imageData[e+2],this.imageData[e+3]]},m.prototype.drawPxl=function(t,e){var n=this.getImageIndex(t);this.imageData[n]=e[0],this.imageData[n+1]=e[1],this.imageData[n+2]=e[2],this.imageData[n+3]=e[3]},m.prototype.drawLine=function(t,e,n){n.points=[t,e];var r=[];r.push(t),r.push(e);for(var i=[],a=[],o=0;o<r.length;o++){0<=(l=r[o])[0]&&l[0]<this.canvas.height&&0<=l[1]&&l[1]<this.canvas.width?i.push(l):a.push(l)}if(2!=i.length){var u=[],h=[e[0]-t[0],e[1]-t[1]];u.push(p(h,-(this.canvas.height-1),[-t[0],-t[1]])),u.push(v(h,-(this.canvas.width-1),[this.canvas.height-1-t[0],-t[1]])),u.push(p(h,this.canvas.height-1,[this.canvas.height-1-t[0],this.canvas.width-1-t[1]])),u.push(v(h,this.canvas.width-1,[-t[0],this.canvas.width-1-t[1]]));var f=[];for(o=0;o<u.length;o++){var l;0<=(l=u[o])[0]&&l[0]<=1&&0<=l[1]&&l[1]<=1&&f.push(l)}if(0!=f.length)if(i.length>0){var d=[t[0]+f[0][0]*h[0],t[1]+f[0][0]*h[1]];this.drawLineInt(i.pop(),d,n)}else{var g=[t[0]+f[0][0]*h[0],t[1]+f[0][0]*h[1]];for(o=1;o<f.length;o++){if(c(h=s(d=[t[0]+f[o][0]*h[0],t[1]+f[o][0]*h[1]],g),h)>.001)return void this.drawLineInt(g,d,n)}this.drawLineInt(g,g,n)}}else this.drawLineInt(i[0],i[1],n)},m.prototype.drawLineInt=function(t,e,n){t=u(t),e=u(e);var r=[-1,0,1],i=r.length,a=i*i,h=[];h[0]=t[0],h[1]=t[1];var f=s(e,t),l=[];for(l[0]=-f[1],l[1]=f[0],n(h,n.points,this);h[0]!==e[0]||h[1]!==e[1];){for(var d=Number.MAX_VALUE,p=[],v=0;v<a;v++){var g=r[v%i],m=r[Math.floor(v/i)],y=s(o(h,[g,m]),t),w=Math.abs(c(y,l))-c(y,f);d>w&&(d=w,p=[g,m])}n(h=o(h,p),n.points,this)}n(h,n.points,this)},m.prototype.drawPolygon=function(t,e){for(var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:m.isInsidePolygon,r=[[Number.MAX_VALUE,Number.MAX_VALUE],[Number.MIN_VALUE,Number.MIN_VALUE]],i=0;i<t.length;i++)r[0]=l(t[i],r[0]),r[1]=d(t[i],r[1]);var a=this.getSize(),o=s(a,[1,1]),c=[0,0];r[0]=u(l(o,d(c,r[0]))),r[1]=u(l(o,d(c,r[1])));for(var h=r[0][0];h<r[1][0];h++)for(var f=r[0][1];f<r[1][1];f++){var p=[h,f];n(p,t)&&e(p,t,this)}},m.prototype.drawTriangle=function(t,e,n,r){var i=[t,e,n];this.drawPolygon(i,r,m.isInsideConvex)},m.prototype.drawQuad=function(t,e,n,r,i){this.drawPolygon([t,e,n,r],i)},m.prototype.drawImage=function(t,e){"isReady"in t&&!t.isReady||this.useCanvasCtx((function(n){return n.ctx.drawImage(t,e[1],e[0])}))},m.prototype.drawCircle=function(t,e,n){var r=function(t,e){var n=[];return n[0]=t[0]*e,n[1]=t[1]*e,n}([1,1],e),i=[s(t,r),o(t,r)],a=this.getSize();i[0]=u(l(s(a,[1,1]),d([0,0],i[0]))),i[1]=u(l(s(a,[1,1]),d([0,0],i[1])));for(var c=i[0][0];c<=i[1][0];c++)for(var h=i[0][1];h<=i[1][1];h++){var f=[c,h];this.isInsideCircle(f,t,e)&&n(f,[t,e],this)}},m.prototype.isInsideCircle=function(t,e,n){return h(s(t,e))<=n*n},m.prototype.addEventListener=function(t,e,n){this.canvas.addEventListener(t,e,n)},m.prototype.drawString=function(t,e,n){this.useCanvasCtx((function(r){n(r.ctx),r.ctx.fillText(e,t[1],t[0])}))},m.isInsidePolygon=function(t,e){for(var n=[],r=0,i=e.length,a=0;a<i;a++)n[0]=s(e[(a+1)%i],t),n[1]=s(e[a],t),r+=Math.acos(c(n[0],n[1])/(f(n[0])*f(n[1])));return Math.abs(r-2*Math.PI)<.001},m.isInsideConvex=function(t,e){for(var n=e.length,r=[],i=[],a=0;a<n;a++){r[a]=s(e[(a+1)%n],e[a]);var o=[-r[a][1],r[a][0]],u=s(t,e[a]);i[a]=c(u,o)}var h=r[0][0]*r[1][1]-r[0][1]*r[1][0]>0?1:-1;for(a=0;a<n;a++){if(i[a]*h<0)return!1}return!0},m.simpleShader=function(t){return function(e,n,r){return r.drawPxl(e,t)}},m.colorShader=function(t){return m.interpolateTriangleShader((function(e,n,r,i){for(var a=[0,0,0,0],o=0;o<n.length;o++)a[0]=a[0]+t[o][0]*i[o],a[1]=a[1]+t[o][1]*i[o],a[2]=a[2]+t[o][2]*i[o],a[3]=a[3]+t[o][3]*i[o];r.drawPxl(e,a)}))},m.interpolateQuadShader=function(t){return function(e,n,r){var i=[n[0],n[1],n[2]],a=[n[2],n[3],n[0]],o=m.triangleBaryCoord(e,i);o[0]>0&&o[1]>0&&o[2]>0&&Math.abs(o[0]+o[1]+o[2]-1)<1e-10?t(e,n,r,[o[0],o[1],o[2],0]):(o=m.triangleBaryCoord(e,a),t(e,n,r,[o[2],0,o[0],o[1]]))}},m.interpolateTriangleShader=function(t){return function(e,n,r){var i=m.triangleBaryCoord(e,n);t(e,n,r,i)}},m.interpolateLineShader=function(t){return function(e,n,r){var i=s(n[1],n[0]),a=s(e,n[0]),o=h(i),u=c(a,i);t(e,n,r,0==o?0:u/o)}},m.quadTextureShader=function(t,e){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:m.bilinearInterpolation,r=null,i=function(i,c,h,f){t.isReady&&null!=r||(r=new m(a.getImageCanvas(t)));for(var p=r,v=p.getSize(),g=[0,0],y=0;y<e.length;y++)g[0]=g[0]+e[y][0]*f[y],g[1]=g[1]+e[y][1]*f[y];var w=[(1-g[1])*(v[1]-1),(v[0]-1)*g[0]],b=u(w=d([0,0],l(s([v[0],v[1]],[1,1]),w))),x=[p.getPxl(b),p.getPxl(o(b,[1,0])),p.getPxl(o(b,[1,1])),p.getPxl(o(b,[0,1]))],S=n(x,s(w,b));h.drawPxl(i,S)};return m.interpolateQuadShader(i)},m.triangleCache=(g=[],{constains:function(t){return null!=g[t%3]},get:function(t){return g[t%3]},set:function(t,e){return g[t%3]=e}}),m.triangleHash=function(t){return[t[0][0],t[1][0],t[2][0],t[0][1],t[1][1],t[2][1]].reduce((function(t,e){return 31*t+e}),1)},m.triangleBaryCoord=function(t,e){var n=m.triangleHash(e),r=[t[0]-e[0][0],t[1]-e[0][1]];if(!m.triangleCache.constains(n)){var i=[e[1][0]-e[0][0],e[1][1]-e[0][1]],a=[e[2][0]-e[0][0],e[2][1]-e[0][1]],o=i[0]*a[1]-i[1]*a[0];m.triangleCache.set(n,{triangle:e,u:i.map((function(t){return t/o})),v:a.map((function(t){return t/o})),det:o,hash:n})}var u=m.triangleCache.get(n),s=u.u,c=u.v;if(0==u.det)return[0,0,0];var h=[c[1]*r[0]-c[0]*r[1],s[0]*r[1]-s[1]*r[0]];return[1-h[0]-h[1],h[0],h[1]]},m.bilinearInterpolation=function(t,e){for(var n=[],r=0;r<t.length;r++){var i=t[0][r]+(t[3][r]-t[0][r])*e[1],a=i+(t[1][r]+(t[2][r]-t[1][r])*e[1]-i)*e[0];n.push(a)}return n},m.createCanvas=function(t,e){var n=document.createElement("canvas");return n.setAttribute("width",t[0]),n.setAttribute("height",t[1]),document.getElementById(e).appendChild(n),n};var y=m,w=function(t,e){if(y.call(this,t),2!=e.length||2!=e[0].length&&2!=e[1].length)throw"camera space must be 2-dim array with 2-dim arrays representing an interval";this.cameraSpace=e};(w.prototype=Object.create(y.prototype)).constructor=w,w.prototype.integerTransform=function(t){return[-(this.canvas.height-1)/(this.cameraSpace[1][1]-this.cameraSpace[1][0])*(t[1]-this.cameraSpace[1][1]),(this.canvas.width-1)/(this.cameraSpace[0][1]-this.cameraSpace[0][0])*(t[0]-this.cameraSpace[0][0])]},w.prototype.inverseTransform=function(t){return[this.cameraSpace[0][0]+(this.cameraSpace[0][1]-this.cameraSpace[0][0])/(this.canvas.width-1)*t[1],this.cameraSpace[1][1]-(this.cameraSpace[1][1]-this.cameraSpace[1][0])/(this.canvas.height-1)*t[0]]},w.prototype.drawLine=function(t,e,n){var r=this.integerTransform(t),i=this.integerTransform(e);y.prototype.drawLine.call(this,r,i,n)},w.prototype.drawTriangle=function(t,e,n,r){var i=this.integerTransform(t),a=this.integerTransform(e),o=this.integerTransform(n);y.prototype.drawTriangle.call(this,i,a,o,r)},w.prototype.drawQuad=function(t,e,n,r,i){var a=this.integerTransform(t),o=this.integerTransform(e),u=this.integerTransform(n),s=this.integerTransform(r);y.prototype.drawQuad.call(this,a,o,u,s,i)},w.prototype.drawCircle=function(t,e,n){var r=this.integerTransform(t),i=this.integerTransform([e,0])[1]-this.integerTransform([0,0])[1];y.prototype.drawCircle.call(this,r,i,n)},w.prototype.drawImage=function(t,e){y.prototype.drawImage.call(this,t,this.integerTransform(e))},w.prototype.drawString=function(t,e,n){var r=this.integerTransform(t);y.prototype.drawString.call(this,r,e,n)},w.prototype.setCamera=function(t){if(2!=t.length||2!=t[0].length&&2!=t[1].length)throw"camera space must be 2-dim array with 2-dim arrays representing an interval";this.cameraSpace=t};var b=w;function x(t,e){return(x=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function S(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&x(t,e)}var I=n(0),_=n.n(I);function C(t,e){return!e||"object"!==_()(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function k(t){return(k=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function A(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}function B(t,e,n){return(B=A()?Reflect.construct:function(t,e,n){var r=[null];r.push.apply(r,e);var i=new(Function.bind.apply(t,r));return n&&x(i,n.prototype),i}).apply(null,arguments)}function T(t){var e="function"==typeof Map?new Map:void 0;return(T=function(t){if(null===t||(n=t,-1===Function.toString.call(n).indexOf("[native code]")))return t;var n;if("function"!=typeof t)throw new TypeError("Super expression must either be null or a function");if(void 0!==e){if(e.has(t))return e.get(t);e.set(t,r)}function r(){return B(t,arguments,k(this).constructor)}return r.prototype=Object.create(t.prototype,{constructor:{value:r,enumerable:!1,writable:!0,configurable:!0}}),x(r,t)})(t)}function R(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function M(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function P(t,e,n){return e&&M(t.prototype,e),n&&M(t,n),t}function O(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}var E=function(){function t(e){R(this,t),this.rgba=e}return P(t,[{key:"getRGBA",value:function(){return this.rgba}},{key:"red",get:function(){return this.rgba[0]}},{key:"green",get:function(){return this.rgba[1]}},{key:"blue",get:function(){return this.rgba[2]}},{key:"alpha",get:function(){return this.rgba[3]}}],[{key:"ofRGBA",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:255,a=new Uint8Array(4);return a[0]=e,a[1]=n,a[2]=r,a[3]=i,new t(a)}},{key:"random",value:function(){var e=function(){return 256*Math.random()};return t.ofRGBA(e(),e(),e(),e())}}]),t}();function j(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=k(t);if(e){var i=k(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return C(this,n)}}var D=function(){function t(e){R(this,t),O(this,"getDom",this.getCanvas),this.canvas=e,this.ctx=e.getContext("2d"),this.image=this.ctx.getImageData(0,0,e.width,e.height),this.imgBuffer=this.image.data}return P(t,[{key:"getCanvas",value:function(){return this.canvas}},{key:"fill",value:function(t){return this.ctx.fillStyle="rgba(".concat(t.red,", ").concat(t.green,", ").concat(t.blue,", ").concat(t.alpha/255,")"),this.ctx.fillRect(0,0,this.canvas.width,this.canvas.height),this.image=this.ctx.getImageData(0,0,this.canvas.width,this.canvas.height),this.imgBuffer=this.image.data,this}},{key:"map",value:function(){for(var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:function(){},e=this.imgBuffer.length,n=this.canvas.width,r=0;r<e;r+=4){var i=Math.floor(r/(4*n)),a=Math.floor(r/4)%n,o=t(E.ofRGBA(this.imgBuffer[r],this.imgBuffer[r+1],this.imgBuffer[r+2],this.imgBuffer[r+3]),i,a);this.imgBuffer[r]=o.red,this.imgBuffer[r+1]=o.green,this.imgBuffer[r+2]=o.blue,this.imgBuffer[r+3]=o.alpha}return this}},{key:"getPxl",value:function(t,e){var n=this.canvas,r=n.width,i=n.height;if((t<0||t>=i)&&(e<0||e>=r))return new z("pxl out of bounds");var a=t*(4*r)+4*e;return E.ofRGBA(this.imgBuffer[a],this.imgBuffer[a+1],this.imgBuffer[a+2],this.imgBuffer[a+3])}},{key:"setPxl",value:function(t,e,n){var r=this.canvas,i=r.width,a=r.height;if(!(t<0||t>=a)||!(e<0||e>=i)){var o=t*(4*i)+4*e;return this.imgBuffer[o]=n.red,this.imgBuffer[o+1]=n.green,this.imgBuffer[o+2]=n.blue,this.imgBuffer[o+3]=n.alpha,this}}},{key:"drawLine",value:function(){}},{key:"paint",value:function(){this.ctx.putImageData(this.image,0,0)}}],[{key:"builder",value:function(){return new L}}]),t}(),L=function(){function t(){R(this,t),O(this,"_canvas",document.createElement("canvas")),O(this,"_width",500),O(this,"_height",500)}return P(t,[{key:"width",value:function(t){return this._width=t,this}},{key:"height",value:function(t){return this._height=t,this}},{key:"build",value:function(){return this._canvas.setAttribute("width",this._width),this._canvas.setAttribute("height",this._height),new D(this._canvas)}}]),t}(),z=function(t){S(n,t);var e=j(n);function n(){return R(this,n),e.apply(this,arguments)}return n}(T(Error)),F=function(t){var e=performance.now();return t(),performance.now()-e};function N(t){var e,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:function(){},r=function(t,n){return e=Canvas.builder().width(t).height(n).build()},i=F((function(){return n(r)})),a=document.createElement("div"),o=document.createElement("h3");o.innerText=t,a.appendChild(o),a.appendChild(e.getDom());var u=document.createElement("h4");u.innerText="Test took ".concat(i,"ms"),a.appendChild(u),document.body.appendChild(a)}var U=function(){function t(e,n,r){R(this,t),this.state=e,this.next=n,this.while=r,this.requestAnimeId=null}return P(t,[{key:"play",value:function(){var t=this;return this.requestAnimeId=requestAnimationFrame((function(){if(!t.while(t.state))return t.stop();t.state=t.next(t.state),t.play()})),this}},{key:"stop",value:function(){return cancelAnimationFrame(this.requestAnimeId),this}}],[{key:"builder",value:function(){return new q}}]),t}(),q=function(){function t(){R(this,t),this._state=null,this._next=null,this._end=null}return P(t,[{key:"initialState",value:function(t){return this._state=t,this}},{key:"nextState",value:function(t){return this._next=t,this}},{key:"while",value:function(t){return this._end=t,this}},{key:"build",value:function(){if([this._state,this._next,this._end].some((function(t){return null==t})))throw new Error("Animator properties are missing");return new U(this._state,this._next,this._end)}}]),t}();function G(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}function Q(t,e){if(t){if("string"==typeof t)return G(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?G(t,e):void 0}}function V(t){return function(t){if(Array.isArray(t))return G(t)}(t)||function(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(t)||Q(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function X(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){var n=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null!=n){var r,i,a=[],o=!0,u=!1;try{for(n=n.call(t);!(o=(r=n.next()).done)&&(a.push(r.value),!e||a.length!==e);o=!0);}catch(t){u=!0,i=t}finally{try{o||null==n.return||n.return()}finally{if(u)throw i}}return a}}(t,e)||Q(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function H(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=k(t);if(e){var i=k(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return C(this,n)}}function W(t,e,n){if(!e.has(t))throw new TypeError("attempted to get private field on non-instance");return n}var Z=function(t,e){return function(t,n){return n+t*e}},$=function(){function t(){R(this,t),this._size=[],this.data={}}return P(t,[{key:"size",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;return this._size=[t,e],this}},{key:"set",value:function(t,e,n){if(0===this._size.length)throw new it("Setting value to empty matrix");return this.data[function(t,e){return"".concat(t,",").concat(e)}(t,e)]=n,this}},{key:"build",value:function(){var t=this,e=X(this._size,2),n=e[0],r=e[1],i=new Float64Array(n*r),a=Z(0,r);return Object.keys(this.data).forEach((function(e){var n;i[a.apply(void 0,V((n=e,n.split(",").map(Number))))]=t.data[e]})),new rt(i,this._size)}}]),t}(),J=new WeakSet,K=function(){function t(){R(this,t),J.add(this),this.rows=[],this.dim=0}return P(t,[{key:"addRow",value:function(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];if(0===this.dim&&(this.dim=e.length),this.dim!==e.length)throw new it("Added row of different dimension, actual dim is ".concat(this.dim));return this.rows.push(e),this}},{key:"build",value:function(){if(this.rows.length>0)return W(this,J,Y).call(this);throw new it("Building empty matrix")}}]),t}();function Y(){for(var t=this.rows.length,e=this.dim,n=new Float64Array(t*e),r=Z(0,e),i=0;i<t;i++)for(var a=0;a<e;a++)n[r(i,a)]=this.rows[i][a];return new rt(n,[t,e])}var tt=new WeakSet,et=function(){function t(){R(this,t),tt.add(this),this.cols=[],this.dim=0}return P(t,[{key:"addCol",value:function(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];if(0===this.dim&&(this.dim=e.length),this.dim!==e.length)throw new it("Added col of different dimension, actual dim is ".concat(this.dim));return this.cols.push(e),this}},{key:"build",value:function(){if(this.cols.length>0)return W(this,tt,nt).call(this);throw new it("Building empty matrix")}}]),t}();function nt(){for(var t=this.dim,e=this.cols.length,n=new Float64Array(t*e),r=Z(0,e),i=0;i<t;i++)for(var a=0;a<e;a++)n[r(i,a)]=this.cols[a][i];return new rt(n,[t,e])}var rt=function(){function t(e,n){R(this,t),this.data=e,this.shape=n}return P(t,[{key:"rows",get:function(){return this.shape[0]}},{key:"cols",get:function(){return this.shape[1]}},{key:"get",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=X(this.shape,2),r=(n[0],n[1]);return this.data[e+t*r]}},{key:"prod",value:function(e){if(this.cols!==e.rows)throw new it("Incompatible product size. Left ".concat(this.shape,", right ").concat(e.shape));for(var n=this.rows,r=this.cols,i=e.cols,a=new Float64Array(n*i),o=Z(0,i),u=0;u<n;u++)for(var s=0;s<i;s++){for(var c=0,h=0;h<r;h++)c+=this.get(u,h)*e.get(h,s);a[o(u,s)]=c}return new t(a,[n,i])}}],[{key:"ZERO",value:function(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;return t.builder().size(e,n).build()}},{key:"builder",value:function(){return new $}},{key:"rowBuilder",value:function(){return new K}},{key:"colBuilder",value:function(){return new et}},{key:"vec",value:function(){var t;return(t=new et).addCol.apply(t,arguments).build()}},{key:"cov",value:function(){var t;return(t=new K).addRow.apply(t,arguments).build()}}]),t}();O(rt,"e",(function(t){return function(e){return new rt(new Float64Array(t).map((function(t,n){return e===n?1:0})),[t,1])}})),O(rt,"dx",(function(t){return function(e){return new rt(new Float64Array(t).map((function(t,n){return e===n?1:0})),[1,t])}})),O(rt,"vec2",{of:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return rt.vec(t,e)},e0:rt.vec(1,0),e1:rt.vec(0,1)}),O(rt,"vec3",{of:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;return rt.vec(t,e,n)},e0:rt.vec(1,0,0),e1:rt.vec(0,1,0),e2:rt.vec(0,0,1)});var it=function(t){S(n,t);var e=H(n);function n(){return R(this,n),e.apply(this,arguments)}return n}(T(Error))}])}));
//# sourceMappingURL=index.js.map