!function(t){var e={};function n(a){if(e[a])return e[a].exports;var r=e[a]={i:a,l:!1,exports:{}};return t[a].call(r.exports,r,r.exports,n),r.l=!0,r.exports}n.m=t,n.c=e,n.d=function(t,e,a){n.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:a})},n.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},n.t=function(t,e){if(1&e&&(t=n(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var a=Object.create(null);if(n.r(a),Object.defineProperty(a,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var r in t)n.d(a,r,function(e){return t[e]}.bind(null,r));return a},n.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return n.d(e,"a",e),e},n.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},n.p="",n(n.s=0)}([function(t,e,n){"use strict";n.r(e),n.d(e,"Canvas",(function(){return m}));var a={getImageCanvas:function(t){var e=document.createElement("canvas");e.width=t.width,e.height=t.height;var n=e.getContext("2d");return n.fillStyle="rgba(0, 0, 0, 0)",n.globalCompositeOperation="source-over",n.fillRect(0,0,e.width,e.height),n.drawImage(t,0,0),e},getDataFromImage:function(t){return canvas=a.getImageCanvas(t),canvas.getContext("2d").getImageData(0,0,t.width,t.height)},loadImage:function(t){var e=new Image;return e.src=t,e.isReady=!1,e.onload=function(){return e.isReady=!0},e},generateImageReadyPredicate:function(t){return function(){return t.isReady}}},r=a;function i(t,e){var n=[];return n[0]=t[0]+e[0],n[1]=t[1]+e[1],n}function o(t){var e=[];return e[0]=Math.floor(t[0]),e[1]=Math.floor(t[1]),e}function u(t,e){var n=[];return n[0]=t[0]-e[0],n[1]=t[1]-e[1],n}function s(t,e){return t[0]*e[0]+t[1]*e[1]}function h(t){return s(t,t)}function c(t){return Math.sqrt(s(t,t))}function g(t,e){var n=[];return n[0]=Math.min(t[0],e[0]),n[1]=Math.min(t[1],e[1]),n}function f(t,e){var n=[];return n[0]=Math.max(t[0],e[0]),n[1]=Math.max(t[1],e[1]),n}function l(t,e,n){var a=n[1]/t[1];return[a,(-t[0]*a+n[0])/e]}function d(t,e,n){var a=n[0]/t[0];return[a,(-t[1]*a+n[1])/e]}var v,p=function(t){this.canvas=t,this.ctx=t.getContext("2d"),this.image=this.ctx.getImageData(0,0,t.width,t.height),this.imageData=this.image.data};p.prototype.getSize=function(){return[this.canvas.height,this.canvas.width]},p.prototype.paintImage=function(){this.ctx.putImageData(this.image,0,0)},p.prototype.getCanvas=function(){return this.canvas},p.prototype.clearImage=function(t){this.useCanvasCtx((function(e){var n=e.getSize();e.ctx.fillStyle="rgba("+t[0]+","+t[1]+","+t[2]+","+t[3]+")",e.ctx.globalCompositeOperation="source-over",e.ctx.fillRect(0,0,n[1],n[0])}),!0)},p.prototype.useCanvasCtx=function(t){var e=arguments.length>1&&void 0!==arguments[1]&&arguments[1];e||this.ctx.putImageData(this.image,0,0),t(this),this.image=this.ctx.getImageData(0,0,this.canvas.width,this.canvas.height),this.imageData=this.image.data},p.prototype.getImageIndex=function(t){return 4*(this.canvas.width*t[0]+t[1])},p.prototype.getPxl=function(t){var e=this.getImageIndex(t);return[this.imageData[e],this.imageData[e+1],this.imageData[e+2],this.imageData[e+3]]},p.prototype.drawPxl=function(t,e){var n=this.getImageIndex(t);this.imageData[n]=e[0],this.imageData[n+1]=e[1],this.imageData[n+2]=e[2],this.imageData[n+3]=e[3]},p.prototype.drawLine=function(t,e,n){n.points=[t,e];var a=[];a.push(t),a.push(e);for(var r=[],i=[],o=0;o<a.length;o++){0<=(f=a[o])[0]&&f[0]<this.canvas.height&&0<=f[1]&&f[1]<this.canvas.width?r.push(f):i.push(f)}if(2!=r.length){var h=[],c=[e[0]-t[0],e[1]-t[1]];h.push(l(c,-(this.canvas.height-1),[-t[0],-t[1]])),h.push(d(c,-(this.canvas.width-1),[this.canvas.height-1-t[0],-t[1]])),h.push(l(c,this.canvas.height-1,[this.canvas.height-1-t[0],this.canvas.width-1-t[1]])),h.push(d(c,this.canvas.width-1,[-t[0],this.canvas.width-1-t[1]]));var g=[];for(o=0;o<h.length;o++){var f;0<=(f=h[o])[0]&&f[0]<=1&&0<=f[1]&&f[1]<=1&&g.push(f)}if(0!=g.length)if(r.length>0){var v=[t[0]+g[0][0]*c[0],t[1]+g[0][0]*c[1]];this.drawLineInt(r.pop(),v,n)}else{var p=[t[0]+g[0][0]*c[0],t[1]+g[0][0]*c[1]];for(o=1;o<g.length;o++){if(s(c=u(v=[t[0]+g[o][0]*c[0],t[1]+g[o][0]*c[1]],p),c)>.001)return void this.drawLineInt(p,v,n)}this.drawLineInt(p,p,n)}}else this.drawLineInt(r[0],r[1],n)},p.prototype.drawLineInt=function(t,e,n){t=o(t),e=o(e);var a=[-1,0,1],r=a.length,h=r*r,c=[];c[0]=t[0],c[1]=t[1];var g=u(e,t),f=[];for(f[0]=-g[1],f[1]=g[0],n(c,n.points,this);c[0]!==e[0]||c[1]!==e[1];){for(var l=Number.MAX_VALUE,d=[],v=0;v<h;v++){var p=a[v%r],m=a[Math.floor(v/r)],y=u(i(c,[p,m]),t),x=Math.abs(s(y,f))-s(y,g);l>x&&(l=x,d=[p,m])}n(c=i(c,d),n.points,this)}n(c,n.points,this)},p.prototype.drawPolygon=function(t,e){for(var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:p.isInsidePolygon,a=[[Number.MAX_VALUE,Number.MAX_VALUE],[Number.MIN_VALUE,Number.MIN_VALUE]],r=0;r<t.length;r++)a[0]=g(t[r],a[0]),a[1]=f(t[r],a[1]);var i=this.getSize(),s=u(i,[1,1]),h=[0,0];a[0]=o(g(s,f(h,a[0]))),a[1]=o(g(s,f(h,a[1])));for(var c=a[0][0];c<a[1][0];c++)for(var l=a[0][1];l<a[1][1];l++){var d=[c,l];n(d,t)&&e(d,t,this)}},p.prototype.drawTriangle=function(t,e,n,a){var r=[t,e,n];this.drawPolygon(r,a,p.isInsideConvex)},p.prototype.drawQuad=function(t,e,n,a,r){this.drawPolygon([t,e,n,a],r)},p.prototype.drawImage=function(t,e){"isReady"in t&&!t.isReady||this.useCanvasCtx((function(n){return n.ctx.drawImage(t,e[1],e[0])}))},p.prototype.drawCircle=function(t,e,n){var a=function(t,e){var n=[];return n[0]=t[0]*e,n[1]=t[1]*e,n}([1,1],e),r=[u(t,a),i(t,a)],s=this.getSize();r[0]=o(g(u(s,[1,1]),f([0,0],r[0]))),r[1]=o(g(u(s,[1,1]),f([0,0],r[1])));for(var h=r[0][0];h<=r[1][0];h++)for(var c=r[0][1];c<=r[1][1];c++){var l=[h,c];this.isInsideCircle(l,t,e)&&n(l,[t,e],this)}},p.prototype.isInsideCircle=function(t,e,n){return h(u(t,e))<=n*n},p.prototype.addEventListener=function(t,e,n){this.canvas.addEventListener(t,e,n)},p.prototype.drawString=function(t,e,n){this.useCanvasCtx((function(a){n(a.ctx),a.ctx.fillText(e,t[1],t[0])}))},p.isInsidePolygon=function(t,e){for(var n=[],a=0,r=e.length,i=0;i<r;i++)n[0]=u(e[(i+1)%r],t),n[1]=u(e[i],t),a+=Math.acos(s(n[0],n[1])/(c(n[0])*c(n[1])));return Math.abs(a-2*Math.PI)<.001},p.isInsideConvex=function(t,e){for(var n=e.length,a=[],r=[],i=0;i<n;i++){a[i]=u(e[(i+1)%n],e[i]);var o=[-a[i][1],a[i][0]],h=u(t,e[i]);r[i]=s(h,o)}var c=a[0][0]*a[1][1]-a[0][1]*a[1][0]>0?1:-1;for(i=0;i<n;i++){if(r[i]*c<0)return!1}return!0},p.simpleShader=function(t){return function(e,n,a){return a.drawPxl(e,t)}},p.colorShader=function(t){return p.interpolateTriangleShader((function(e,n,a,r){for(var i=[0,0,0,0],o=0;o<n.length;o++)i[0]=i[0]+t[o][0]*r[o],i[1]=i[1]+t[o][1]*r[o],i[2]=i[2]+t[o][2]*r[o],i[3]=i[3]+t[o][3]*r[o];a.drawPxl(e,i)}))},p.interpolateQuadShader=function(t){return function(e,n,a){var r=[n[0],n[1],n[2]],i=[n[2],n[3],n[0]],o=p.triangleBaryCoord(e,r);o[0]>0&&o[1]>0&&o[2]>0&&Math.abs(o[0]+o[1]+o[2]-1)<1e-10?t(e,n,a,[o[0],o[1],o[2],0]):(o=p.triangleBaryCoord(e,i),t(e,n,a,[o[2],0,o[0],o[1]]))}},p.interpolateTriangleShader=function(t){return function(e,n,a){alpha=p.triangleBaryCoord(e,n),t(e,n,a,alpha)}},p.interpolateLineShader=function(t){return function(e,n,a){var r=u(n[1],n[0]),i=u(e,n[0]),o=h(r),c=s(i,r);t(e,n,a,0==o?0:c/o)}},p.quadTextureShader=function(t,e){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:p.bilinearInterpolation,a=null,s=function(s,h,c,l){t.isReady&&null!=a||(a=new p(r.getImageCanvas(t)));for(var d=a,v=d.getSize(),m=[0,0],y=0;y<e.length;y++)m[0]=m[0]+e[y][0]*l[y],m[1]=m[1]+e[y][1]*l[y];var x=[(1-m[1])*(v[1]-1),(v[0]-1)*m[0]],I=o(x=f([0,0],g(u([v[0],v[1]],[1,1]),x))),w=[d.getPxl(I),d.getPxl(i(I,[1,0])),d.getPxl(i(I,[1,1])),d.getPxl(i(I,[0,1]))],C=n(w,u(x,I));c.drawPxl(s,C)};return p.interpolateQuadShader(s)},p.triangleCache=(v=[],{constains:function(t){return null!=v[t%3]},get:function(t){return v[t%3]},set:function(t,e){return v[t%3]=e}}),p.triangleHash=function(t){return[t[0][0],t[1][0],t[2][0],t[0][1],t[1][1],t[2][1]].reduce((function(t,e){return 31*t+e}),1)},p.triangleBaryCoord=function(t,e){var n=p.triangleHash(e),a=[t[0]-e[0][0],t[1]-e[0][1]];if(!p.triangleCache.constains(n)){var r=[e[1][0]-e[0][0],e[1][1]-e[0][1]],i=[e[2][0]-e[0][0],e[2][1]-e[0][1]],o=r[0]*i[1]-r[1]*i[0];p.triangleCache.set(n,{triangle:e,u:r.map((function(t){return t/o})),v:i.map((function(t){return t/o})),det:o,hash:n})}var u=p.triangleCache.get(n),s=u.u,h=u.v;if(0==u.det)return[0,0,0];var c=[h[1]*a[0]-h[0]*a[1],s[0]*a[1]-s[1]*a[0]];return[1-c[0]-c[1],c[0],c[1]]},p.bilinearInterpolation=function(t,e){for(var n=[],a=0;a<t.length;a++){var r=t[0][a]+(t[3][a]-t[0][a])*e[1],i=r+(t[1][a]+(t[2][a]-t[1][a])*e[1]-r)*e[0];n.push(i)}return n},p.createCanvas=function(t,e){var n=document.createElement("canvas");return n.setAttribute("width",t[0]),n.setAttribute("height",t[1]),document.getElementById(e).appendChild(n),n};var m=p}]);
//# sourceMappingURL=index.node.js.map