!function(t){var e={};function r(a){if(e[a])return e[a].exports;var n=e[a]={i:a,l:!1,exports:{}};return t[a].call(n.exports,n,n.exports,r),n.l=!0,n.exports}r.m=t,r.c=e,r.d=function(t,e,a){r.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:a})},r.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},r.t=function(t,e){if(1&e&&(t=r(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var a=Object.create(null);if(r.r(a),Object.defineProperty(a,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var n in t)r.d(a,n,function(e){return t[e]}.bind(null,n));return a},r.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return r.d(e,"a",e),e},r.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},r.p="",r(r.s=0)}([function(t,e,r){"use strict";r.r(e),r.d(e,"Canvas",(function(){return m})),r.d(e,"Canvas2D",(function(){return w})),r.d(e,"ImageIO",(function(){return n}));var a={getImageCanvas:function(t){var e=document.createElement("canvas");e.width=t.width,e.height=t.height;var r=e.getContext("2d");return r.fillStyle="rgba(0, 0, 0, 0)",r.globalCompositeOperation="source-over",r.fillRect(0,0,e.width,e.height),r.drawImage(t,0,0),e},getDataFromImage:function(t){return canvas=a.getImageCanvas(t),canvas.getContext("2d").getImageData(0,0,t.width,t.height)},loadImage:function(t){var e=new Image;return e.src=t,e.isReady=!1,e.onload=function(){return e.isReady=!0},e},generateImageReadyPredicate:function(t){return function(){return t.isReady}}},n=a;function i(t,e){var r=[];return r[0]=t[0]+e[0],r[1]=t[1]+e[1],r}function o(t){var e=[];return e[0]=Math.floor(t[0]),e[1]=Math.floor(t[1]),e}function s(t,e){var r=[];return r[0]=t[0]-e[0],r[1]=t[1]-e[1],r}function h(t,e){return t[0]*e[0]+t[1]*e[1]}function c(t){return h(t,t)}function u(t){return Math.sqrt(h(t,t))}function g(t,e){var r=[];return r[0]=Math.min(t[0],e[0]),r[1]=Math.min(t[1],e[1]),r}function f(t,e){var r=[];return r[0]=Math.max(t[0],e[0]),r[1]=Math.max(t[1],e[1]),r}function l(t,e,r){var a=r[1]/t[1];return[a,(-t[0]*a+r[0])/e]}function p(t,e,r){var a=r[0]/t[0];return[a,(-t[1]*a+r[1])/e]}var d,v=function(t){this.canvas=t,this.ctx=t.getContext("2d"),this.image=this.ctx.getImageData(0,0,t.width,t.height),this.imageData=this.image.data};v.prototype.getSize=function(){return[this.canvas.height,this.canvas.width]},v.prototype.paintImage=function(){this.ctx.putImageData(this.image,0,0)},v.prototype.getCanvas=function(){return this.canvas},v.prototype.clearImage=function(t){this.useCanvasCtx((function(e){var r=e.getSize();e.ctx.fillStyle="rgba("+t[0]+","+t[1]+","+t[2]+","+t[3]+")",e.ctx.globalCompositeOperation="source-over",e.ctx.fillRect(0,0,r[1],r[0])}),!0)},v.prototype.useCanvasCtx=function(t){var e=arguments.length>1&&void 0!==arguments[1]&&arguments[1];e||this.ctx.putImageData(this.image,0,0),t(this),this.image=this.ctx.getImageData(0,0,this.canvas.width,this.canvas.height),this.imageData=this.image.data},v.prototype.getImageIndex=function(t){return 4*(this.canvas.width*t[0]+t[1])},v.prototype.getPxl=function(t){var e=this.getImageIndex(t);return[this.imageData[e],this.imageData[e+1],this.imageData[e+2],this.imageData[e+3]]},v.prototype.drawPxl=function(t,e){var r=this.getImageIndex(t);this.imageData[r]=e[0],this.imageData[r+1]=e[1],this.imageData[r+2]=e[2],this.imageData[r+3]=e[3]},v.prototype.drawLine=function(t,e,r){r.points=[t,e];var a=[];a.push(t),a.push(e);for(var n=[],i=[],o=0;o<a.length;o++){0<=(f=a[o])[0]&&f[0]<this.canvas.height&&0<=f[1]&&f[1]<this.canvas.width?n.push(f):i.push(f)}if(2!=n.length){var c=[],u=[e[0]-t[0],e[1]-t[1]];c.push(l(u,-(this.canvas.height-1),[-t[0],-t[1]])),c.push(p(u,-(this.canvas.width-1),[this.canvas.height-1-t[0],-t[1]])),c.push(l(u,this.canvas.height-1,[this.canvas.height-1-t[0],this.canvas.width-1-t[1]])),c.push(p(u,this.canvas.width-1,[-t[0],this.canvas.width-1-t[1]]));var g=[];for(o=0;o<c.length;o++){var f;0<=(f=c[o])[0]&&f[0]<=1&&0<=f[1]&&f[1]<=1&&g.push(f)}if(0!=g.length)if(n.length>0){var d=[t[0]+g[0][0]*u[0],t[1]+g[0][0]*u[1]];this.drawLineInt(n.pop(),d,r)}else{var v=[t[0]+g[0][0]*u[0],t[1]+g[0][0]*u[1]];for(o=1;o<g.length;o++){if(h(u=s(d=[t[0]+g[o][0]*u[0],t[1]+g[o][0]*u[1]],v),u)>.001)return void this.drawLineInt(v,d,r)}this.drawLineInt(v,v,r)}}else this.drawLineInt(n[0],n[1],r)},v.prototype.drawLineInt=function(t,e,r){t=o(t),e=o(e);var a=[-1,0,1],n=a.length,c=n*n,u=[];u[0]=t[0],u[1]=t[1];var g=s(e,t),f=[];for(f[0]=-g[1],f[1]=g[0],r(u,r.points,this);u[0]!==e[0]||u[1]!==e[1];){for(var l=Number.MAX_VALUE,p=[],d=0;d<c;d++){var v=a[d%n],m=a[Math.floor(d/n)],y=s(i(u,[v,m]),t),w=Math.abs(h(y,f))-h(y,g);l>w&&(l=w,p=[v,m])}r(u=i(u,p),r.points,this)}r(u,r.points,this)},v.prototype.drawPolygon=function(t,e){for(var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:v.isInsidePolygon,a=[[Number.MAX_VALUE,Number.MAX_VALUE],[Number.MIN_VALUE,Number.MIN_VALUE]],n=0;n<t.length;n++)a[0]=g(t[n],a[0]),a[1]=f(t[n],a[1]);var i=this.getSize(),h=s(i,[1,1]),c=[0,0];a[0]=o(g(h,f(c,a[0]))),a[1]=o(g(h,f(c,a[1])));for(var u=a[0][0];u<a[1][0];u++)for(var l=a[0][1];l<a[1][1];l++){var p=[u,l];r(p,t)&&e(p,t,this)}},v.prototype.drawTriangle=function(t,e,r,a){var n=[t,e,r];this.drawPolygon(n,a,v.isInsideConvex)},v.prototype.drawQuad=function(t,e,r,a,n){this.drawPolygon([t,e,r,a],n)},v.prototype.drawImage=function(t,e){"isReady"in t&&!t.isReady||this.useCanvasCtx((function(r){return r.ctx.drawImage(t,e[1],e[0])}))},v.prototype.drawCircle=function(t,e,r){var a=function(t,e){var r=[];return r[0]=t[0]*e,r[1]=t[1]*e,r}([1,1],e),n=[s(t,a),i(t,a)],h=this.getSize();n[0]=o(g(s(h,[1,1]),f([0,0],n[0]))),n[1]=o(g(s(h,[1,1]),f([0,0],n[1])));for(var c=n[0][0];c<=n[1][0];c++)for(var u=n[0][1];u<=n[1][1];u++){var l=[c,u];this.isInsideCircle(l,t,e)&&r(l,[t,e],this)}},v.prototype.isInsideCircle=function(t,e,r){return c(s(t,e))<=r*r},v.prototype.addEventListener=function(t,e,r){this.canvas.addEventListener(t,e,r)},v.prototype.drawString=function(t,e,r){this.useCanvasCtx((function(a){r(a.ctx),a.ctx.fillText(e,t[1],t[0])}))},v.isInsidePolygon=function(t,e){for(var r=[],a=0,n=e.length,i=0;i<n;i++)r[0]=s(e[(i+1)%n],t),r[1]=s(e[i],t),a+=Math.acos(h(r[0],r[1])/(u(r[0])*u(r[1])));return Math.abs(a-2*Math.PI)<.001},v.isInsideConvex=function(t,e){for(var r=e.length,a=[],n=[],i=0;i<r;i++){a[i]=s(e[(i+1)%r],e[i]);var o=[-a[i][1],a[i][0]],c=s(t,e[i]);n[i]=h(c,o)}var u=a[0][0]*a[1][1]-a[0][1]*a[1][0]>0?1:-1;for(i=0;i<r;i++){if(n[i]*u<0)return!1}return!0},v.simpleShader=function(t){return function(e,r,a){return a.drawPxl(e,t)}},v.colorShader=function(t){return v.interpolateTriangleShader((function(e,r,a,n){for(var i=[0,0,0,0],o=0;o<r.length;o++)i[0]=i[0]+t[o][0]*n[o],i[1]=i[1]+t[o][1]*n[o],i[2]=i[2]+t[o][2]*n[o],i[3]=i[3]+t[o][3]*n[o];a.drawPxl(e,i)}))},v.interpolateQuadShader=function(t){return function(e,r,a){var n=[r[0],r[1],r[2]],i=[r[2],r[3],r[0]],o=v.triangleBaryCoord(e,n);o[0]>0&&o[1]>0&&o[2]>0&&Math.abs(o[0]+o[1]+o[2]-1)<1e-10?t(e,r,a,[o[0],o[1],o[2],0]):(o=v.triangleBaryCoord(e,i),t(e,r,a,[o[2],0,o[0],o[1]]))}},v.interpolateTriangleShader=function(t){return function(e,r,a){var n=v.triangleBaryCoord(e,r);t(e,r,a,n)}},v.interpolateLineShader=function(t){return function(e,r,a){var n=s(r[1],r[0]),i=s(e,r[0]),o=c(n),u=h(i,n);t(e,r,a,0==o?0:u/o)}},v.quadTextureShader=function(t,e){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:v.bilinearInterpolation,a=null,h=function(h,c,u,l){t.isReady&&null!=a||(a=new v(n.getImageCanvas(t)));for(var p=a,d=p.getSize(),m=[0,0],y=0;y<e.length;y++)m[0]=m[0]+e[y][0]*l[y],m[1]=m[1]+e[y][1]*l[y];var w=[(1-m[1])*(d[1]-1),(d[0]-1)*m[0]],I=o(w=f([0,0],g(s([d[0],d[1]],[1,1]),w))),x=[p.getPxl(I),p.getPxl(i(I,[1,0])),p.getPxl(i(I,[1,1])),p.getPxl(i(I,[0,1]))],C=r(x,s(w,I));u.drawPxl(h,C)};return v.interpolateQuadShader(h)},v.triangleCache=(d=[],{constains:function(t){return null!=d[t%3]},get:function(t){return d[t%3]},set:function(t,e){return d[t%3]=e}}),v.triangleHash=function(t){return[t[0][0],t[1][0],t[2][0],t[0][1],t[1][1],t[2][1]].reduce((function(t,e){return 31*t+e}),1)},v.triangleBaryCoord=function(t,e){var r=v.triangleHash(e),a=[t[0]-e[0][0],t[1]-e[0][1]];if(!v.triangleCache.constains(r)){var n=[e[1][0]-e[0][0],e[1][1]-e[0][1]],i=[e[2][0]-e[0][0],e[2][1]-e[0][1]],o=n[0]*i[1]-n[1]*i[0];v.triangleCache.set(r,{triangle:e,u:n.map((function(t){return t/o})),v:i.map((function(t){return t/o})),det:o,hash:r})}var s=v.triangleCache.get(r),h=s.u,c=s.v;if(0==s.det)return[0,0,0];var u=[c[1]*a[0]-c[0]*a[1],h[0]*a[1]-h[1]*a[0]];return[1-u[0]-u[1],u[0],u[1]]},v.bilinearInterpolation=function(t,e){for(var r=[],a=0;a<t.length;a++){var n=t[0][a]+(t[3][a]-t[0][a])*e[1],i=n+(t[1][a]+(t[2][a]-t[1][a])*e[1]-n)*e[0];r.push(i)}return r},v.createCanvas=function(t,e){var r=document.createElement("canvas");return r.setAttribute("width",t[0]),r.setAttribute("height",t[1]),document.getElementById(e).appendChild(r),r};var m=v,y=function(t,e){if(m.call(this,t),2!=e.length||2!=e[0].length&&2!=e[1].length)throw"camera space must be 2-dim array with 2-dim arrays representing an interval";this.cameraSpace=e};(y.prototype=Object.create(m.prototype)).constructor=y,y.prototype.integerTransform=function(t){return[-(this.canvas.height-1)/(this.cameraSpace[1][1]-this.cameraSpace[1][0])*(t[1]-this.cameraSpace[1][1]),(this.canvas.width-1)/(this.cameraSpace[0][1]-this.cameraSpace[0][0])*(t[0]-this.cameraSpace[0][0])]},y.prototype.inverseTransform=function(t){return[this.cameraSpace[0][0]+(this.cameraSpace[0][1]-this.cameraSpace[0][0])/(this.canvas.width-1)*t[1],this.cameraSpace[1][1]-(this.cameraSpace[1][1]-this.cameraSpace[1][0])/(this.canvas.height-1)*t[0]]},y.prototype.drawLine=function(t,e,r){var a=this.integerTransform(t),n=this.integerTransform(e);m.prototype.drawLine.call(this,a,n,r)},y.prototype.drawTriangle=function(t,e,r,a){var n=this.integerTransform(t),i=this.integerTransform(e),o=this.integerTransform(r);m.prototype.drawTriangle.call(this,n,i,o,a)},y.prototype.drawQuad=function(t,e,r,a,n){var i=this.integerTransform(t),o=this.integerTransform(e),s=this.integerTransform(r),h=this.integerTransform(a);m.prototype.drawQuad.call(this,i,o,s,h,n)},y.prototype.drawCircle=function(t,e,r){var a=this.integerTransform(t),n=this.integerTransform([e,0])[1]-this.integerTransform([0,0])[1];m.prototype.drawCircle.call(this,a,n,r)},y.prototype.drawImage=function(t,e){m.prototype.drawImage.call(this,t,this.integerTransform(e))},y.prototype.drawString=function(t,e,r){var a=this.integerTransform(t);m.prototype.drawString.call(this,a,e,r)},y.prototype.setCamera=function(t){if(2!=t.length||2!=t[0].length&&2!=t[1].length)throw"camera space must be 2-dim array with 2-dim arrays representing an interval";this.cameraSpace=t};var w=y}]);
//# sourceMappingURL=index.node.js.map